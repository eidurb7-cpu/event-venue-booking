import{r as o,j as e,m as es,n as qe,L as V,O as ar,t as nr,p as ir,q as or,D as lr,v as ot,w as cr,x as $t,P as dr,y as mr,C as Ut,T as qt,z as ur,A as ls,X as cs,Y as ds,B as Gt,E as gr,F as Ht,G as pr,H as xr,I as hr,J as br,K as fr}from"./vendor-iB99znOi.js";import{A as Zt,C as Xe,H as yr,M as ts,B as vr,S as At,a as jr,G as Nr,U as wr,L as kr,X as Bs,b as Sr,c as Is,d as $e,e as Os,f as Ms,g as zs,P as Fs,h as Et,i as Vs,j as $s,k as Us,l as Cr,m as ss,n as Ar,o as Er,R as Pr,T as Dr,p as Rr,q as Tr,r as Pt,s as Lr,t as fe,u as Br,v as Ir,w as Or,x as Mr,y as zr,D as Fr,z as Vr,O as $r,E as Ur}from"./ui-vendor-BNes9LlF.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const c of r)if(c.type==="childList")for(const C of c.addedNodes)C.tagName==="LINK"&&C.rel==="modulepreload"&&l(C)}).observe(document,{childList:!0,subtree:!0});function n(r){const c={};return r.integrity&&(c.integrity=r.integrity),r.referrerPolicy&&(c.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?c.credentials="include":r.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function l(r){if(r.ep)return;r.ep=!0;const c=n(r);fetch(r.href,c)}})();const qs=o.createContext(void 0),Dt={de:{"nav.home":"Startseite","nav.venues":"Locations","nav.services":"Dienstleistungen","nav.request":"Anfrage","nav.login":"Login","nav.signup":"Registrieren","nav.booking":"Jetzt buchen","nav.account":"Mein Konto","nav.backHome":"Zur Startseite","nav.logout":"Logout","footer.copy":"© {year} EventVenue. Alle Rechte vorbehalten.","footer.impressum":"Impressum","footer.privacy":"Datenschutz","footer.terms":"AGB","footer.vendorTerms":"Vendor-Bedingungen","footer.refunds":"Storno & Erstattung","footer.contact":"Kontakt","footer.cookies":"Cookies","home.hero.title":"Buche die perfekte Event-Location","home.hero.subtitle":"Finde die ideale Location und passende Services fuer deinen besonderen Anlass.","home.hero.cta":"Locations ansehen","home.hero.dashboard":"Zum Dashboard","home.hero.vendorStart":"Als Vendor starten","home.categories.title":"Kategorien entdecken","home.categories.subtitle":"Finde passende Profis fuer Musik, Catering, Dekoration und mehr.","home.categories.dj":"DJs & Musik","home.categories.photo":"Fotografie","home.categories.catering":"Catering","home.categories.decoration":"Dekoration","home.categories.vendors":"{count}+ Anbieter","home.why.title":"Warum EventVenue","home.why.curated.title":"Gepruefte Vendor","home.why.curated.desc":"Jeder Vendor wird vor Freigabe geprueft, damit du mit Vertrauen buchst statt zu raten.","home.why.secure.title":"Sichere Zahlungen","home.why.secure.desc":"Sicher bezahlen mit Stripe: transparente Summen, klare Gebuehren und serverseitig verifizierter Status.","home.why.booking.title":"Strukturierte Buchung","home.why.booking.desc":"Ein klarer Ablauf von Anfrage bis Zahlung, damit beide Seiten geschuetzt und organisiert bleiben.","home.why.learnMore":"Mehr erfahren","home.services.title":"Komplette Event-Loesungen","home.services.venues":"Premium Locations","home.services.venues.desc":"Waehle aus beeindruckenden Veranstaltungsorten","home.services.djs":"Professionelle DJs","home.services.djs.desc":"Sorge fuer Stimmung die ganze Nacht","home.services.catering":"Catering Services","home.services.catering.desc":"Leckeres Essen fuer jeden Geschmack","home.services.makeup":"Make-up und Dekor","home.services.makeup.desc":"Styling- und Dekorationsservices aus einer Hand","home.services.photography":"Fotografie","home.services.photography.desc":"Halte jeden besonderen Moment fest","home.featured.title":"Empfohlene Locations","home.featured.viewAll":"Alle ansehen","home.cta.title":"Bereit fuer dein Event?","home.cta.subtitle":"Plane dein Event heute: Locations waehlen, Services buchen, alles an einem Ort.","home.cta.button":"Buchung starten","home.cta.request":"Anfrage erstellen","venues.title":"Verfuegbare Locations","venues.subtitle":"Entdecke unsere Premium Event-Locations","venues.filters":"Filter","venues.filter.searchLabel":"Suche","venues.filter.search":"Locations suchen...","venues.filter.type":"Location-Typ","venues.filter.all":"Alle Locations","venues.filter.capacityPlaceholder":"z. B. 100","venues.capacity":"Kapazitaet","venues.location":"Ort","venues.viewDetails":"Details ansehen","venues.resultsFound.one":"{count} Location gefunden","venues.resultsFound.other":"{count} Locations gefunden","venues.notFound":"Keine Locations gefunden","venues.notFound.desc":"Passe deine Suche oder Filter an","services.title":"Dienstleistungen","services.subtitle":"Einzelne Dienstleistungen fuer dein Event entdecken und buchen","services.tabs.all":"Alle Dienstleistungen","services.tabs.dj":"DJ-Services","services.tabs.catering":"Catering","services.tabs.makeup":"Make-up Artists","services.tabs.decorations":"Dekoration","services.tabs.photography":"Fotografie","services.search.placeholder":"Suchen...","services.filter.button":"Filter","services.filter.show":"Filter anzeigen","services.filter.hide":"Filter ausblenden","services.filter.rating":"Mindestbewertung","services.filter.maxPrice":"Max Preis: EUR {price}","services.filter.sortBy":"Sortieren nach","services.rating.all":"Alle Bewertungen","services.rating.stars":"Sterne","services.sort.highestRated":"Hoechste Bewertung","services.sort.lowestPrice":"Niedrigster Preis","services.sort.highestPrice":"Hoechster Preis","services.results.showing":"{count} Serviceanbieter","services.results.empty":"Keine Serviceanbieter gefunden. Bitte Filter anpassen.","services.card.detailsButton":"Details","services.card.offerButton":"Angebot","services.dialog.title":"Anbieterdetails","services.dialog.offerTitle":"Kurzes Angebot senden","services.dialog.description":"{provider} fuer {service}","services.dialog.basePrice":"Basispreis","services.dialog.rating":"Bewertung","services.dialog.specialties":"Spezialisierungen","services.dialog.offerLabel":"Dein Angebot (EUR)","services.dialog.form.name":"Name","services.dialog.form.email":"E-Mail","services.dialog.form.phone":"Telefon","services.dialog.form.date":"Event-Datum","services.dialog.form.guests":"Anzahl Gaeste","services.dialog.form.message":"Kurzinfo (optional)","services.dialog.form.messagePlaceholder":"z. B. Aufbau ab 16:00","services.dialog.submitOffer":"Angebot senden","services.dialog.offerSent":"Angebot gesendet. Der Anbieter kann annehmen, ablehnen oder ein Gegenangebot machen.","venue.notFound.title":"Location nicht gefunden","venue.back":"Zurueck zu den Locations","venue.perEvent":"pro Event","venue.features":"Ausstattung","venue.guests":"Bis zu {count} Gaeste","venue.eventDate":"Event-Datum","venue.selectDate":"Event-Datum auswaehlen","venue.dateConfirmed":"Datum bestaetigt: {date}","venue.selectDate.desc":"Waehle dein Wunschdatum und pruefe die Verfuegbarkeit.","venue.notAvailable":"Location nicht verfuegbar","venue.notAvailable.desc":"Die Location ist an diesem Datum bereits gebucht.","venue.available":"Location verfuegbar","venue.available.desc":"Die Location ist an diesem Datum verfuegbar.","venue.calendar.available":"Verfuegbar","venue.calendar.booked":"Belegt","venue.calendar.hint":"Zum Oeffnen auf das Datumsfeld klicken","venue.services.title":"Serviceanbieter auswaehlen","venue.services.desc":"Waehle aus professionellen Serviceanbietern. Grau markierte Anbieter sind an diesem Datum belegt.","venue.summary.title":"Geschaetzte Gesamtsumme","venue.summary.services":"Location + {count} Service(s)","venue.summary.note":"*Endpreis wird anhand der Gaestezahl berechnet","venue.summary.proceed":"Buchung abschliessen","venue.booked":"Belegt","venue.reviews":"Bewertungen","venue.perPerson":"/Person","venue.alert.selectDate":"Bitte ein Event-Datum auswaehlen","venue.alert.selectDateRibbon":"Datum auswaehlen","venue.alert.selectDateRibbonHint":"Bitte zuerst ein Datum im Kalender waehlen.","venue.alert.notAvailable":"Diese Location ist am gewaehlten Datum nicht verfuegbar","booking.title":"Buchung abschliessen","booking.subtitle":"Trage deine Daten ein, um die Buchung zu bestaetigen","booking.info.title":"Deine Angaben","booking.info.name":"Vollstaendiger Name","booking.info.email":"E-Mail","booking.info.phone":"Telefonnummer","booking.info.altName":"Alternative Kontaktperson","booking.info.altPhone":"Alternative Telefonnummer","booking.info.contactMethod":"Bevorzugte Kontaktmethode","booking.info.contactMethod.email":"E-Mail","booking.info.contactMethod.phone":"Telefon","booking.info.contactMethod.whatsapp":"WhatsApp","booking.info.time":"Event-Uhrzeit","booking.info.setupTime":"Aufbau-Beginn (optional)","booking.info.type":"Event-Typ","booking.info.guests":"Anzahl Gaeste","booking.info.address":"Event-Adresse","booking.info.city":"Stadt","booking.info.postalCode":"Postleitzahl","booking.info.notes":"Zusaetzliche Hinweise","booking.info.notes.placeholder":"Besondere Anforderungen oder Fragen?","booking.info.maxCapacity":"Maximale Kapazitaet: {count} Gaeste","booking.type.select":"Typ auswaehlen","booking.type.wedding":"Hochzeit","booking.type.corporate":"Firmenevent","booking.type.birthday":"Geburtstagsfeier","booking.type.conference":"Konferenz","booking.type.other":"Sonstiges","booking.submit":"Anfrage senden","booking.review.notice":"Hinweis: Endpreis kann sich nach Anbieterpruefung (z. B. Anfahrt/Distanz) aendern.","booking.review.approval":"Ich akzeptiere, dass der Anbieter die Anfrage annehmen/ablehnen und den Preis anpassen kann.","booking.summary.title":"Buchungsuebersicht","booking.summary.eventDate":"Event-Datum","booking.summary.venue":"Location","booking.summary.services":"Ausgewaehlte Services","booking.summary.rating":"Bewertung","booking.summary.subtotal":"Zwischensumme","booking.summary.fee":"Servicegebuehr (10%)","booking.summary.total":"Gesamt","booking.summary.totalNotice":"Der Gesamtpreis enthaelt interne Preisanpassungen und finale Service-Konditionen.","booking.summary.forGuests":"Fuer {count} Gaeste","booking.summary.enterGuests":"Gaestezahl eingeben, um den Endpreis zu sehen","booking.summary.noData":"Keine Buchungsdaten gefunden","booking.summary.browse":"Locations ansehen","booking.success.title":"Anfrage gesendet","booking.success.message":"Danke. Deine Anfrage wurde an den Anbieter gesendet und wartet auf Annahme oder Ablehnung.","booking.success.status":"Status: Wartet auf Anbieterantwort","booking.success.eventDate":"Event-Datum","booking.success.eventTime":"Event-Uhrzeit","booking.success.redirecting":"Weiterleitung zur Startseite...","notFound.page":"Seite nicht gefunden","notFound.backHome":"Zurueck zur Startseite","auth.name":"Name","auth.email":"E-Mail","auth.password":"Passwort","auth.login.title":"Login","auth.login.subtitle":"Melde dich an, um Anfragen zu verwalten","auth.login.button":"Einloggen","auth.login.noAccount":"Noch kein Konto?","auth.signup.title":"Sign up","auth.signup.subtitle":"Erstelle ein Konto fuer Angebote und Anfragen","auth.signup.button":"Konto erstellen","auth.signup.hasAccount":"Bereits ein Konto?","cookies.banner.title":"Cookie-Einstellungen","cookies.banner.description":"Wir verwenden notwendige Cookies fuer den Betrieb. Mit deiner Zustimmung nutzen wir zusaetzlich Analyse- und Marketing-Cookies.","cookies.banner.accept":"Alle akzeptieren","cookies.banner.reject":"Nicht notwendige ablehnen","cookies.banner.customize":"Anpassen","cookies.banner.hideCustomize":"Anpassung schliessen","cookies.banner.saveSelection":"Auswahl speichern","cookies.banner.settings":"Cookie-Seite","cookies.settings.title":"Cookie-Einstellungen","cookies.settings.description":"Passe hier jederzeit deine Cookie-Praeferenzen an.","cookies.settings.alwaysOn":"Notwendige Cookies sind immer aktiv.","cookies.settings.save":"Speichern","cookies.settings.saved":"Cookie-Auswahl gespeichert.","cookies.settings.backHome":"Zurueck zur Startseite","cookies.category.necessary":"Notwendig","cookies.category.preferences":"Praeferenzen","cookies.category.analytics":"Analyse","cookies.category.marketing":"Marketing"},en:{"nav.home":"Home","nav.venues":"Venues","nav.services":"Services","nav.request":"Request","nav.login":"Login","nav.signup":"Sign Up","nav.booking":"Book Now","nav.account":"My Account","nav.backHome":"Back to Home","nav.logout":"Logout","footer.copy":"© {year} EventVenue. All rights reserved.","footer.impressum":"Legal Notice","footer.privacy":"Privacy","footer.terms":"Terms","footer.vendorTerms":"Vendor Terms","footer.refunds":"Refund Policy","footer.contact":"Contact","footer.cookies":"Cookies","home.hero.title":"Book Your Perfect Event Venue","home.hero.subtitle":"Find the ideal venue and services for your special occasion.","home.hero.cta":"Explore Venues","home.hero.dashboard":"Open Dashboard","home.hero.vendorStart":"Start as Vendor","home.categories.title":"Explore Categories","home.categories.subtitle":"Find trusted professionals for music, catering, decoration, and more.","home.categories.dj":"DJs & Music","home.categories.photo":"Photography","home.categories.catering":"Catering","home.categories.decoration":"Decoration","home.categories.vendors":"{count}+ vendors","home.why.title":"Why EventVenue","home.why.curated.title":"Curated Vendors","home.why.curated.desc":"Every vendor is reviewed before approval so you book with confidence, not guesswork.","home.why.secure.title":"Secure Payments","home.why.secure.desc":"Pay securely with Stripe, with transparent totals and server-verified payment status.","home.why.booking.title":"Structured Booking","home.why.booking.desc":"A clean flow from request to confirmation to payment keeps both sides protected and organized.","home.why.learnMore":"Learn more","home.services.title":"Complete Event Solutions","home.services.venues":"Premium Venues","home.services.venues.desc":"Choose from a variety of stunning locations","home.services.djs":"Professional DJs","home.services.djs.desc":"Keep your guests dancing all night long","home.services.catering":"Catering Services","home.services.catering.desc":"Delicious food for every taste","home.services.makeup":"Makeup and Decor","home.services.makeup.desc":"Complete styling and decoration services","home.services.photography":"Photography","home.services.photography.desc":"Capture every precious moment","home.featured.title":"Featured Venues","home.featured.viewAll":"View All","home.cta.title":"Ready to Book Your Event?","home.cta.subtitle":"Start planning your perfect event today.","home.cta.button":"Start Booking","home.cta.request":"Create Request","venues.title":"Available Venues","venues.subtitle":"Browse our collection of premium event venues","venues.filters":"Filters","venues.filter.searchLabel":"Search","venues.filter.search":"Search venues...","venues.filter.type":"Venue Type","venues.filter.all":"All Venues","venues.filter.capacityPlaceholder":"e.g., 100","venues.capacity":"Capacity","venues.location":"Location","venues.viewDetails":"View Details","venues.resultsFound.one":"{count} venue found","venues.resultsFound.other":"{count} venues found","venues.notFound":"No venues found","venues.notFound.desc":"Try adjusting your search or filters","services.title":"DJ Services","services.subtitle":"Browse and book individual services for your event","services.tabs.all":"All Services","services.tabs.dj":"DJ Services","services.tabs.catering":"Catering","services.tabs.makeup":"Makeup Artists","services.tabs.decorations":"Decoration","services.tabs.photography":"Photography","services.search.placeholder":"Search...","services.filter.button":"Filter","services.filter.show":"Show Filters","services.filter.hide":"Hide Filters","services.filter.rating":"Minimum Rating","services.filter.maxPrice":"Max Price: EUR {price}","services.filter.sortBy":"Sort By","services.rating.all":"All Ratings","services.rating.stars":"stars","services.sort.highestRated":"Highest Rated","services.sort.lowestPrice":"Lowest Price","services.sort.highestPrice":"Highest Price","services.results.showing":"Showing {count} service providers","services.results.empty":"No service providers found. Try adjusting your filters.","services.card.detailsButton":"Details","services.card.offerButton":"Offer","services.dialog.title":"Vendor Details","services.dialog.offerTitle":"Send Short Offer","services.dialog.description":"{provider} for {service}","services.dialog.basePrice":"Base Price","services.dialog.rating":"Rating","services.dialog.specialties":"Specialties","services.dialog.offerLabel":"Your Offer (EUR)","services.dialog.form.name":"Name","services.dialog.form.email":"Email","services.dialog.form.phone":"Phone","services.dialog.form.date":"Event Date","services.dialog.form.guests":"Number of Guests","services.dialog.form.message":"Short Note (optional)","services.dialog.form.messagePlaceholder":"e.g. setup starts at 4 PM","services.dialog.submitOffer":"Send Offer","services.dialog.offerSent":"Offer sent. Vendor can accept, decline, or counter-offer.","venue.notFound.title":"Venue Not Found","venue.back":"Back to Venues","venue.perEvent":"per event","venue.features":"Features","venue.guests":"Up to {count} guests","venue.eventDate":"Event Date","venue.selectDate":"Select Event Date","venue.dateConfirmed":"Date confirmed: {date}","venue.selectDate.desc":"Choose your preferred date to check availability.","venue.notAvailable":"Venue Not Available","venue.notAvailable.desc":"This venue is already booked on this date.","venue.available":"Venue Available","venue.available.desc":"This venue is available on this date.","venue.calendar.available":"Available","venue.calendar.booked":"Booked","venue.calendar.hint":"Click the date field to open calendar","venue.services.title":"Select Service Providers","venue.services.desc":"Choose from our professional service providers.","venue.summary.title":"Estimated Total","venue.summary.services":"Venue + {count} service(s)","venue.summary.note":"*Final price will be calculated based on number of guests","venue.summary.proceed":"Complete Booking","venue.booked":"Booked","venue.reviews":"reviews","venue.perPerson":"/person","venue.alert.selectDate":"Please select an event date","venue.alert.selectDateRibbon":"Choose date first","venue.alert.selectDateRibbonHint":"Please select a date in the calendar.","venue.alert.notAvailable":"This venue is not available on the selected date","booking.title":"Complete Your Booking","booking.subtitle":"Fill in your details to confirm your event booking","booking.info.title":"Your Information","booking.info.name":"Full Name","booking.info.email":"Email","booking.info.phone":"Phone Number","booking.info.altName":"Alternate Contact Name","booking.info.altPhone":"Alternate Contact Phone","booking.info.contactMethod":"Preferred Contact Method","booking.info.contactMethod.email":"Email","booking.info.contactMethod.phone":"Phone","booking.info.contactMethod.whatsapp":"WhatsApp","booking.info.time":"Event Time","booking.info.setupTime":"Setup Start Time (optional)","booking.info.type":"Event Type","booking.info.guests":"Number of Guests","booking.info.address":"Event Address","booking.info.city":"City","booking.info.postalCode":"Postal Code","booking.info.notes":"Additional Notes","booking.info.notes.placeholder":"Any special requirements or questions?","booking.info.maxCapacity":"Maximum capacity: {count} guests","booking.type.select":"Select type","booking.type.wedding":"Wedding","booking.type.corporate":"Corporate Event","booking.type.birthday":"Birthday Party","booking.type.conference":"Conference","booking.type.other":"Other","booking.submit":"Send Request","booking.review.notice":"Note: Final price may change after vendor review (for example travel distance).","booking.review.approval":"I accept that the vendor can accept/decline this request and adjust pricing.","booking.summary.title":"Booking Summary","booking.summary.eventDate":"Event Date","booking.summary.venue":"Venue","booking.summary.services":"Selected Services","booking.summary.rating":"Rating","booking.summary.subtotal":"Subtotal","booking.summary.fee":"Service Fee (10%)","booking.summary.total":"Total","booking.summary.totalNotice":"Total includes internal pricing adjustments and final service conditions.","booking.summary.forGuests":"For {count} guests","booking.summary.enterGuests":"Enter number of guests to see final total","booking.summary.noData":"No booking data found","booking.summary.browse":"Browse Venues","booking.success.title":"Request Sent","booking.success.message":"Thanks. Your request was sent to the vendor and is pending approval or decline.","booking.success.status":"Status: Waiting for vendor response","booking.success.eventDate":"Event Date","booking.success.eventTime":"Event Time","booking.success.redirecting":"Redirecting to homepage...","notFound.page":"Page not found","notFound.backHome":"Back to Home","auth.name":"Name","auth.email":"Email","auth.password":"Password","auth.login.title":"Login","auth.login.subtitle":"Sign in to manage your requests","auth.login.button":"Login","auth.login.noAccount":"Don't have an account?","auth.signup.title":"Sign Up","auth.signup.subtitle":"Create an account for offers and requests","auth.signup.button":"Create Account","auth.signup.hasAccount":"Already have an account?","cookies.banner.title":"Cookie Settings","cookies.banner.description":"We use necessary cookies to run this site. With your consent, we also use analytics and marketing cookies.","cookies.banner.accept":"Accept all","cookies.banner.reject":"Reject non-essential","cookies.banner.customize":"Customize","cookies.banner.hideCustomize":"Close customize","cookies.banner.saveSelection":"Save selection","cookies.banner.settings":"Cookie page","cookies.settings.title":"Cookie Settings","cookies.settings.description":"You can update your cookie preferences here at any time.","cookies.settings.alwaysOn":"Necessary cookies are always on.","cookies.settings.save":"Save","cookies.settings.saved":"Cookie settings saved.","cookies.settings.backHome":"Back to home","cookies.category.necessary":"Necessary","cookies.category.preferences":"Preferences","cookies.category.analytics":"Analytics","cookies.category.marketing":"Marketing"}};function qr({children:t}){const[s,n]=o.useState("de"),l=(r,c)=>{let C=Dt[s][r]||Dt.en[r]||r;return c&&Object.entries(c).forEach(([E,x])=>{C=C.replace(`{${E}}`,String(x))}),C};return e.jsx(qs.Provider,{value:{language:s,setLanguage:n,t:l},children:t})}function me(){const t=o.useContext(qs);return t||{language:"de",setLanguage:()=>{},t:(s,n)=>{let l=Dt.de[s]||Dt.en[s]||s;return n&&Object.entries(n).forEach(([r,c])=>{l=l.replace(`{${r}}`,String(c))}),l}}}const rs="currentUser",Rt="adminDashboardToken",Tt="adminDashboardUser",It="userAuthToken";function Pe(){var s;const t=localStorage.getItem(rs);if(!t)return null;try{const n=JSON.parse(t);return!(n!=null&&n.role)||!((s=n==null?void 0:n.user)!=null&&s.email)?null:n}catch{return null}}function Lt(t){localStorage.setItem(rs,JSON.stringify(t)),t.token&&localStorage.setItem(It,t.token)}function as(){localStorage.removeItem(rs),localStorage.removeItem(It)}function Gr(){return localStorage.getItem(It)||""}function Yt(){return sessionStorage.getItem(Rt)||""}function ms(t,s){sessionStorage.setItem(Rt,t),sessionStorage.setItem(Tt,JSON.stringify(s)),localStorage.removeItem(It),Lt({role:"admin",user:s})}function Gs(){const t=!!sessionStorage.getItem(Rt)||!!sessionStorage.getItem(Tt);sessionStorage.removeItem(Rt),sessionStorage.removeItem(Tt);const s=Pe();(t||(s==null?void 0:s.role)==="admin")&&as()}function Hr(){const t=sessionStorage.getItem(Tt);if(!t)return null;try{const s=JSON.parse(t);if(s!=null&&s.email&&(s!=null&&s.name))return s}catch{return{id:"",name:t,email:""}}return null}const us="event_marketplace_cart_v1",gs={venue:null,services:[],currency:"eur"},Hs=o.createContext(null);function _r({children:t}){const[s,n]=o.useState(gs);o.useEffect(()=>{try{const m=localStorage.getItem(us);if(!m)return;const d=JSON.parse(m),v=Array.isArray(d==null?void 0:d.services)?d.services.filter(u=>u&&typeof u.id=="string"&&Number.isFinite(u.price)):[],p={venue:d!=null&&d.venue&&typeof d.venue.id=="string"&&Number.isFinite(d.venue.price)?d.venue:null,services:v,currency:"eur"};n(p)}catch{}},[]),o.useEffect(()=>{try{localStorage.setItem(us,JSON.stringify(s))}catch{}},[s]);const l=o.useMemo(()=>{var v;const m=((v=s.venue)==null?void 0:v.price)??0,d=s.services.reduce((p,u)=>p+u.price,0);return m+d},[s]),r=m=>s.services.some(d=>d.id===m),c=m=>{n(d=>({...d,venue:m}))},C=()=>{n(m=>({...m,venue:null}))},E=m=>{n(d=>{const v=d.services.some(p=>p.id===m.id);return{...d,services:v?d.services.filter(p=>p.id!==m.id):[...d.services,m]}})},x=m=>{n(d=>({...d,services:d.services.filter(v=>v.id!==m)}))},R=()=>n(gs);return e.jsx(Hs.Provider,{value:{cart:s,setVenue:c,clearVenue:C,toggleService:E,removeService:x,clearCart:R,total:l,hasService:r},children:t})}function lt(){const t=o.useContext(Hs);if(!t)throw new Error("useCart must be used inside <CartProvider />");return t}function Kr(){var A;const t=es(),s=qe(),{language:n,setLanguage:l,t:r}=me(),[c,C]=o.useState(!1),[E,x]=o.useState(""),[R,m]=o.useState(""),[d,v]=o.useState(!1),[p,u]=o.useState(!1),[L,z]=o.useState(!0),{cart:j}=lt(),N=o.useRef(null),f=o.useRef(0),y=o.useRef(null),O=[{code:"de",name:"Deutsch"},{code:"en",name:"English"}];o.useEffect(()=>{var K;const T=Pe(),$=!!Yt();C((T==null?void 0:T.role)==="admin"||$),x((T==null?void 0:T.role)||""),m(((K=T==null?void 0:T.user)==null?void 0:K.name)||"")},[t.pathname]),o.useEffect(()=>{if(!p)return;const T=$=>{N.current&&!N.current.contains($.target)&&u(!1)};return document.addEventListener("mousedown",T),()=>document.removeEventListener("mousedown",T)},[p]),o.useEffect(()=>{const T=()=>{const $=window.scrollY||0,K=f.current;y.current&&window.clearTimeout(y.current),$<24?z(!0):$>K+6?z(!1):$<K-6&&z(!0),y.current=window.setTimeout(()=>{z(!0)},180),f.current=$};return window.addEventListener("scroll",T,{passive:!0}),()=>{window.removeEventListener("scroll",T),y.current&&window.clearTimeout(y.current)}},[]),o.useEffect(()=>{(d||p)&&z(!0)},[d,p]);const te=E==="vendor"?"/vendor-portfolio":E==="admin"?"/admin":"/customer-portfolio",q=(j.venue?1:0)+j.services.length,W=()=>{Yt()&&Gs(),as(),v(!1),s("/")},M=()=>{window.history.length>1?s(-1):s("/")};return e.jsx("header",{className:`bg-white border-b sticky top-0 z-50 transition-transform duration-300 ${L?"translate-y-0":"-translate-y-full"}`,children:e.jsxs("div",{className:"w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[t.pathname!=="/"&&e.jsx("button",{type:"button",onClick:M,className:"inline-flex items-center justify-center rounded-lg border border-gray-300 p-2 text-gray-700 hover:bg-gray-50","aria-label":"Back",title:"Back",children:e.jsx(Zt,{className:"size-4"})}),e.jsxs(V,{to:"/",className:"flex items-center gap-2 min-w-0",children:[e.jsx(Xe,{className:"size-8 text-purple-600"}),e.jsx("span",{className:"text-xl sm:text-2xl font-semibold text-gray-900 truncate",children:"EventVenue"})]})]}),e.jsxs("nav",{className:"hidden md:flex items-center gap-6",children:[e.jsxs(V,{to:"/",className:`flex items-center gap-2 transition-colors ${t.pathname==="/"?"text-purple-600":"text-gray-600 hover:text-purple-600"}`,children:[e.jsx(yr,{className:"size-4"}),r("nav.home")]}),e.jsxs(V,{to:"/venues",className:`flex items-center gap-2 transition-colors ${t.pathname==="/venues"?"text-purple-600":"text-gray-600 hover:text-purple-600"}`,children:[e.jsx(ts,{className:"size-4"}),r("nav.venues")]}),e.jsxs(V,{to:"/services",className:`flex items-center gap-2 transition-colors ${t.pathname==="/services"?"text-purple-600":"text-gray-600 hover:text-purple-600"}`,children:[e.jsx(vr,{className:"size-4"}),r("nav.services")]}),e.jsxs(V,{to:"/cart",className:`flex items-center gap-2 transition-colors ${t.pathname==="/cart"?"text-purple-600":"text-gray-600 hover:text-purple-600"}`,children:[e.jsx(At,{className:"size-4"}),"Cart",q>0&&e.jsx("span",{className:"rounded-full bg-purple-100 px-2 py-0.5 text-xs text-purple-700",children:q})]}),c&&e.jsxs(V,{to:"/admin",className:`flex items-center gap-2 transition-colors ${t.pathname==="/admin"?"text-purple-600":"text-gray-600 hover:text-purple-600"}`,children:[e.jsx(jr,{className:"size-4"}),"Admin"]})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsxs("div",{ref:N,className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>u(T=>!T),className:"flex items-center gap-2 text-gray-600 hover:text-purple-600 transition-colors px-3 py-2 rounded-lg hover:bg-gray-50",children:[e.jsx(Nr,{className:"size-5"}),e.jsx("span",{className:"hidden sm:inline",children:(A=O.find(T=>T.code===n))==null?void 0:A.name})]}),e.jsx("div",{className:`absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border transition-all duration-200 z-20 max-md:fixed max-md:left-4 max-md:right-4 max-md:top-[72px] max-md:w-auto ${p?"opacity-100 visible":"opacity-0 invisible"}`,children:O.map(T=>e.jsx("button",{onClick:()=>{l(T.code),u(!1)},className:`w-full flex items-center gap-3 px-4 py-3 hover:bg-purple-50 transition-colors first:rounded-t-lg last:rounded-b-lg ${n===T.code?"bg-purple-100 text-purple-600":"text-gray-700"}`,children:e.jsx("span",{className:"font-medium",children:T.name})},T.code))})]}),e.jsx(V,{to:"/request",className:"hidden sm:inline-flex bg-gray-900 text-white px-4 py-2 rounded-lg hover:bg-black transition-colors",children:r("nav.request")}),e.jsxs(V,{to:"/cart",className:"hidden sm:inline-flex items-center gap-2 rounded-lg border border-purple-300 bg-white px-3 py-2 text-purple-700 hover:bg-purple-50",children:[e.jsx(At,{className:"size-4"}),"Cart",q>0&&e.jsx("span",{className:"rounded-full bg-purple-100 px-2 py-0.5 text-xs text-purple-700",children:q})]}),E?e.jsxs("div",{className:"relative group",children:[e.jsxs("button",{type:"button",className:"inline-flex items-center gap-2 bg-white text-gray-800 border border-gray-300 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(wr,{className:"size-4"}),e.jsx("span",{className:"max-w-[120px] truncate",children:R||r("nav.account")})]}),e.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-lg border opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-10",children:[e.jsx(V,{to:te,className:"block px-4 py-3 text-sm text-gray-700 hover:bg-purple-50",children:r("nav.account")}),e.jsx(V,{to:"/",className:"block px-4 py-3 text-sm text-gray-700 hover:bg-purple-50",children:r("nav.backHome")}),e.jsxs("button",{type:"button",onClick:W,className:"w-full text-left px-4 py-3 text-sm text-red-600 hover:bg-red-50 inline-flex items-center gap-2",children:[e.jsx(kr,{className:"size-4"}),r("nav.logout")]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{to:"/login",className:"hidden sm:inline-flex bg-white text-gray-800 border border-gray-300 px-4 py-2 rounded-lg hover:bg-gray-50 transition-colors",children:r("nav.login")}),e.jsx(V,{to:"/signup",className:"hidden sm:inline-flex bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors",children:r("nav.signup")})]}),e.jsx("button",{type:"button",onClick:()=>{v(T=>!T),u(!1)},className:"inline-flex md:hidden items-center justify-center rounded-lg border border-gray-300 p-2 text-gray-700 hover:bg-gray-50","aria-label":"Mobile Menu",children:d?e.jsx(Bs,{className:"size-5"}):e.jsx(Sr,{className:"size-5"})})]})]}),d&&e.jsxs("div",{className:"md:hidden mt-3 rounded-lg border border-gray-200 bg-white p-3 space-y-2",children:[e.jsx(V,{to:"/",onClick:()=>{v(!1),u(!1)},className:"block rounded-lg px-3 py-2 text-gray-700 hover:bg-gray-50",children:r("nav.home")}),e.jsx(V,{to:"/venues",onClick:()=>{v(!1),u(!1)},className:"block rounded-lg px-3 py-2 text-gray-700 hover:bg-gray-50",children:r("nav.venues")}),e.jsx(V,{to:"/services",onClick:()=>{v(!1),u(!1)},className:"block rounded-lg px-3 py-2 text-gray-700 hover:bg-gray-50",children:r("nav.services")}),e.jsxs(V,{to:"/cart",onClick:()=>{v(!1),u(!1)},className:"block rounded-lg px-3 py-2 text-gray-700 hover:bg-gray-50",children:["Cart (",q,")"]}),e.jsx(V,{to:"/request",onClick:()=>{v(!1),u(!1)},className:"block rounded-lg px-3 py-2 text-gray-700 hover:bg-gray-50",children:r("nav.request")}),e.jsxs("div",{className:"border-t border-gray-200 pt-2 mt-1",children:[e.jsx("p",{className:"px-3 py-1 text-xs font-medium text-gray-500",children:"Language"}),O.map(T=>e.jsx("button",{type:"button",onClick:()=>{l(T.code),v(!1),u(!1)},className:`w-full text-left rounded-lg px-3 py-2 ${n===T.code?"bg-purple-100 text-purple-700":"text-gray-700 hover:bg-gray-50"}`,children:T.name},T.code))]}),c&&e.jsx(V,{to:"/admin",onClick:()=>{v(!1),u(!1)},className:"block rounded-lg px-3 py-2 text-gray-700 hover:bg-gray-50",children:"Admin"}),E?e.jsxs(e.Fragment,{children:[e.jsx(V,{to:te,onClick:()=>{v(!1),u(!1)},className:"block rounded-lg px-3 py-2 text-gray-700 hover:bg-gray-50",children:r("nav.account")}),e.jsx("button",{type:"button",onClick:W,className:"w-full text-left rounded-lg px-3 py-2 text-red-600 hover:bg-red-50",children:r("nav.logout")})]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{to:"/login",onClick:()=>{v(!1),u(!1)},className:"block rounded-lg px-3 py-2 text-gray-700 hover:bg-gray-50",children:r("nav.login")}),e.jsx(V,{to:"/signup",onClick:()=>{v(!1),u(!1)},className:"block rounded-lg px-3 py-2 text-white bg-purple-600 hover:bg-purple-700",children:r("nav.signup")})]})]})]})})}function Jr(){const{t}=me(),s=new Date().getFullYear();return e.jsx("footer",{className:"border-t border-slate-200 bg-white",children:e.jsx("div",{className:"w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("p",{className:"text-sm text-slate-600",children:t("footer.copy",{year:s})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-2 text-sm",children:[e.jsx(V,{to:"/about",className:"text-slate-600 hover:text-slate-900",children:"About"}),e.jsx(V,{to:"/payments-security",className:"text-slate-600 hover:text-slate-900",children:"Payments & Security"}),e.jsx(V,{to:"/impressum",className:"text-slate-600 hover:text-slate-900",children:t("footer.impressum")}),e.jsx(V,{to:"/privacy",className:"text-slate-600 hover:text-slate-900",children:t("footer.privacy")}),e.jsx(V,{to:"/terms",className:"text-slate-600 hover:text-slate-900",children:t("footer.terms")}),e.jsx(V,{to:"/vendor-terms",className:"text-slate-600 hover:text-slate-900",children:t("footer.vendorTerms")}),e.jsx(V,{to:"/refund-policy",className:"text-slate-600 hover:text-slate-900",children:t("footer.refunds")}),e.jsx(V,{to:"/contact",className:"text-slate-600 hover:text-slate-900",children:t("footer.contact")}),e.jsx(V,{to:"/cookies",className:"text-slate-600 hover:text-slate-900",children:t("footer.cookies")})]})]})})})}const _s="uc_consent",Xt="consent:updated",ps="anonymousSessionId",Wr=3600*24*180,Zr="http://localhost:4000";function ns(){const t=document.cookie.split("; ").find(s=>s.startsWith(`${_s}=`));if(!t)return null;try{const s=decodeURIComponent(t.split("=")[1]||""),n=JSON.parse(s);return typeof(n==null?void 0:n.v)!="number"||typeof(n==null?void 0:n.preferences)!="boolean"||typeof(n==null?void 0:n.analytics)!="boolean"||typeof(n==null?void 0:n.marketing)!="boolean"?null:{v:n.v,necessary:!0,preferences:n.preferences,analytics:n.analytics,marketing:n.marketing,ts:typeof n.ts=="number"?n.ts:Date.now()}}catch{return null}}function kt(t){const s={...t,necessary:!0,ts:Date.now()},n=encodeURIComponent(JSON.stringify(s));return document.cookie=`${_s}=${n}; Max-Age=${Wr}; Path=/; SameSite=Lax`,window.dispatchEvent(new CustomEvent(Xt,{detail:s})),s}function Yr(t){const s=n=>{const l=n;l.detail&&t(l.detail)};return window.addEventListener(Xt,s),()=>window.removeEventListener(Xt,s)}function Xr(){const t=localStorage.getItem(ps);if(t)return t;const s=typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():`sess_${Date.now()}`;return localStorage.setItem(ps,s),s}async function St(t){var l;const s=Pe(),n={v:t.v,necessary:!0,preferences:t.preferences,analytics:t.analytics,marketing:t.marketing,ts:t.ts,sessionId:Xr(),userEmail:((l=s==null?void 0:s.user)==null?void 0:l.email)||null};try{await fetch(`${Zr}/api/consent`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),keepalive:!0})}catch{}}function Qr(){const{t}=me(),[s,n]=o.useState(!1),[l,r]=o.useState(!1),[c,C]=o.useState(!1),[E,x]=o.useState(!1),[R,m]=o.useState(!1);if(o.useEffect(()=>{const u=ns();if(!u){n(!0);return}r(u.preferences),C(u.analytics),x(u.marketing)},[]),!s)return null;async function d(){const u=kt({v:1,preferences:!0,analytics:!0,marketing:!0});await St(u),n(!1)}async function v(){const u=kt({v:1,preferences:!1,analytics:!1,marketing:!1});await St(u),n(!1)}async function p(){const u=kt({v:1,preferences:l,analytics:c,marketing:E});await St(u),n(!1)}return e.jsxs("div",{className:"fixed inset-x-3 bottom-3 z-50 rounded-xl border border-slate-200 bg-white p-4 shadow-2xl md:inset-x-6",children:[e.jsx("p",{className:"text-base font-semibold text-slate-900",children:t("cookies.banner.title")}),e.jsx("p",{className:"mt-2 text-sm text-slate-600",children:t("cookies.banner.description")}),R&&e.jsxs("div",{className:"mt-3 space-y-2 rounded-lg bg-slate-50 p-3 text-sm text-slate-700",children:[e.jsxs("label",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{children:t("cookies.category.preferences")}),e.jsx("input",{type:"checkbox",checked:l,onChange:u=>r(u.target.checked)})]}),e.jsxs("label",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{children:t("cookies.category.analytics")}),e.jsx("input",{type:"checkbox",checked:c,onChange:u=>C(u.target.checked)})]}),e.jsxs("label",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{children:t("cookies.category.marketing")}),e.jsx("input",{type:"checkbox",checked:E,onChange:u=>x(u.target.checked)})]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[e.jsx("button",{type:"button",onClick:v,className:"rounded-md border border-slate-300 px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-100",children:t("cookies.banner.reject")}),e.jsx("button",{type:"button",onClick:d,className:"rounded-md bg-slate-900 px-3 py-2 text-sm font-medium text-white hover:bg-slate-700",children:t("cookies.banner.accept")}),e.jsx("button",{type:"button",onClick:()=>m(u=>!u),className:"rounded-md border border-slate-300 px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-100",children:t(R?"cookies.banner.hideCustomize":"cookies.banner.customize")}),R&&e.jsx("button",{type:"button",onClick:p,className:"rounded-md border border-emerald-500 px-3 py-2 text-sm font-medium text-emerald-700 hover:bg-emerald-50",children:t("cookies.banner.saveSelection")}),e.jsx(V,{to:"/cookies",className:"rounded-md px-3 py-2 text-sm font-medium text-indigo-600 hover:bg-indigo-50",children:t("cookies.banner.settings")})]})]})}const _t="",xs="";function Ks(t,s){if(document.getElementById(t))return;const n=document.createElement("script");n.id=t,n.async=!0,n.src=s,document.head.appendChild(n)}function ea(t){if(!t.analytics||!_t)return;Ks("ga-script",`https://www.googletagmanager.com/gtag/js?id=${_t}`);const s=window;s.dataLayer||(s.dataLayer=[]),s.gtag||(s.gtag=function(...l){var r;(r=s.dataLayer)==null||r.push(l)},s.gtag("js",new Date),s.gtag("config",_t))}function ta(t){if(!t.marketing||!xs)return;const s=window;if(s.fbq)return;const n=function(...l){n.queue.push(l)};n.queue=[],n.loaded=!0,n.version="2.0",s.fbq=n,s._fbq=n,Ks("meta-pixel-script","https://connect.facebook.net/en_US/fbevents.js"),s.fbq("init",xs),s.fbq("track","PageView")}function hs(t){t.analytics&&ea(t),t.marketing&&ta(t)}function sa(){return o.useEffect(()=>{const t=ns();return t&&hs(t),Yr(s=>{hs(s)})},[]),null}function ra(){return e.jsxs("div",{className:"min-h-screen w-full overflow-x-hidden",children:[e.jsx(sa,{}),e.jsx(Kr,{}),e.jsx("main",{className:"w-full",children:e.jsx(ar,{})}),e.jsx(Jr,{}),e.jsx(Qr,{})]})}const Bt=[{id:"1",name:"Grosser Ballsaal",description:"Eleganter Ballsaal, ideal fuer Hochzeiten und Firmenevents",image:"https://images.unsplash.com/photo-1759519238029-689e99c6d19e?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxsdXh1cnklMjBldmVudCUyMHZlbnVlJTIwYmFsbHJvb218ZW58MXx8fHwxNzcxMDE2OTcyfDA&ixlib=rb-4.1.0&q=80&w=1080",capacity:300,price:5e3,location:"Innenstadt",features:["Klimaanlage","Buehne","Soundsystem","Parkplaetze","WLAN"],type:"Ballsaal",bookedDates:["2026-02-20","2026-02-27","2026-03-15"]},{id:"2",name:"Gartenparadies",description:"Wunderschoene Outdoor-Location mit natuerlicher Kulisse",image:"https://images.unsplash.com/photo-1762216444919-043cf813e4de?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxvdXRkb29yJTIwZ2FyZGVuJTIwd2VkZGluZyUyMHZlbnVlfGVufDF8fHx8MTc3MTAwNjg2N3ww&ixlib=rb-4.1.0&q=80&w=1080",capacity:200,price:3500,location:"Nordstadt",features:["Aussenbereich","Garten","Pavillon","Beleuchtung","Parkplaetze"],type:"Garten",bookedDates:["2026-02-21","2026-03-01","2026-03-08"]},{id:"3",name:"Moderner Konferenzsaal",description:"Moderner Veranstaltungsraum fuer Firmenevents und Konferenzen",image:"https://images.unsplash.com/photo-1703355685952-03ed19f70f51?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxtb2Rlcm4lMjBjb25mZXJlbmNlJTIwaGFsbHxlbnwxfHx8fDE3NzA5NjE4MTN8MA&ixlib=rb-4.1.0&q=80&w=1080",capacity:150,price:2500,location:"Geschaeftsviertel",features:["Projektor","WLAN","Klimaanlage","Catering-Kueche","Parkplaetze"],type:"Konferenzsaal",bookedDates:["2026-02-18","2026-02-25","2026-03-04"]},{id:"4",name:"Skyline Dachterrasse",description:"Beeindruckende Dachterrassen-Location mit Panoramablick",image:"https://images.unsplash.com/photo-1746021425981-5f55202a826d?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxyb29mdG9wJTIwZXZlbnQlMjBzcGFjZXxlbnwxfHx8fDE3NzEwMTY5NzN8MA&ixlib=rb-4.1.0&q=80&w=1080",capacity:120,price:4e3,location:"Stadtzentrum",features:["Stadtblick","Barbereich","Lounge","Beleuchtung","Klimasteuerung"],type:"Dachterrasse",bookedDates:["2026-02-22","2026-03-07","2026-03-14"]}],nt=[{id:"dj",name:"DJ Services",description:"Professionelle DJs fuer eine starke Event-Stimmung",image:"https://images.unsplash.com/photo-1766111242568-d935ea63f32f?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxESiUyMHR1cm50YWJsZXMlMjBwYXJ0eXxlbnwxfHx8fDE3NzEwMTY5NzN8MA&ixlib=rb-4.1.0&q=80&w=1080",price:800,category:"dj",providers:[{id:"dj-1",name:'DJ Marcus "The Mixer"',rating:4.9,reviewCount:127,specialties:["Hochzeiten","Firmenevents","EDM","Top 40"],price:800,bookedDates:["2026-02-20","2026-02-27","2026-03-06"]},{id:"dj-2",name:"DJ Sarah Beats",rating:4.8,reviewCount:95,specialties:["Hochzeiten","Private Feiern","Hip Hop","R&B"],price:1200,bookedDates:["2026-02-21","2026-02-28","2026-03-15"]},{id:"dj-3",name:"DJ Alex Sound",rating:4.7,reviewCount:83,specialties:["Business","Jazz","Lounge","Klassik"],price:950,bookedDates:["2026-02-19","2026-03-01","2026-03-08"]}]},{id:"catering",name:"Catering",description:"Leckere Speisen und Getraenke fuer jedes Event",image:"https://images.unsplash.com/photo-1732259495388-af40b972c311?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxjYXRlcmluZyUyMGZvb2QlMjBzZXJ2aWNlfGVufDF8fHx8MTc3MTAxNjk3M3ww&ixlib=rb-4.1.0&q=80&w=1080",price:50,category:"catering",providers:[{id:"catering-1",name:"Gourmet Delights Catering",rating:4.9,reviewCount:156,specialties:["Italienisch","Franzoesisch","Fusion","Vegetarisch"],price:85,bookedDates:["2026-02-20","2026-02-27","2026-03-07"]},{id:"catering-2",name:"Taste of Asia Catering",rating:4.8,reviewCount:132,specialties:["Asiatisch","Sushi","Thai","Chinesisch"],price:75,bookedDates:["2026-02-22","2026-03-01","2026-03-15"]},{id:"catering-3",name:"Classic Cuisine Co.",rating:4.7,reviewCount:98,specialties:["Amerikanisch","BBQ","Hausmannskost","Buffet"],price:65,bookedDates:["2026-02-21","2026-02-28","2026-03-08"]},{id:"catering-4",name:"Elegant Events Catering",rating:5,reviewCount:87,specialties:["Fine Dining","Molekularkueche","Weinbegleitung"],price:120,bookedDates:["2026-02-19","2026-03-06","2026-03-14"]}]},{id:"decorations",name:"Dekoration",description:"Stilvolle Dekoration fuer eine besondere Atmosphaere",image:"https://images.unsplash.com/photo-1563292749-ec3b11277f72?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxldmVudCUyMGRlY29yYXRpb25zJTIwZmxvd2Vyc3xlbnwxfHx8fDE3NzEwMTY5NzR8MA&ixlib=rb-4.1.0&q=80&w=1080",price:1e3,category:"decorations",providers:[{id:"decor-1",name:"Bloom & Bliss Decorations",rating:4.9,reviewCount:143,specialties:["Blumenarrangements","Romantisch","Gartenthema","Boho"],price:1500,bookedDates:["2026-02-20","2026-02-27","2026-03-06"]},{id:"decor-2",name:"Modern Touch Decor",rating:4.8,reviewCount:118,specialties:["Modern","Minimalistisch","Industrial","Geometrisch"],price:1200,bookedDates:["2026-02-21","2026-03-01","2026-03-15"]},{id:"decor-3",name:"Elegant Affairs",rating:5,reviewCount:96,specialties:["Luxus","Klassisch","Kristall","Kronleuchter"],price:2500,bookedDates:["2026-02-22","2026-02-28","2026-03-08"]}]},{id:"makeup",name:"Make-up & Hair",description:"Professionelles Make-up und Hairstyling fuer dein Event",image:"https://images.unsplash.com/photo-1625139108082-48bb424c2333?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxtYWtldXAlMjBhcnRpc3QlMjBicmlkZXxlbnwxfHx8fDE3NzEwMTY5NzN8MA&ixlib=rb-4.1.0&q=80&w=1080",price:150,category:"makeup",providers:[{id:"makeup-1",name:"Bella Beauty Studio",rating:4.9,reviewCount:201,specialties:["Brautstyling","Airbrush","Natural Look","Vintage"],price:150,bookedDates:["2026-02-20","2026-02-27","2026-03-07"]},{id:"makeup-2",name:"Glam Squad Pro",rating:4.8,reviewCount:167,specialties:["Glamorous","Editorial","Party","Bold Looks"],price:200,bookedDates:["2026-02-21","2026-03-01","2026-03-08"]},{id:"makeup-3",name:"Natural Radiance",rating:4.7,reviewCount:134,specialties:["Natural","Bio-Produkte","Soft Glam","Minimalistisch"],price:180,bookedDates:["2026-02-22","2026-02-28","2026-03-15"]}]},{id:"photography",name:"Fotografie",description:"Professionelle Fotografie, um besondere Momente festzuhalten",image:"https://images.unsplash.com/photo-1759665996004-ff4c8f0745be?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHx3ZWRkaW5nJTIwcGhvdG9ncmFwaGVyJTIwY2FtZXJhfGVufDF8fHx8MTc3MDk0NTU2OXww&ixlib=rb-4.1.0&q=80&w=1080",price:1500,category:"photography",providers:[{id:"photo-1",name:"Timeless Moments Photography",rating:5,reviewCount:178,specialties:["Hochzeiten","Portraets","Reportage","Cinematic"],price:1500,bookedDates:["2026-02-20","2026-02-27","2026-03-06"]},{id:"photo-2",name:"Studio Flash Photography",rating:4.9,reviewCount:145,specialties:["Business","Events","Produkte","Editorial"],price:1200,bookedDates:["2026-02-21","2026-03-01","2026-03-15"]},{id:"photo-3",name:"Artisan Lens Co.",rating:4.8,reviewCount:129,specialties:["Fine Art","Dokumentarisch","Kuenstlerisch","Schwarzweiss"],price:1800,bookedDates:["2026-02-19","2026-02-28","2026-03-08"]},{id:"photo-4",name:"Modern Capture Studio",rating:4.9,reviewCount:112,specialties:["Modern","Drohnenaufnahmen","Video","360 Fotos"],price:2e3,bookedDates:["2026-02-22","2026-03-07","2026-03-14"]}]}];function Js({venue:t}){const{t:s}=me(),n=new Intl.NumberFormat("de-DE").format(t.price);return e.jsx(V,{to:`/venue/${t.id}`,className:"block group",children:e.jsxs("div",{className:"bg-white rounded-xl overflow-hidden shadow-md hover:shadow-xl transition-shadow",children:[e.jsxs("div",{className:"relative h-64 overflow-hidden",children:[e.jsx("img",{src:t.image,alt:t.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}),e.jsx("div",{className:"absolute top-4 right-4 bg-purple-600 text-white px-3 py-1 rounded-full text-sm",children:t.type})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:t.name}),e.jsx("p",{className:"text-gray-600 mb-4 line-clamp-2",children:t.description}),e.jsxs("div",{className:"flex items-center gap-4 mb-4 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ts,{className:"size-4"}),t.location]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Is,{className:"size-4"}),s("venue.guests",{count:t.capacity})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[e.jsxs("span",{className:"text-2xl font-semibold text-purple-600",children:["ab EUR ",n]}),e.jsx("span",{className:"text-sm text-gray-500",children:s("venue.perEvent")})]})]})]})})}function aa(){const t=Bt.slice(0,3),{t:s}=me(),n=Pe(),l=(n==null?void 0:n.role)==="admin"?"/admin":(n==null?void 0:n.role)==="vendor"?"/vendor-portfolio":"/customer-portfolio";return e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsxs("section",{className:"relative overflow-hidden bg-white py-16 sm:py-24 lg:py-28",children:[e.jsx("div",{className:"pointer-events-none absolute inset-0 opacity-70",children:e.jsx("div",{className:"h-full w-full bg-[radial-gradient(circle_at_20%_20%,#d8b4fe_0%,transparent_32%),radial-gradient(circle_at_80%_10%,#c4b5fd_0%,transparent_30%),radial-gradient(circle_at_50%_100%,#ddd6fe_0%,transparent_35%)]"})}),e.jsx("div",{className:"relative w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-3xl mx-auto text-center",children:[e.jsx("h1",{className:"text-4xl sm:text-6xl font-extrabold tracking-tight text-slate-900 mb-4 sm:mb-6",children:s("home.hero.title")}),e.jsx("p",{className:"text-base sm:text-xl mb-7 sm:mb-9 text-slate-600",children:s("home.hero.subtitle")}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[e.jsxs(V,{to:"/venues",className:"inline-flex items-center justify-center gap-2 rounded-lg bg-slate-900 px-6 py-3 text-white font-semibold hover:bg-slate-700 transition-colors",children:[s("home.hero.cta"),e.jsx($e,{className:"size-5"})]}),e.jsx(V,{to:n?l:"/signup",className:"inline-flex items-center justify-center gap-2 rounded-lg border border-slate-300 bg-white px-6 py-3 text-slate-700 font-semibold hover:bg-slate-100 transition-colors",children:s(n?"home.hero.dashboard":"home.hero.vendorStart")})]})]})})]}),e.jsx("section",{className:"py-12 sm:py-16 bg-white",children:e.jsxs("div",{className:"w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-8 sm:mb-12 text-center",children:s("home.categories.title")}),e.jsx("p",{className:"text-center text-slate-600 max-w-xl mx-auto -mt-6 mb-10",children:s("home.categories.subtitle")}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:[e.jsxs(V,{to:"/services?category=dj",className:"group bg-slate-50 border border-slate-200 p-5 sm:p-7 rounded-2xl text-center hover:border-purple-300 hover:bg-white transition-colors",children:[e.jsx("div",{className:"bg-purple-100 w-14 h-14 rounded-xl flex items-center justify-center mx-auto mb-3",children:e.jsx(Os,{className:"size-7 text-purple-600"})}),e.jsx("h3",{className:"font-semibold text-slate-900 mb-1",children:s("home.categories.dj")}),e.jsx("p",{className:"text-slate-500 text-sm",children:s("home.categories.vendors",{count:120})})]}),e.jsxs(V,{to:"/services?category=photography",className:"group bg-slate-50 border border-slate-200 p-5 sm:p-7 rounded-2xl text-center hover:border-purple-300 hover:bg-white transition-colors",children:[e.jsx("div",{className:"bg-purple-100 w-14 h-14 rounded-xl flex items-center justify-center mx-auto mb-3",children:e.jsx(Ms,{className:"size-7 text-purple-600"})}),e.jsx("h3",{className:"font-semibold text-slate-900 mb-1",children:s("home.categories.photo")}),e.jsx("p",{className:"text-slate-500 text-sm",children:s("home.categories.vendors",{count:85})})]}),e.jsxs(V,{to:"/services?category=catering",className:"group bg-slate-50 border border-slate-200 p-5 sm:p-7 rounded-2xl text-center hover:border-purple-300 hover:bg-white transition-colors",children:[e.jsx("div",{className:"bg-purple-100 w-14 h-14 rounded-xl flex items-center justify-center mx-auto mb-3",children:e.jsx(zs,{className:"size-7 text-purple-600"})}),e.jsx("h3",{className:"font-semibold text-slate-900 mb-1",children:s("home.categories.catering")}),e.jsx("p",{className:"text-slate-500 text-sm",children:s("home.categories.vendors",{count:60})})]}),e.jsxs(V,{to:"/services?category=decorations",className:"group bg-slate-50 border border-slate-200 p-5 sm:p-7 rounded-2xl text-center hover:border-purple-300 hover:bg-white transition-colors",children:[e.jsx("div",{className:"bg-purple-100 w-14 h-14 rounded-xl flex items-center justify-center mx-auto mb-3",children:e.jsx(Fs,{className:"size-7 text-purple-600"})}),e.jsx("h3",{className:"font-semibold text-slate-900 mb-1",children:s("home.categories.decoration")}),e.jsx("p",{className:"text-slate-500 text-sm",children:s("home.categories.vendors",{count:45})})]})]})]})}),e.jsx("section",{className:"py-12 sm:py-16",children:e.jsxs("div",{className:"w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-slate-900 text-center",children:s("home.why.title")}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-5 mt-10",children:[e.jsxs(V,{to:"/why/curated-vendors",className:"group rounded-2xl bg-white border border-slate-200 p-6 transition-all duration-300 hover:-translate-y-1 hover:border-purple-300 hover:shadow-lg",children:[e.jsx(Et,{className:"size-7 text-purple-600 mb-3"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:s("home.why.curated.title")}),e.jsx("p",{className:"text-sm text-slate-600 mt-2",children:s("home.why.curated.desc")}),e.jsxs("p",{className:"mt-3 inline-flex items-center gap-1 text-sm font-medium text-purple-700 group-hover:text-purple-800",children:[s("home.why.learnMore"),e.jsx($e,{className:"size-4 transition-transform duration-300 group-hover:translate-x-0.5"})]})]}),e.jsxs(V,{to:"/why/secure-payments",className:"group rounded-2xl bg-white border border-slate-200 p-6 transition-all duration-300 hover:-translate-y-1 hover:border-purple-300 hover:shadow-lg",children:[e.jsx(Vs,{className:"size-7 text-purple-600 mb-3"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:s("home.why.secure.title")}),e.jsx("p",{className:"text-sm text-slate-600 mt-2",children:s("home.why.secure.desc")}),e.jsxs("p",{className:"mt-3 inline-flex items-center gap-1 text-sm font-medium text-purple-700 group-hover:text-purple-800",children:[s("home.why.learnMore"),e.jsx($e,{className:"size-4 transition-transform duration-300 group-hover:translate-x-0.5"})]})]}),e.jsxs(V,{to:"/why/structured-booking",className:"group rounded-2xl bg-white border border-slate-200 p-6 transition-all duration-300 hover:-translate-y-1 hover:border-purple-300 hover:shadow-lg",children:[e.jsx(Xe,{className:"size-7 text-purple-600 mb-3"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:s("home.why.booking.title")}),e.jsx("p",{className:"text-sm text-slate-600 mt-2",children:s("home.why.booking.desc")}),e.jsxs("p",{className:"mt-3 inline-flex items-center gap-1 text-sm font-medium text-purple-700 group-hover:text-purple-800",children:[s("home.why.learnMore"),e.jsx($e,{className:"size-4 transition-transform duration-300 group-hover:translate-x-0.5"})]})]})]})]})}),e.jsx("section",{className:"py-10 sm:py-16 bg-white",children:e.jsxs("div",{className:"w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-8 sm:mb-12",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:s("home.featured.title")}),e.jsxs(V,{to:"/venues",className:"text-purple-600 hover:text-purple-700 flex items-center gap-2",children:[s("home.featured.viewAll"),e.jsx($e,{className:"size-5"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:t.map(r=>e.jsx(Js,{venue:r},r.id))})]})}),e.jsx("section",{className:"py-12 sm:py-20 bg-gradient-to-br from-slate-900 to-purple-900 text-white",children:e.jsxs("div",{className:"w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[e.jsx("h2",{className:"text-2xl sm:text-4xl font-bold mb-4 sm:mb-6",children:s("home.cta.title")}),e.jsx("p",{className:"text-base sm:text-xl text-purple-100 mb-6 sm:mb-8 max-w-2xl mx-auto",children:s("home.cta.subtitle")}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[e.jsxs(V,{to:"/venues",className:"inline-flex items-center justify-center gap-2 bg-white text-purple-700 px-5 sm:px-8 py-3 sm:py-4 rounded-lg font-semibold hover:bg-purple-50 transition-colors",children:[s("home.cta.button"),e.jsx($e,{className:"size-5"})]}),e.jsx(V,{to:"/request",className:"inline-flex items-center justify-center gap-2 border border-white/30 text-white px-5 sm:px-8 py-3 sm:py-4 rounded-lg font-semibold hover:bg-white/10 transition-colors",children:s("home.cta.request")})]})]})})]})}function na(){const{t}=me(),[s,n]=o.useState(""),[l,r]=o.useState("all"),[c,C]=o.useState(null),E=["all",...Array.from(new Set(Bt.map(R=>R.type)))],x=Bt.filter(R=>{const m=R.name.toLowerCase().includes(s.toLowerCase())||R.description.toLowerCase().includes(s.toLowerCase())||R.location.toLowerCase().includes(s.toLowerCase()),d=l==="all"||R.type===l,v=!c||R.capacity>=c;return m&&d&&v});return e.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"mb-12",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:t("venues.title")}),e.jsx("p",{className:"text-gray-600",children:t("venues.subtitle")})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx($s,{className:"size-5 text-gray-600"}),e.jsx("h2",{className:"font-semibold text-gray-900",children:t("venues.filters")})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:t("venues.filter.searchLabel")}),e.jsxs("div",{className:"relative",children:[e.jsx(Us,{className:"absolute left-3 top-1/2 -translate-y-1/2 size-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:t("venues.filter.search"),value:s,onChange:R=>n(R.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:t("venues.filter.type")}),e.jsx("select",{value:l,onChange:R=>r(R.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent",children:E.map(R=>e.jsx("option",{value:R,children:R==="all"?t("venues.filter.all"):R},R))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:t("venues.capacity")}),e.jsx("input",{type:"number",placeholder:t("venues.filter.capacityPlaceholder"),value:c||"",onChange:R=>C(R.target.value?Number(R.target.value):null),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent"})]})]})]}),e.jsx("div",{className:"mb-6",children:e.jsx("p",{className:"text-gray-600",children:x.length===1?t("venues.resultsFound.one",{count:x.length}):t("venues.resultsFound.other",{count:x.length})})}),x.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:x.map(R=>e.jsx(Js,{venue:R},R.id))}):e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-12 text-center",children:[e.jsx("p",{className:"text-gray-600 mb-2",children:t("venues.notFound")}),e.jsx("p",{className:"text-gray-500 text-sm",children:t("venues.notFound.desc")})]})]})})}function ia({service:t,selectedProviderIds:s=[],onAddToCart:n,onCompleteBooking:l,selectedDate:r}){const{t:c,language:C}=me(),[E,x]=o.useState(null),R=m=>r?!m.bookedDates.includes(r):!0;return e.jsxs("div",{className:"bg-white rounded-xl overflow-hidden shadow-md",children:[e.jsx("div",{className:"relative h-48 overflow-hidden",children:e.jsx("img",{src:t.image,alt:t.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:t.name}),e.jsx("p",{className:"text-gray-600 mb-6",children:t.description}),e.jsx("div",{className:"space-y-4",children:t.providers.map(m=>{const d=R(m),v=s.includes(m.id),p=E===m.id;return e.jsxs("div",{className:`border rounded-lg p-4 transition-all ${d?v?"border-purple-600 bg-purple-50 cursor-pointer":"border-gray-200 hover:border-purple-300 cursor-pointer":"border-gray-200 bg-gray-50 opacity-60 cursor-not-allowed"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[m.name,!d&&e.jsx("span",{className:"text-xs bg-red-100 text-red-600 px-2 py-0.5 rounded",children:c("venue.booked")})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Cr,{className:"size-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{className:"text-sm font-medium",children:m.rating})]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",m.reviewCount," ",c("venue.reviews"),")"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-semibold text-purple-600",children:["$",m.price.toLocaleString(),t.category==="catering"&&e.jsx("span",{className:"text-xs text-gray-500",children:c("venue.perPerson")})]}),v&&e.jsx("div",{className:"bg-purple-600 rounded-full p-1",children:e.jsx(ss,{className:"size-4 text-white"})})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:m.specialties.map((u,L)=>e.jsx("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:u},L))}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[e.jsx("button",{type:"button",onClick:()=>x(p?null:m.id),className:"rounded-lg border border-gray-300 px-3 py-1.5 text-sm font-medium text-gray-700 hover:bg-gray-100",children:p?C==="de"?"Schliessen":"Close":C==="de"?"Details ansehen":"View details"}),e.jsx("button",{type:"button",disabled:!d,onClick:()=>n==null?void 0:n(t.id,m.id),className:"rounded-lg bg-purple-600 text-white px-3 py-1.5 text-sm font-semibold hover:bg-purple-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:v?C==="de"?"Ausgewaehlt (klicken zum Entfernen)":"Selected (click to remove)":C==="de"?"Hinzufuegen":"Add"}),e.jsx("button",{type:"button",disabled:!d,onClick:()=>l==null?void 0:l(t.id,m.id),className:"rounded-lg border border-purple-300 text-purple-700 px-3 py-1.5 text-sm font-semibold hover:bg-purple-50 disabled:bg-gray-100 disabled:text-gray-400 disabled:border-gray-300",children:C==="de"?"Buchung abschliessen":"Complete booking"})]}),p&&e.jsxs("div",{className:"mt-4 rounded-lg border border-purple-200 bg-purple-50 p-3 text-sm text-gray-700",children:[e.jsxs("p",{children:[e.jsxs("span",{className:"font-semibold",children:[C==="de"?"Anbieter":"Provider",":"]})," ",m.name]}),e.jsxs("p",{className:"mt-1",children:[e.jsxs("span",{className:"font-semibold",children:[C==="de"?"Bewertung":"Rating",":"]})," ",m.rating," (",m.reviewCount," ",c("venue.reviews"),")"]}),e.jsxs("p",{className:"mt-1",children:[e.jsxs("span",{className:"font-semibold",children:[C==="de"?"Spezialitaeten":"Specialties",":"]})," ",m.specialties.join(", ")]}),!d&&e.jsx("p",{className:"mt-2 text-red-600",children:c("venue.booked")})]})]},m.id)})})]})]})}function Ie(...t){return nr(ir(t))}const bs=or("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background text-foreground hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9 rounded-md"}},defaultVariants:{variant:"default",size:"default"}});function oa({className:t,classNames:s,showOutsideDays:n=!0,...l}){return e.jsx(lr,{showOutsideDays:n,className:Ie("p-2 sm:p-3",t),classNames:{months:"flex flex-col sm:flex-row gap-2",month:"flex flex-col gap-4",caption:"flex justify-center pt-1 relative items-center w-full",caption_label:"text-sm font-medium",nav:"flex items-center gap-1",nav_button:Ie(bs({variant:"outline"}),"size-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-x-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-7 sm:w-8 font-normal text-[0.72rem] sm:text-[0.8rem]",row:"flex w-full mt-2",cell:Ie("relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-range-end)]:rounded-r-md",l.mode==="range"?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:Ie(bs({variant:"ghost"}),"size-7 sm:size-8 p-0 font-normal aria-selected:opacity-100"),day_range_start:"day-range-start aria-selected:bg-primary aria-selected:text-primary-foreground",day_range_end:"day-range-end aria-selected:bg-primary aria-selected:text-primary-foreground",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...s},components:{IconLeft:({className:r,...c})=>e.jsx(Er,{className:Ie("size-4",r),...c}),IconRight:({className:r,...c})=>e.jsx(Ar,{className:Ie("size-4",r),...c})},...l})}function la({...t}){return e.jsx(Pr,{"data-slot":"popover",...t})}function ca({...t}){return e.jsx(Dr,{"data-slot":"popover-trigger",...t})}function da({className:t,align:s="center",sideOffset:n=4,...l}){return e.jsx(Rr,{children:e.jsx(Tr,{"data-slot":"popover-content",align:s,sideOffset:n,className:Ie("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",t),...l})})}function Kt(t){return{id:t.id,title:t.name,price:t.price,image:t.image,location:t.location}}const Ct="http://localhost:4000",tt=9e4;function is(){return H("/api/customer/profile",{method:"GET"})}function it(t){return H("/api/customer/profile",{method:"PATCH",body:JSON.stringify(t)})}async function H(t,s={}){const n=new AbortController,l=Number.isFinite(tt)&&tt>0?tt:9e4,r=window.setTimeout(()=>n.abort(),l);let c;const C=Gr(),E={"Content-Type":"application/json",...C?{Authorization:`Bearer ${C}`}:{},...s.headers||{}};try{c=await fetch(`${Ct}${t}`,{headers:E,signal:n.signal,...s})}catch(R){throw R instanceof Error&&R.name==="AbortError"?new Error(`API Timeout (${Math.round(l/1e3)}s). Backend antwortet nicht: ${Ct}. Bei Render kann ein Cold Start 30-90s dauern. Bitte erneut versuchen.`):new Error(`API nicht erreichbar (${Ct}). Bitte starte den Backend-Server mit "npm run dev:api".`)}finally{window.clearTimeout(r)}const x=await c.json().catch(()=>({}));if(!c.ok)throw new Error(x.error||`Request failed: ${c.status}`);return x}function ye(t){return{Authorization:`Bearer ${t}`}}function ma(t){return H("/api/auth/signup/vendor",{method:"POST",body:JSON.stringify(t)})}function ua(t){return H("/api/auth/google/vendor/verify",{method:"POST",body:JSON.stringify({idToken:t})})}function ga(t){return H("/api/auth/google/vendor/login",{method:"POST",body:JSON.stringify({idToken:t})})}function pa(t){return H("/api/auth/vendor/login",{method:"POST",body:JSON.stringify(t)})}function Ws(t){return H("/api/auth/google/customer/login",{method:"POST",body:JSON.stringify({idToken:t})})}function os(t){return H("/api/requests",{method:"POST",body:JSON.stringify(t)})}function xa(){return H("/api/requests/open")}function ha(){return H("/api/services-catalog")}function Ot(t){return H(`/api/requests?customerEmail=${encodeURIComponent(t)}`)}function Zs(t,s){return H(`/api/requests/${encodeURIComponent(t)}/cancel`,{method:"POST",body:JSON.stringify({customerEmail:s})})}function ba(t,s){return H(`/api/requests/${t}/offers`,{method:"POST",body:JSON.stringify(s)})}function fa(t,s={}){return H(`/api/vendor/requests/${encodeURIComponent(t)}/decline`,{method:"POST",body:JSON.stringify(s)})}function Ys(t,s,n,l){return H(`/api/requests/${t}/offers/${s}`,{method:"PATCH",headers:l!=null&&l.adminToken?ye(l.adminToken):void 0,body:JSON.stringify({status:n,customerEmail:l==null?void 0:l.customerEmail})})}function ya(t){return H(`/api/vendor/offers?vendorEmail=${encodeURIComponent(t)}`)}function va(t,s){return H(`/api/vendor/offers/${encodeURIComponent(t)}`,{method:"PATCH",body:JSON.stringify(s)})}function fs(t){return H(`/api/vendor/profile?email=${encodeURIComponent(t)}`)}function ja(t){return H("/api/vendor/profile",{method:"PATCH",body:JSON.stringify(t)})}function Na(t){return H(`/api/vendor/compliance?vendorEmail=${encodeURIComponent(t)}`)}function wa(t){return H("/api/vendor/compliance/contract-accept",{method:"POST",body:JSON.stringify(t)})}function ka(t){return H(`/api/vendor/posts?vendorEmail=${encodeURIComponent(t)}`)}function Sa(){return H("/api/vendor/posts/public")}function Ca(t){return H("/api/vendor/posts",{method:"POST",body:JSON.stringify(t)})}function ys(t,s){return H(`/api/vendor/posts/${t}`,{method:"PATCH",body:JSON.stringify(s)})}function Aa(t){return H("/api/vendor/inquiries",{method:"POST",body:JSON.stringify(t)})}function Ea(t){return H("/api/admin/overview",{method:"GET",headers:ye(t)})}function Pa(t){return H("/api/admin/vendor-applications",{method:"GET",headers:ye(t)})}function Da(t){return H("/api/admin/vendor-compliance",{method:"GET",headers:ye(t)})}function Ra(t){return H("/api/admin/payouts",{method:"GET",headers:ye(t)})}function Ta(t){return H("/api/admin/kpis",{method:"GET",headers:ye(t)})}function La(t){return H("/api/admin/ledger",{method:"GET",headers:ye(t)})}function Ba(t,s){return H(`/api/admin/payouts/${s}/release`,{method:"POST",headers:ye(t)})}function Ia(t){return H("/api/admin/audit-logs",{method:"GET",headers:ye(t)})}function Oa(t,s){return H(`/api/admin/bookings/${encodeURIComponent(s)}/accounting-pack`,{method:"GET",headers:ye(t)})}async function Ma(t,s){const n=new AbortController,l=Number.isFinite(tt)&&tt>0?tt:9e4,r=window.setTimeout(()=>n.abort(),l);try{const c=await fetch(`${Ct}/api/admin/bookings/${encodeURIComponent(s)}/accounting-pack.pdf`,{method:"GET",headers:ye(t),signal:n.signal});if(!c.ok){const C=await c.json().catch(()=>({}));throw new Error(C.error||`Request failed: ${c.status}`)}return await c.blob()}catch(c){throw c instanceof Error&&c.name==="AbortError"?new Error(`API Timeout (${Math.round(l/1e3)}s) while generating PDF.`):c}finally{window.clearTimeout(r)}}function za(t){return H("/api/admin/vendor-compliance/backfill",{method:"POST",headers:ye(t)})}function Fa(t,s,n,l){return H(`/api/admin/vendor-applications/${s}`,{method:"PATCH",headers:ye(t),body:JSON.stringify({status:n,reviewNote:l})})}function Va(t,s,n){return H(`/api/admin/vendor-applications/${s}/compliance/${n}/confirm`,{method:"POST",headers:ye(t)})}function $a(t){return H("/api/admin/requests",{method:"GET",headers:ye(t)})}function Ua(t){return H("/api/admin/services/seed",{method:"POST",headers:ye(t)})}function qa(t){return H("/api/admin/vendors/seed-demo",{method:"POST",headers:ye(t)})}function Ga(t){return H("/api/admin/inquiries",{method:"GET",headers:ye(t)})}function Ha(t,s,n,l=[]){return H(`/api/admin/inquiries/${encodeURIComponent(s)}/reply`,{method:"POST",headers:ye(t),body:JSON.stringify({replyMessage:n,attachmentUrls:l})})}function _a(){return H("/api/vendor/inquiries",{method:"GET"})}function Ka(t){return H("/api/admin/login",{method:"POST",body:JSON.stringify(t)})}function Ja(t){return H("/api/payments/checkout-session",{method:"POST",body:JSON.stringify(t)})}function Wa(t){return H("/api/stripe/connect/onboard",{method:"POST",body:JSON.stringify(t)})}function Za(t){return H(`/api/stripe/connect/status?vendorEmail=${encodeURIComponent(t)}`)}function Xs(t){return H("/api/uploads/vendor-document-url",{method:"POST",body:JSON.stringify(t)})}async function Qt(t){const s=await Xs({filename:t.name||"attachment",contentType:t.type||"application/octet-stream"}),n=await fetch(s.uploadUrl,{method:"PUT",headers:{"Content-Type":t.type||"application/octet-stream"},body:t});if(!n.ok)throw new Error(`Failed to upload file "${t.name}" (${n.status})`);if(!s.publicUrl)throw new Error("Upload succeeded but public URL is missing. Configure R2_PUBLIC_BASE_URL.");return{fileKey:s.fileKey,publicUrl:s.publicUrl,filename:t.name}}function Ya(t,s,n){return H(`/api/bookings/${t}/items/${s}/offer`,{method:"POST",body:JSON.stringify(n)})}function Xa(t,s,n){return H(`/api/bookings/${t}/items/${s}/accept`,{method:"POST",body:JSON.stringify(n)})}function Qa(t,s,n){return H(`/api/bookings/${t}/items/${s}/decline`,{method:"POST",body:JSON.stringify(n)})}function en(t,s){const n=new URLSearchParams;s!=null&&s.customerEmail&&n.set("customerEmail",s.customerEmail),s!=null&&s.vendorEmail&&n.set("vendorEmail",s.vendorEmail);const l=n.toString()?`?${n.toString()}`:"";return H(`/api/bookings/${t}/thread${l}`)}function tn(t,s){return H(`/api/bookings/${t}/checkout`,{method:"POST",body:JSON.stringify(s)})}function sn(t,s){return H(`/api/bookings/${t}/agreement/accept`,{method:"POST",body:JSON.stringify(s)})}function rn(t){return H("/api/marketplace/reviews",{method:"POST",body:JSON.stringify(t)})}function vs(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(t||"").trim())}function an(){var b,se;const{id:t}=ot(),s=qe(),{t:n,language:l}=me(),{cart:r,setVenue:c,toggleService:C,hasService:E,removeService:x,total:R}=lt(),m=Bt.find(h=>h.id===t),[d,v]=o.useState(""),[p,u]=o.useState(!1),[L,z]=o.useState("50"),[j,N]=o.useState(!1),[f,y]=o.useState(!1),[O,te]=o.useState(!1),[q,W]=o.useState({name:"",email:"",phone:"",address:"",notes:""}),[M,A]=o.useState("idle"),T=o.useMemo(()=>Pe(),[]),$=(T==null?void 0:T.role)==="customer"?(T.user.email||"").trim():"",K=o.useRef(""),D=o.useRef(!1),S=(T==null?void 0:T.role)==="vendor"||(T==null?void 0:T.role)==="admin",F=m?`venueState:${m.id}`:"",B="http://localhost:4000",oe=window.location.origin,le="venue-checkout-section",we="venue-cart-section",ge=o.useRef(null),G=o.useRef(null),ne=o.useRef(null),[U,Y]=o.useState(!1);if(o.useEffect(()=>{if(F)try{const h=localStorage.getItem(F);if(!h)return;const I=JSON.parse(h);typeof I.selectedDate=="string"&&v(I.selectedDate),typeof I.estimatedGuests=="string"&&z(I.estimatedGuests)}catch{}},[F]),o.useEffect(()=>{F&&localStorage.setItem(F,JSON.stringify({selectedDate:d,estimatedGuests:L}))},[F,d,L]),o.useEffect(()=>{if(!T||T.role!=="customer")return;let h=!0;return(async()=>{try{const ee=await is();if(!h)return;const de=ee.profile||{name:"",phone:"",address:""};W(Ne=>({...Ne,name:Ne.name||de.name||T.user.name||"",email:Ne.email||T.user.email||"",phone:Ne.phone||de.phone||"",address:Ne.address||de.address||""})),K.current=JSON.stringify({name:(de.name||T.user.name||"").trim(),phone:String(de.phone||"").trim(),address:String(de.address||"").trim()})}catch{if(!h)return;W(ee=>({...ee,name:ee.name||T.user.name||"",email:ee.email||T.user.email||""}))}finally{if(!h)return;D.current=!0}})(),()=>{h=!1}},[T]),o.useEffect(()=>{if(!$||!D.current)return;const h={name:q.name.trim(),phone:q.phone.trim(),address:q.address.trim()};if(!h.name)return;const I=JSON.stringify(h);if(I===K.current)return;const ee=window.setTimeout(async()=>{A("saving");try{await it({name:h.name,phone:h.phone||void 0,address:h.address||void 0}),K.current=I,A("saved"),window.setTimeout(()=>A("idle"),1200)}catch{A("idle")}},700);return()=>window.clearTimeout(ee)},[q.address,q.name,q.phone,$]),o.useEffect(()=>{var h;m&&((h=r.venue)==null?void 0:h.id)!==m.id&&c(Kt(m))},[m,(b=r.venue)==null?void 0:b.id,c]),!m)return e.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:e.jsxs("div",{className:"container mx-auto px-4 text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:n("venue.notFound.title")}),e.jsx(V,{to:"/venues",className:"text-purple-600 hover:text-purple-700",children:n("venue.back")})]})});const ue=(h,I)=>{const ee=nt.find(Ne=>Ne.id===h),de=ee==null?void 0:ee.providers.find(Ne=>Ne.id===I);!ee||!de||C({id:`${h}:${I}`,title:`${ee.name} - ${de.name}`,price:de.price,category:ee.category,serviceId:h,providerId:I})},re=(h,I)=>{var ee;E(`${h}:${I}`)||ue(h,I),((ee=r.venue)==null?void 0:ee.id)!==m.id&&c(Kt(m)),s("/cart")},he=o.useMemo(()=>r.services.map(h=>{const I=nt.find(de=>de.id===h.serviceId),ee=I==null?void 0:I.providers.find(de=>de.id===h.providerId);return{item:h,service:I,provider:ee}}).filter(h=>h.service&&h.provider),[r.services]),pe=()=>{var de;const h=Number.parseInt(L,10),I=Number.isFinite(h)&&h>0?h:1,ee=he.reduce((Ne,Fe)=>{var be;return((be=Fe.service)==null?void 0:be.category)==="catering"?Ne+Fe.provider.price*I:Ne+Fe.provider.price},0);return(((de=r.venue)==null?void 0:de.price)??0)+ee},Le=()=>{if(S){alert("Please use a customer account to continue.");return}if(!xe())return;if(m.bookedDates.includes(d)){alert(n("venue.alert.notAvailable"));return}const h={venue:m,selectedDate:d,estimatedGuests:L,selectedProviders:he.map(I=>({service:I.service,provider:I.provider,quantity:1}))};sessionStorage.setItem("bookingData",JSON.stringify(h)),s("/booking")},ke=async()=>{if(S){alert("Please use a customer account for checkout.");return}if(xe()){if(!r.venue){alert("Select a venue to continue.");return}N(!0);try{const h=await fetch(`${B}/api/stripe/checkout`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cart:{venue:r.venue,services:[],currency:r.currency},customer:q,successUrl:`${oe}/checkout/success`,cancelUrl:`${oe}/cart`})});if(!h.ok){const ee=await h.json().catch(()=>({}));alert(`Checkout error: ${(ee==null?void 0:ee.error)||h.statusText}`);return}const I=await h.json();if(!(I!=null&&I.url)){alert("Checkout URL missing. Please try again.");return}window.location.href=I.url}catch(h){const I=h instanceof Error?` ${h.message}`:"";alert(`Network error while starting checkout (${B}).${I}`)}finally{N(!1)}}},Te=async h=>{if(h.preventDefault(),!!xe()){if(!q.name.trim()||!q.email.trim()){alert("Please enter name and email.");return}if(!vs(q.email)){alert("Please enter a valid email address.");return}if(!q.address.trim()){alert("Please enter billing address before checkout.");return}try{const I={name:q.name.trim(),phone:q.phone.trim(),address:q.address.trim()};A("saving"),await it({name:I.name,phone:I.phone||void 0,address:I.address||void 0}),K.current=JSON.stringify(I),A("saved")}catch{A("error"),alert("Could not save customer profile. Please try again.");return}await ke()}},De=()=>{if(!r.venue){alert("Select a venue to continue.");return}y(!0),setTimeout(()=>{y(!1),alert("Saved. You can continue later from Cart."),s("/cart")},200)},ve=he.some(h=>{var I;return((I=h.service)==null?void 0:I.category)==="catering"}),w=d?!m.bookedDates.includes(d):!0,P=!!d&&!!q.name.trim()&&vs(q.email)&&!!q.address.trim(),Z=new Date().toISOString().split("T")[0],Q=d?new Date(`${d}T00:00:00`):void 0,ce=Q?Q.toLocaleDateString(l==="de"?"de-DE":"en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}):"",ie=h=>`${h.getFullYear()}-${String(h.getMonth()+1).padStart(2,"0")}-${String(h.getDate()).padStart(2,"0")}`,Be=h=>m.bookedDates.includes(ie(h)),Oe=h=>ie(h)>=Z&&!Be(h),Re=()=>{var h;(h=document.getElementById(le))==null||h.scrollIntoView({behavior:"smooth",block:"center"})},je=()=>{var h;(h=document.getElementById(we))==null||h.scrollIntoView({behavior:"smooth",block:"center"})},xe=()=>{var h;return d?(Y(!1),!0):(Y(!0),(h=ge.current)==null||h.scrollIntoView({behavior:"smooth",block:"center"}),u(!0),window.setTimeout(()=>{var I;(I=G.current)==null||I.focus()},250),!1)},Ce=()=>{xe()&&(te(!0),window.setTimeout(()=>{var h;(h=ne.current)==null||h.scrollIntoView({behavior:"smooth",block:"center"})},80))};return e.jsx("div",{className:"min-h-screen bg-gray-50 py-6 sm:py-12",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsx(V,{to:"/venues",className:"text-purple-600 hover:text-purple-700 mb-6 inline-block",children:n("venue.back")}),e.jsx("div",{className:"bg-white rounded-xl shadow-md overflow-hidden mb-6 sm:mb-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-0",children:[e.jsx("div",{className:"h-64 sm:h-80 lg:h-auto",children:e.jsx("img",{src:m.image,alt:m.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"p-5 sm:p-8",children:[e.jsx("div",{className:"inline-block bg-purple-100 text-purple-600 px-3 py-1 rounded-full text-sm mb-4",children:m.type}),e.jsx("h1",{className:"text-2xl sm:text-4xl font-bold text-gray-900 mb-4",children:m.name}),e.jsx("p",{className:"text-gray-600 mb-6",children:m.description}),e.jsxs("div",{className:"flex items-center gap-6 mb-6 text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ts,{className:"size-5"}),e.jsx("span",{children:m.location})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Is,{className:"size-5"}),e.jsx("span",{children:n("venue.guests",{count:m.capacity})})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:n("venue.features")}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:m.features.map((h,I)=>e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(ss,{className:"size-4 text-purple-600"}),e.jsx("span",{className:"text-sm",children:h})]},I))})]}),e.jsxs("div",{className:"pt-6 border-t",children:[e.jsxs("div",{className:"flex items-baseline gap-2 mb-3",children:[e.jsxs("span",{className:"text-4xl font-bold text-purple-600",children:["$",m.price.toLocaleString()]}),e.jsx("span",{className:"text-gray-500",children:n("venue.perEvent")})]}),e.jsx("button",{type:"button",onClick:()=>c(Kt(m)),className:"rounded-lg bg-purple-600 px-4 py-2.5 text-sm font-semibold text-white hover:bg-purple-700",children:((se=r.venue)==null?void 0:se.id)===m.id?"Added ?":"Add venue to cart"})]})]})]})}),e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-4",children:n("venue.services.title")}),e.jsx("p",{className:"text-gray-600 mb-8",children:n("venue.services.desc")}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-5 sm:gap-8",children:nt.map(h=>e.jsx(ia,{service:h,selectedProviderIds:h.providers.filter(I=>E(`${h.id}:${I.id}`)).map(I=>I.id),onAddToCart:ue,onCompleteBooking:re,selectedDate:d},h.id))})]}),e.jsxs("div",{id:le,className:"bg-white rounded-xl shadow-md p-4 sm:p-8 sticky bottom-2 sm:bottom-4",children:[e.jsxs("div",{className:"flex flex-col gap-6 lg:flex-row lg:items-end lg:justify-between",children:[e.jsxs("div",{className:"flex-1 grid gap-6 lg:grid-cols-2 lg:items-end",children:[e.jsxs("div",{ref:ge,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Xe,{className:"size-5 text-purple-600"}),e.jsx("h3",{className:"font-semibold text-gray-900",children:n("venue.eventDate")})]}),U&&!d&&e.jsxs("div",{className:"mb-2 rounded-md border border-red-300 bg-red-50 px-3 py-2 text-xs font-semibold text-red-700",children:[n("venue.alert.selectDateRibbon"),". ",n("venue.alert.selectDateRibbonHint")]}),e.jsxs(la,{open:p,onOpenChange:u,children:[e.jsx(ca,{asChild:!0,children:e.jsxs("button",{ref:G,type:"button",className:`w-full max-w-sm flex items-center justify-between gap-3 text-left px-3 sm:px-4 py-2.5 sm:py-3 border rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent ${U&&!d?"border-red-400 ring-1 ring-red-300":"border-gray-300 hover:border-purple-300"}`,children:[e.jsx("span",{children:d?ce:n("venue.selectDate")}),e.jsx(Xe,{className:"size-5 text-purple-600"})]})}),e.jsx(da,{align:"start",className:"w-[min(92vw,340px)] sm:w-auto p-2",children:e.jsx(oa,{mode:"single",selected:Q,onSelect:h=>{h&&(v(ie(h)),Y(!1),u(!1))},fromDate:new Date(`${Z}T00:00:00`),modifiers:{booked:Be,available:Oe},modifiersClassNames:{booked:"bg-red-100 text-red-700 hover:bg-red-200",available:"bg-green-100 text-green-700 hover:bg-green-200"}})})]})]}),e.jsxs("div",{children:[ve&&e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Guests (for catering estimate)"}),e.jsx("input",{type:"number",min:1,value:L,onChange:h=>z(h.target.value),className:"w-full max-w-[220px] rounded-lg border border-gray-300 px-3 py-2 text-sm focus:ring-2 focus:ring-purple-600 focus:border-transparent"})]}),e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:n("venue.summary.title")}),e.jsxs("div",{className:"text-2xl sm:text-3xl font-bold text-purple-600",children:["EUR ",pe().toLocaleString()]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Global cart total: EUR ",R.toLocaleString()]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Pay now charges venue only. Services are paid after vendor acceptance."})]})]}),e.jsxs("div",{id:we,className:"w-full lg:w-[360px] border border-gray-200 rounded-lg p-3 sm:p-4 bg-gray-50",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:l==="de"?"Warenkorb":"Cart"}),he.length===0?e.jsx("p",{className:"text-sm text-gray-600",children:l==="de"?"Noch keine Services hinzugefuegt.":"No services added yet."}):e.jsx("div",{className:"space-y-3 max-h-56 overflow-auto pr-1",children:he.map(({item:h,service:I,provider:ee})=>e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-2.5",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:ee.name}),e.jsx("p",{className:"text-xs text-gray-500",children:I.name}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm font-medium text-purple-700",children:["EUR ",ee.price.toLocaleString()]}),e.jsxs("button",{type:"button",onClick:()=>x(h.id),className:"inline-flex items-center gap-1 rounded border border-red-200 text-red-600 px-2 py-1 text-xs hover:bg-red-50",children:[e.jsx(Pt,{className:"size-3.5"}),l==="de"?"Entfernen":"Remove"]})]})]},h.id))}),e.jsx(V,{to:"/cart",className:"mt-3 inline-flex text-sm font-medium text-purple-700 hover:text-purple-900",children:l==="de"?"Zum Warenkorb":"Go to cart"})]}),e.jsxs("div",{className:"w-full lg:w-auto flex flex-col gap-2",children:[e.jsxs("button",{onClick:Ce,disabled:!r.venue||j||S,className:"w-full lg:w-auto flex items-center justify-center gap-2 bg-purple-600 text-white px-6 sm:px-8 py-3 sm:py-4 rounded-lg font-semibold hover:bg-purple-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:[j?"Starting checkout...":S?"Customers only":"Complete booking",e.jsx($e,{className:"size-5"})]}),e.jsx("button",{onClick:De,disabled:!r.venue||f,className:"w-full lg:w-auto rounded-lg border border-purple-300 bg-white px-6 sm:px-8 py-3 sm:py-4 text-sm font-semibold text-purple-700 hover:bg-purple-50 disabled:bg-gray-100 disabled:text-gray-400",children:f?"Saving...":"Save for later"}),e.jsx("button",{onClick:Le,disabled:d&&!w||S,className:"w-full lg:w-auto rounded-lg border border-gray-300 bg-white px-6 sm:px-8 py-3 text-sm font-semibold text-gray-700 hover:bg-gray-50 disabled:bg-gray-100 disabled:text-gray-400",children:S?l==="de"?"Nur fuer Kundenkonto":"Customers only":n("venue.summary.proceed")})]})]}),O&&e.jsxs("form",{ref:ne,onSubmit:Te,className:"mt-4 rounded-lg border border-gray-200 p-4 space-y-3",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:"Complete booking"}),M!=="idle"&&e.jsxs("p",{className:`text-xs ${M==="error"?"text-red-600":"text-gray-500"}`,children:[M==="saving"&&"Saving profile...",M==="saved"&&"Profile saved for future checkouts.",M==="error"&&"Could not auto-save profile."]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx("input",{type:"text",required:!0,placeholder:"Full name",value:q.name,onChange:h=>W(I=>({...I,name:h.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5"}),e.jsx("input",{type:"email",required:!0,placeholder:"Email",value:q.email,onChange:h=>W(I=>({...I,email:h.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5"}),e.jsx("input",{type:"tel",placeholder:"Phone (optional)",value:q.phone,onChange:h=>W(I=>({...I,phone:h.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5"}),e.jsx("input",{type:"text",required:!0,placeholder:"Address",value:q.address,onChange:h=>W(I=>({...I,address:h.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5"}),e.jsx("input",{type:"text",placeholder:"Short note (optional)",value:q.notes,onChange:h=>W(I=>({...I,notes:h.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5"})]}),e.jsx("button",{type:"submit",disabled:!r.venue||j||S||!P,className:"inline-flex items-center justify-center gap-2 rounded-lg bg-purple-600 px-4 py-2.5 text-sm font-semibold text-white hover:bg-purple-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:j?"Starting checkout...":"Pay now"}),!P&&e.jsx("p",{className:"text-xs text-amber-700",children:"Choose date and fill valid name, email, and address to pay now."})]})]}),e.jsx("button",{type:"button","aria-label":"Go to checkout section",onClick:Re,className:"fixed z-40 right-4 sm:right-6 bottom-24 sm:bottom-28 h-12 w-12 rounded-full bg-purple-600 text-white shadow-lg hover:bg-purple-700 transition-all duration-300 flex items-center justify-center animate-pulse",children:e.jsx($e,{className:"size-5"})}),e.jsx("button",{type:"button","aria-label":"Go to cart section",onClick:je,className:"fixed z-40 right-4 sm:right-6 bottom-40 sm:bottom-44 rounded-full bg-white border border-purple-300 text-purple-700 px-3 py-1.5 text-xs font-semibold shadow-md hover:bg-purple-50 transition-colors",children:l==="de"?"Warenkorb":"Cart"}),e.jsx("div",{className:"fixed z-30 right-4 sm:right-6 bottom-16 sm:bottom-20 rounded-full bg-white/95 border border-purple-200 px-3 py-1 text-[11px] text-purple-700 shadow-sm",children:l==="de"?"Zum Checkout":"Go to checkout"})]})})}function nn(){const t=qe(),{t:s,language:n}=me(),[l,r]=o.useState(null),[c,C]=o.useState(!1),[E,x]=o.useState({name:"",email:"",phone:"",altName:"",altPhone:"",contactMethod:"email",eventTime:"",setupTime:"",eventType:"",guests:"",eventAddress:"",city:"",postalCode:"",notes:"",reviewAccepted:!1});o.useEffect(()=>{const u=Pe();if((u==null?void 0:u.role)==="vendor"||(u==null?void 0:u.role)==="admin"){t("/venues");return}const L=sessionStorage.getItem("bookingData");if(L){const z=JSON.parse(L);r(z),z!=null&&z.estimatedGuests&&x(j=>({...j,guests:String(z.estimatedGuests)}))}},[t]);const R=u=>{u.preventDefault(),C(!0),sessionStorage.removeItem("bookingData"),setTimeout(()=>{t("/")},3e3)},m=u=>{const{name:L,value:z}=u.target,j=u.target instanceof HTMLInputElement?u.target.checked:!1;x(N=>({...N,[L]:L==="reviewAccepted"?j:z}))},d=()=>{if(!l)return 0;let u=l.venue.price;const L=parseInt(E.guests,10)||0;return(l.selectedProviders||[]).forEach(z=>{var N;const j=Number.isFinite(z.quantity)?Math.max(1,z.quantity):1;((N=z.service)==null?void 0:N.category)==="catering"?u+=L>0?z.provider.price*L:0:u+=z.provider.price*j}),u},v=()=>{const u=d(),L=1.1,z=Number.isFinite(L)&&L>0?L:1.1;return Math.round(u*z)},p=n==="de"?"de-DE":"en-US";return c?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-12 max-w-md text-center",children:[e.jsx("div",{className:"bg-green-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(ss,{className:"size-10 text-green-600"})}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:s("booking.success.title")}),e.jsx("p",{className:"text-gray-600 mb-2",children:s("booking.success.message",{email:E.email})}),e.jsx("p",{className:"text-sm font-semibold text-purple-700 mt-2",children:s("booking.success.status")}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 mt-6 mb-6",children:[e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsxs("strong",{children:[s("booking.success.eventDate"),":"]})," ",l==null?void 0:l.selectedDate]}),e.jsxs("p",{className:"text-sm text-gray-700 mt-1",children:[e.jsxs("strong",{children:[s("booking.success.eventTime"),":"]})," ",E.eventTime]})]}),e.jsx("p",{className:"text-sm text-gray-500",children:s("booking.success.redirecting")})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-6 sm:py-12",children:e.jsxs("div",{className:"container mx-auto px-4 max-w-6xl",children:[e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h1",{className:"text-2xl sm:text-4xl font-bold text-gray-900 mb-3 sm:mb-4",children:s("booking.title")}),e.jsx("p",{className:"text-gray-600",children:s("booking.subtitle")})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-5 sm:gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("form",{onSubmit:R,className:"bg-white rounded-xl shadow-md p-5 sm:p-8",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 mb-5 sm:mb-6",children:s("booking.info.title")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s("booking.info.name")," *"]}),e.jsx("input",{type:"text",name:"name",required:!0,value:E.name,onChange:m,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent",placeholder:"Max Mustermann"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s("booking.info.email")," *"]}),e.jsx("input",{type:"email",name:"email",required:!0,value:E.email,onChange:m,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent",placeholder:"max@example.com"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s("booking.info.phone")," *"]}),e.jsx("input",{type:"tel",name:"phone",required:!0,value:E.phone,onChange:m,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent",placeholder:"+49 170 1234567"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:s("booking.info.altName")}),e.jsx("input",{type:"text",name:"altName",value:E.altName,onChange:m,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:s("booking.info.altPhone")}),e.jsx("input",{type:"tel",name:"altPhone",value:E.altPhone,onChange:m,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s("booking.info.contactMethod")," *"]}),e.jsxs("select",{name:"contactMethod",required:!0,value:E.contactMethod,onChange:m,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent",children:[e.jsx("option",{value:"email",children:s("booking.info.contactMethod.email")}),e.jsx("option",{value:"phone",children:s("booking.info.contactMethod.phone")}),e.jsx("option",{value:"whatsapp",children:s("booking.info.contactMethod.whatsapp")})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s("booking.info.address")," *"]}),e.jsx("input",{type:"text",name:"eventAddress",required:!0,value:E.eventAddress,onChange:m,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s("booking.info.city")," *"]}),e.jsx("input",{type:"text",name:"city",required:!0,value:E.city,onChange:m,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s("booking.info.postalCode")," *"]}),e.jsx("input",{type:"text",name:"postalCode",required:!0,value:E.postalCode,onChange:m,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s("booking.info.time")," *"]}),e.jsxs("div",{className:"relative",children:[e.jsx(Lr,{className:"absolute left-3 top-1/2 -translate-y-1/2 size-5 text-gray-400"}),e.jsx("input",{type:"time",name:"eventTime",required:!0,value:E.eventTime,onChange:m,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:s("booking.info.setupTime")}),e.jsx("input",{type:"time",name:"setupTime",value:E.setupTime,onChange:m,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s("booking.info.type")," *"]}),e.jsxs("select",{name:"eventType",required:!0,value:E.eventType,onChange:m,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent",children:[e.jsx("option",{value:"",children:s("booking.type.select")}),e.jsx("option",{value:"wedding",children:s("booking.type.wedding")}),e.jsx("option",{value:"corporate",children:s("booking.type.corporate")}),e.jsx("option",{value:"birthday",children:s("booking.type.birthday")}),e.jsx("option",{value:"conference",children:s("booking.type.conference")}),e.jsx("option",{value:"other",children:s("booking.type.other")})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s("booking.info.guests")," *"]}),e.jsx("input",{type:"number",name:"guests",required:!0,value:E.guests,onChange:m,min:"1",max:l==null?void 0:l.venue.capacity,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent",placeholder:(l==null?void 0:l.estimatedGuests)||"100"}),l&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s("booking.info.maxCapacity",{count:l.venue.capacity})})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:s("booking.info.notes")}),e.jsx("textarea",{name:"notes",value:E.notes,onChange:m,rows:4,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent",placeholder:s("booking.info.notes.placeholder")})]}),e.jsxs("div",{className:"mb-6 rounded-lg border border-amber-200 bg-amber-50 p-4",children:[e.jsx("p",{className:"text-sm text-amber-900",children:s("booking.review.notice")}),e.jsxs("label",{className:"mt-3 flex items-start gap-2 text-sm text-amber-900",children:[e.jsx("input",{type:"checkbox",name:"reviewAccepted",required:!0,checked:E.reviewAccepted,onChange:m,className:"mt-1"}),e.jsx("span",{children:s("booking.review.approval")})]})]}),e.jsxs("button",{type:"submit",className:"w-full bg-purple-600 text-white py-3 sm:py-4 rounded-lg font-semibold hover:bg-purple-700 transition-colors flex items-center justify-center gap-2",children:[e.jsx(Xe,{className:"size-5"}),s("booking.submit")]})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-4 sm:p-6 lg:sticky lg:top-24",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900 mb-4 sm:mb-6",children:s("booking.summary.title")}),l?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"pb-4 border-b",children:[e.jsxs("div",{className:"flex items-center gap-2 text-purple-600 mb-2",children:[e.jsx(Xe,{className:"size-5"}),e.jsx("span",{className:"font-semibold",children:s("booking.summary.eventDate")})]}),e.jsx("p",{className:"text-lg font-medium text-gray-900",children:new Date(l.selectedDate+"T00:00:00").toLocaleDateString(p,{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:s("booking.summary.venue")}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("p",{className:"font-medium text-gray-900",children:l.venue.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:l.venue.location}),e.jsxs("p",{className:"text-purple-600 font-semibold mt-2",children:["$",l.venue.price.toLocaleString()]})]})]}),(l.selectedProviders||[]).length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:s("booking.summary.services")}),e.jsx("div",{className:"space-y-3",children:(l.selectedProviders||[]).map((u,L)=>{var z;return e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-purple-600 uppercase",children:u.service.name}),e.jsx("p",{className:"font-medium text-gray-900 mt-1",children:u.provider.name}),((z=u.service)==null?void 0:z.category)!=="catering"&&e.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Qty: ",Number.isFinite(u.quantity)?Math.max(1,u.quantity):1]}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[s("booking.summary.rating"),":"]}),e.jsxs("span",{className:"text-sm font-medium",children:[u.provider.rating," *"]})]})]},L)})})]}),e.jsx("div",{className:"pt-6 border-t",children:E.guests&&parseInt(E.guests,10)>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[e.jsx("span",{className:"text-lg font-bold text-gray-900",children:s("booking.summary.total")}),e.jsxs("span",{className:"text-2xl font-bold text-purple-600",children:["$",v().toLocaleString()]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:s("booking.summary.totalNotice")}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:s("booking.summary.forGuests",{count:E.guests})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[e.jsx("span",{className:"text-lg font-bold text-gray-900",children:s("booking.summary.total")}),e.jsxs("span",{className:"text-2xl font-bold text-purple-600",children:["$",v().toLocaleString()]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:s("booking.summary.totalNotice")}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:s("booking.summary.enterGuests")})]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-gray-600",children:s("booking.summary.noData")}),e.jsx("button",{onClick:()=>t("/venues"),className:"mt-4 text-purple-600 hover:text-purple-700",children:s("booking.summary.browse")})]})]})})]})]})})}const js="http://localhost:4000",Ns=window.location.origin,ws="event_marketplace_service_request_status_v1";function ks(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(t||"").trim())}function on(){var ve;const{language:t}=me(),s=t==="de",n=qe(),{cart:l,total:r,removeService:c,clearCart:C,clearVenue:E}=lt(),[x,R]=o.useState(!1),[m,d]=o.useState(!1),[v,p]=o.useState(!1),[u,L]=o.useState(!1),[z,j]=o.useState(""),[N,f]=o.useState(""),[y,O]=o.useState({name:"",email:"",phone:"",address:"",city:"",postalCode:"",altContactName:"",altPhone:"",preferredContactMethod:"email",eventTime:"",eventType:"",guestCount:"",disputeNotes:"",termsAccepted:!1,notes:""}),[te,q]=o.useState([]),[W,M]=o.useState([]),[A,T]=o.useState(!1),[$,K]=o.useState("idle"),D=o.useMemo(()=>Pe(),[]),S=(D==null?void 0:D.role)==="customer"?(D.user.email||"").trim():"",F=o.useRef(!1),B=o.useRef(""),oe=(D==null?void 0:D.role)==="vendor"||(D==null?void 0:D.role)==="admin",le=l.services.reduce((w,P)=>w+P.price,0),we=((ve=l.venue)==null?void 0:ve.price)??0,ge=!!y.name.trim()&&ks(y.email)&&!!y.address.trim()&&!!y.city.trim()&&!!y.postalCode.trim()&&!!y.eventType.trim()&&Number(y.guestCount)>0&&!!y.termsAccepted,G=w=>{j(w),fe.error(w)},ne=()=>l.services.length>0?s?"Services warten auf Vendor-Freigabe.":"Services are awaiting vendor approval.":s?"Bitte waehle zuerst eine Location aus.":"Please select a venue before checkout.";o.useEffect(()=>{try{const w=localStorage.getItem(ws);if(!w)return;const P=JSON.parse(w);if(!Array.isArray(P))return;const Z=P.filter(Q=>Q&&typeof Q.id=="string").map(Q=>({id:String(Q.id),title:String(Q.title||""),category:Q.category?String(Q.category):void 0,price:Number(Q.price||0),sentAt:String(Q.sentAt||new Date().toISOString()),requestId:Q.requestId?String(Q.requestId):void 0,status:"request_sent"}));q(Z)}catch{}},[]),o.useEffect(()=>{try{localStorage.setItem(ws,JSON.stringify(te))}catch{}},[te]),o.useEffect(()=>{if(!D||D.role!=="customer")return;let w=!0;return(async()=>{try{const Z=await is();if(!w)return;const Q=Z.profile||{name:"",phone:"",address:""};O(ce=>({...ce,name:ce.name||Q.name||D.user.name||"",email:ce.email||D.user.email||"",phone:ce.phone||Q.phone||"",address:ce.address||Q.address||""})),B.current=JSON.stringify({name:(Q.name||D.user.name||"").trim(),phone:String(Q.phone||"").trim(),address:String(Q.address||"").trim()})}catch{if(!w)return;O(Z=>({...Z,name:Z.name||D.user.name||"",email:Z.email||D.user.email||""}))}finally{if(!w)return;F.current=!0}})(),S&&U(S),()=>{w=!1}},[S,D]),o.useEffect(()=>{if(!S||!F.current)return;const w={name:y.name.trim(),phone:y.phone.trim(),address:y.address.trim()};if(!w.name)return;const P=JSON.stringify(w);if(P===B.current)return;const Z=window.setTimeout(async()=>{K("saving");try{await it({name:w.name,phone:w.phone||void 0,address:w.address||void 0}),B.current=P,K("saved"),window.setTimeout(()=>K("idle"),1200)}catch{K("idle")}},700);return()=>window.clearTimeout(Z)},[y.address,y.name,y.phone,S]);async function U(w){if(w.trim()){T(!0);try{const P=await Ot(w.trim());M(Array.isArray(P.requests)?P.requests:[])}catch{}finally{T(!1)}}}function Y(w){if(A)return"Request sent - pending vendor approval";const P=w.requestId?W.find(ce=>ce.id===w.requestId):null;return P?P.status==="expired"?"Expired - no payment possible":P.status==="closed"?P.offers.find(ie=>ie.paymentStatus==="paid")?"Paid":"Closed":!Array.isArray(P.offers)||P.offers.length===0?"Pending vendor response":P.offers.find(ce=>ce.paymentStatus==="paid")?"Paid":P.offers.find(ce=>ce.status==="accepted")?"Approved - pay in Customer Portfolio":"Offer received - review in Customer Portfolio":"Request sent - pending vendor approval"}function ue(w){return w.requestId&&W.find(P=>P.id===w.requestId)||null}async function re(){if(j(""),f(""),oe){G("Please use a customer account for checkout.");return}if(!l.venue){G(ne());return}L(!0);let w;try{w=await fetch(`${js}/api/stripe/checkout`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cart:{venue:l.venue,services:[],currency:l.currency},customer:{...y,name:y.name.trim(),email:y.email.trim(),phone:y.phone.trim(),address:y.address.trim(),city:y.city.trim(),postalCode:y.postalCode.trim(),altContactName:y.altContactName.trim(),altPhone:y.altPhone.trim(),eventType:y.eventType.trim(),guestCount:y.guestCount.trim(),disputeNotes:y.disputeNotes.trim(),notes:y.notes.trim()},successUrl:`${Ns}/checkout/success`,cancelUrl:`${Ns}/cart`})})}catch(Z){const Q=Z instanceof Error?` ${Z.message}`:"";j(`Network error while starting checkout (${js}).${Q}`),L(!1);return}if(!w.ok){const Z=await w.json().catch(()=>({}));j(`Checkout error: ${(Z==null?void 0:Z.error)||w.statusText}`),L(!1);return}const P=await w.json();if(!(P!=null&&P.url)){j("Checkout URL missing. Please try again."),L(!1);return}window.location.href=P.url}async function he(){if(!S)return;const w={name:y.name.trim(),phone:y.phone.trim(),address:y.address.trim()};w.name&&(K("saving"),await it({name:w.name,phone:w.phone||void 0,address:w.address||void 0}),B.current=JSON.stringify(w),K("saved"))}async function pe(w){w.preventDefault(),j("");const P=Z=>G(Z);if(!l.venue){P(ne());return}if(!y.name.trim()||!y.email.trim()){P("Please enter name and email.");return}if(!ks(y.email)){P("Please enter a valid email address.");return}if(!y.address.trim()){P("Please enter billing address before checkout.");return}if(!y.city.trim()||!y.postalCode.trim()){P("Please enter city and postal code before checkout.");return}if(!y.eventType.trim()){P("Please select event type before checkout.");return}if(!y.guestCount.trim()||Number(y.guestCount)<=0){P("Please enter valid guest count before checkout.");return}if(!y.termsAccepted){P("Please accept the terms before checkout.");return}try{await he()}catch{P("Could not save customer profile. Please try again.");return}await re()}function Le(){if(oe){G("Please use a customer account for checkout.");return}if(!l.venue){G(ne());return}p(w=>!w)}async function ke(){var ce;if(j(""),f(""),!D||D.role!=="customer"||!D.user.email){j("Please login with a customer account first."),n("/login");return}if(l.services.length===0){j("Please add at least one service before sending a request.");return}if(!y.name.trim()||!y.email.trim()){j("Please enter client name and email first.");return}const w=Array.from(new Set(l.services.map(ie=>String(ie.category||"").trim()).filter(ie=>ie.length>0))),P=w.length>0?w:["other"],Z=l.services.map(ie=>`- ${ie.title} (EUR ${ie.price})`),Q=[`Client: ${y.name.trim()}`,`Client email: ${y.email.trim()}`,y.phone.trim()?`Client phone: ${y.phone.trim()}`:"",y.address.trim()?`Client address: ${y.address.trim()}`:"",l.venue?`Venue selected: ${l.venue.title} (EUR ${l.venue.price})`:"Venue selected: no",Z.length>0?"Selected services:":"No services selected.",...Z,`Services subtotal: EUR ${le}`,y.notes.trim()?`Client note: ${y.notes.trim()}`:""].join(`
`);R(!0);try{const ie=await os({customerName:y.name.trim(),customerEmail:D.user.email,customerPhone:y.phone.trim()||void 0,address:y.address.trim()||void 0,selectedServices:P,budget:Math.max(1,le),notes:Q}),Be=(ce=ie==null?void 0:ie.request)!=null&&ce.id?String(ie.request.id):void 0,Oe=new Date().toISOString(),Re=l.services.map(je=>({id:je.id,title:je.title,category:je.category,price:je.price,sentAt:Oe,requestId:Be,status:"request_sent"}));q(je=>{const xe=new Map(je.map(Ce=>[Ce.id,Ce]));return Re.forEach(Ce=>xe.set(Ce.id,Ce)),Array.from(xe.values()).sort((Ce,b)=>b.sentAt.localeCompare(Ce.sentAt))}),l.services.forEach(je=>c(je.id)),await U(D.user.email),f("Service request sent. Vendors must approve before payment is available.")}catch(ie){j(ie instanceof Error?ie.message:"Failed to send request to vendors.")}finally{R(!1)}}async function Te(w){if(!S.trim()){j("Please login with a customer account first.");return}j(""),f("");try{await Zs(w,S.trim()),await U(S.trim()),f("Request cancelled."),fe.success("Request cancelled.")}catch(P){const Z=P instanceof Error?P.message:"Failed to cancel request.";j(Z),fe.error(Z)}}function De(){j(""),f(""),d(!0),setTimeout(()=>{d(!1),f("Saved. You can continue later from Cart.")},200)}return e.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:e.jsxs("div",{className:"container mx-auto px-4 max-w-4xl",children:[e.jsxs("div",{className:"mb-8 flex items-center gap-3",children:[e.jsx(At,{className:"size-7 text-purple-700"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Your Cart"})]}),z&&e.jsx("div",{className:"mb-4 rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700",children:z}),N&&e.jsx("div",{className:"mb-4 rounded-lg border border-green-200 bg-green-50 px-3 py-2 text-sm text-green-700",children:N}),e.jsxs("section",{className:"rounded-xl border border-gray-200 bg-white p-5 shadow-sm",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Venue"}),l.venue?e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:l.venue.title}),e.jsx("p",{className:"text-sm text-gray-600",children:l.venue.location||"-"}),e.jsxs("p",{className:"text-sm font-medium text-purple-700 mt-1",children:["EUR ",l.venue.price.toLocaleString()]})]}),e.jsxs("button",{type:"button",onClick:E,className:"inline-flex items-center gap-1 rounded border border-red-200 px-3 py-2 text-sm text-red-600 hover:bg-red-50",children:[e.jsx(Pt,{className:"size-4"}),"Remove"]})]}):e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"No venue selected."}),e.jsx("button",{type:"button",onClick:()=>n("/venues"),className:"inline-flex items-center justify-center rounded-lg border border-purple-300 bg-white px-4 py-2.5 text-sm font-semibold text-purple-700 hover:bg-purple-50",children:"Browse venues"})]})]}),e.jsxs("section",{className:"mt-4 rounded-xl border border-gray-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Services"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Services are request-based. Payment is enabled only after vendor approval and agreement acceptance."})]}),l.services.length===0?e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"No services selected."}),e.jsx("button",{type:"button",onClick:()=>n("/services"),className:"inline-flex items-center justify-center rounded-lg border border-purple-300 bg-white px-4 py-2.5 text-sm font-semibold text-purple-700 hover:bg-purple-50",children:"Browse services"})]}):e.jsx("div",{className:"space-y-2",children:l.services.map(w=>e.jsxs("div",{className:"rounded-lg border border-gray-200 p-3 flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:w.title}),e.jsx("p",{className:"text-sm text-gray-600",children:w.category||"service"}),e.jsxs("p",{className:"text-sm font-medium text-purple-700",children:["EUR ",w.price.toLocaleString()]}),e.jsx("span",{className:"mt-1 inline-flex rounded-full bg-gray-100 px-2 py-0.5 text-xs font-medium text-gray-700",children:"Not sent"})]}),e.jsxs("button",{type:"button",onClick:()=>c(w.id),className:"inline-flex items-center gap-1 rounded border border-red-200 px-3 py-2 text-sm text-red-600 hover:bg-red-50",children:[e.jsx(Pt,{className:"size-4"}),"Remove"]})]},w.id))}),te.length>0&&e.jsxs("div",{className:"mt-4 rounded-lg border border-blue-100 bg-blue-50 p-3",children:[e.jsx("p",{className:"text-sm font-semibold text-blue-900",children:"Recently sent service requests"}),e.jsx("div",{className:"mt-2 space-y-2",children:te.map(w=>e.jsxs("div",{className:"rounded border border-blue-100 bg-white px-3 py-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:w.title}),e.jsx("span",{className:"inline-flex rounded-full bg-yellow-100 px-2 py-0.5 text-xs font-medium text-yellow-800",children:Y(w)})]}),e.jsxs("p",{className:"mt-1 text-xs text-gray-600",children:["EUR ",w.price.toLocaleString()," - sent ",new Date(w.sentAt).toLocaleString()]}),e.jsxs("div",{className:"mt-2",children:[e.jsx(V,{to:w.requestId?`/customer-portfolio?requestId=${encodeURIComponent(w.requestId)}`:"/customer-portfolio",className:"text-xs font-medium text-purple-700 hover:text-purple-900",children:"Open in Customer Portfolio"}),(()=>{const P=ue(w);return!P||P.status!=="open"||!w.requestId?null:e.jsx("button",{type:"button",onClick:()=>Te(w.requestId),className:"ml-3 text-xs font-medium text-red-600 hover:text-red-800",children:"Cancel request"})})()]})]},w.id))})]})]}),e.jsxs("div",{className:"mt-6 rounded-xl border border-purple-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:"Total"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-700",children:["EUR ",r.toLocaleString()]})]}),e.jsxs("div",{className:"mt-2 grid grid-cols-1 gap-1 text-sm text-gray-600",children:[e.jsxs("p",{children:["Venue payable now: EUR ",we.toLocaleString()]}),e.jsxs("p",{children:["Service requests subtotal: EUR ",le.toLocaleString()," (not payable yet)"]})]}),e.jsxs("div",{className:"mt-4 rounded-lg border border-gray-200 bg-gray-50 p-3",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:"Client details"}),e.jsx("p",{className:"mt-1 text-xs text-gray-600",children:"Used for service request + venue checkout."}),$!=="idle"&&e.jsxs("p",{className:`mt-1 text-xs ${$==="error"?"text-red-600":"text-gray-500"}`,children:[$==="saving"&&"Saving profile...",$==="saved"&&"Profile saved for future checkouts.",$==="error"&&"Could not auto-save profile. Please retry checkout."]}),e.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx("input",{type:"text",required:!0,placeholder:"Full name",value:y.name,onChange:w=>O(P=>({...P,name:w.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5",autoComplete:"name"}),e.jsx("input",{type:"email",required:!0,placeholder:"Email",value:y.email,onChange:w=>O(P=>({...P,email:w.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5",autoComplete:"email"}),e.jsx("input",{type:"tel",placeholder:"Phone (optional)",value:y.phone,onChange:w=>O(P=>({...P,phone:w.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5",autoComplete:"tel"}),e.jsx("input",{type:"text",required:!0,placeholder:"Address",value:y.address,onChange:w=>O(P=>({...P,address:w.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5",autoComplete:"street-address"}),e.jsx("input",{type:"text",required:!0,placeholder:"City",value:y.city,onChange:w=>O(P=>({...P,city:w.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5",autoComplete:"address-level2"}),e.jsx("input",{type:"text",required:!0,placeholder:"Postal code",value:y.postalCode,onChange:w=>O(P=>({...P,postalCode:w.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5",autoComplete:"postal-code"}),e.jsx("input",{type:"text",placeholder:"Alternative contact person",value:y.altContactName,onChange:w=>O(P=>({...P,altContactName:w.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5",autoComplete:"name"}),e.jsx("input",{type:"tel",placeholder:"Alternative phone",value:y.altPhone,onChange:w=>O(P=>({...P,altPhone:w.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5",autoComplete:"tel"}),e.jsxs("select",{value:y.preferredContactMethod,onChange:w=>O(P=>({...P,preferredContactMethod:w.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5",children:[e.jsx("option",{value:"email",children:"Preferred contact: Email"}),e.jsx("option",{value:"phone",children:"Preferred contact: Phone"}),e.jsx("option",{value:"whatsapp",children:"Preferred contact: WhatsApp"})]}),e.jsx("input",{type:"time",placeholder:"Event time",value:y.eventTime,onChange:w=>O(P=>({...P,eventTime:w.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5"}),e.jsxs("select",{required:!0,value:y.eventType,onChange:w=>O(P=>({...P,eventType:w.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5",children:[e.jsx("option",{value:"",children:"Event type"}),e.jsx("option",{value:"wedding",children:"Wedding"}),e.jsx("option",{value:"birthday",children:"Birthday"}),e.jsx("option",{value:"corporate",children:"Corporate"}),e.jsx("option",{value:"private-party",children:"Private party"}),e.jsx("option",{value:"other",children:"Other"})]}),e.jsx("input",{type:"number",min:1,required:!0,placeholder:"Guest count",value:y.guestCount,onChange:w=>O(P=>({...P,guestCount:w.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5"}),e.jsx("input",{type:"text",placeholder:"Short note (optional)",value:y.notes,onChange:w=>O(P=>({...P,notes:w.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5"}),e.jsx("textarea",{placeholder:"Additional dispute notes (optional)",value:y.disputeNotes,onChange:w=>O(P=>({...P,disputeNotes:w.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5 md:col-span-2 min-h-24"})]}),e.jsxs("label",{className:"mt-2 inline-flex items-start gap-2 text-xs text-gray-700",children:[e.jsx("input",{type:"checkbox",checked:y.termsAccepted,onChange:w=>O(P=>({...P,termsAccepted:w.target.checked})),className:"mt-0.5"}),e.jsx("span",{children:"I confirm these details are accurate and can be used for payment dispute handling."})]})]}),e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row gap-2",children:[e.jsx("button",{type:"button",onClick:C,className:"rounded-lg border border-gray-300 px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Clear cart"}),e.jsx("button",{type:"button",onClick:()=>n("/venues"),className:"rounded-lg border border-purple-300 px-4 py-2.5 text-sm font-medium text-purple-700 hover:bg-purple-50",children:"Continue shopping"}),e.jsx("button",{type:"button",onClick:De,disabled:!l.venue||m,className:"inline-flex items-center justify-center gap-2 rounded-lg border border-purple-300 px-4 py-2.5 text-sm font-semibold text-purple-700 hover:bg-purple-50 disabled:bg-gray-100 disabled:text-gray-400 disabled:border-gray-300",children:m?"Saving...":"Save for later"}),e.jsx("button",{type:"button",onClick:ke,disabled:le<=0||x||oe,className:"inline-flex items-center justify-center gap-2 rounded-lg border border-purple-300 px-4 py-2.5 text-sm font-semibold text-purple-700 hover:bg-purple-50 disabled:bg-gray-100 disabled:text-gray-400 disabled:border-gray-300",children:x?"Sending request...":oe?"Customers only":"Send service request"}),e.jsxs("button",{type:"button",onClick:Le,className:"sm:ml-auto inline-flex items-center justify-center gap-2 rounded-lg bg-purple-600 px-4 py-2.5 text-sm font-semibold text-white hover:bg-purple-700",children:[oe?"Customers only":"Pay venue now",e.jsx($e,{className:"size-4"})]})]}),v&&e.jsxs("form",{onSubmit:pe,className:"mt-4 rounded-lg border border-gray-200 p-4 space-y-3",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:"Venue checkout"}),e.jsx("p",{className:"text-sm text-gray-600",children:"This pays the venue only. Service requests stay pending until vendors approve."}),e.jsx("button",{type:"submit",disabled:u||!ge,className:"inline-flex items-center justify-center gap-2 rounded-lg bg-purple-600 px-4 py-2.5 text-sm font-semibold text-white hover:bg-purple-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:u?"Starting checkout...":"Pay now"}),!ge&&e.jsx("p",{className:"text-xs text-amber-700",children:"Fill required fields only: name, email, address, city, postal code, event type, guest count, and terms."})]})]})]})})}function ln(){const{clearCart:t}=lt();return o.useEffect(()=>{t()},[t]),e.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:e.jsx("div",{className:"container mx-auto px-4 max-w-xl",children:e.jsxs("div",{className:"rounded-2xl border border-green-200 bg-white p-8 text-center shadow-sm",children:[e.jsx(Br,{className:"size-16 text-green-600 mx-auto mb-4"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Payment successful"}),e.jsx("p",{className:"mt-3 text-gray-600",children:"Your booking payment has been received. We have sent your confirmation to your email."}),e.jsx("div",{className:"mt-6",children:e.jsx(V,{to:"/",className:"inline-flex items-center justify-center rounded-lg bg-purple-600 px-5 py-2.5 text-sm font-semibold text-white hover:bg-purple-700",children:"Back to home"})})]})})})}function cn({...t}){return e.jsx(Ir,{"data-slot":"dialog",...t})}function dn({...t}){return e.jsx(Vr,{"data-slot":"dialog-portal",...t})}function mn({className:t,...s}){return e.jsx($r,{"data-slot":"dialog-overlay",className:Ie("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...s})}function un({className:t,children:s,...n}){return e.jsxs(dn,{"data-slot":"dialog-portal",children:[e.jsx(mn,{}),e.jsxs(Or,{"data-slot":"dialog-content",className:Ie("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...n,children:[s,e.jsxs(Mr,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[e.jsx(Bs,{}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function gn({className:t,...s}){return e.jsx("div",{"data-slot":"dialog-header",className:Ie("flex flex-col gap-2 text-center sm:text-left",t),...s})}function pn({className:t,...s}){return e.jsx("div",{"data-slot":"dialog-footer",className:Ie("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...s})}function xn({className:t,...s}){return e.jsx(zr,{"data-slot":"dialog-title",className:Ie("text-lg leading-none font-semibold",t),...s})}function hn({className:t,...s}){return e.jsx(Fr,{"data-slot":"dialog-description",className:Ie("text-muted-foreground text-sm",t),...s})}const bn=[{id:"all",icon:Et,labelKey:"services.tabs.all"},{id:"dj",icon:Os,labelKey:"services.tabs.dj"},{id:"catering",icon:zs,labelKey:"services.tabs.catering"},{id:"makeup",icon:Et,labelKey:"services.tabs.makeup"},{id:"decorations",icon:Fs,labelKey:"services.tabs.decorations"},{id:"photography",icon:Ms,labelKey:"services.tabs.photography"}];function fn(){const{t}=me(),s=qe(),[n]=cr(),{cart:l,toggleService:r,removeService:c,hasService:C,total:E}=lt(),[x,R]=o.useState("all"),[m,d]=o.useState(""),[v,p]=o.useState(0),[u,L]=o.useState("highest-rated"),[z,j]=o.useState(!1),[N,f]=o.useState(null),[y,O]=o.useState(null),[te,q]=o.useState(""),[W,M]=o.useState(""),[A,T]=o.useState(""),[$,K]=o.useState(""),[D,S]=o.useState(""),[F,B]=o.useState(""),[oe,le]=o.useState(""),[we,ge]=o.useState(!1),[G,ne]=o.useState(""),[U,Y]=o.useState(!1),[ue,re]=o.useState([]),he=o.useRef(null),pe=Pe(),Le=(pe==null?void 0:pe.role)==="vendor",ke=(pe==null?void 0:pe.role)==="vendor"||(pe==null?void 0:pe.role)==="admin",Te=o.useMemo(()=>nt.flatMap(b=>b.providers.map(se=>({serviceId:b.id,serviceName:b.name,serviceCategory:b.category,providerId:se.id,providerName:se.name,providerRating:se.rating,providerReviews:se.reviewCount,providerPrice:se.price,specialties:se.specialties}))),[]),De=o.useMemo(()=>Math.max(...Te.map(b=>b.providerPrice),0),[Te]),ve=Math.max(De,1),[w,P]=o.useState(ve);o.useEffect(()=>{const b=String(n.get("category")||"").trim().toLowerCase();if(!b)return;["all","dj","catering","makeup","decorations","photography"].includes(b)&&R(b)},[n]),o.useEffect(()=>{Sa().then(b=>re(b.posts)).catch(()=>re([]))},[]),o.useEffect(()=>{P(b=>b<0||b>ve?ve:b)},[ve]);const Z=o.useMemo(()=>{let b=Te.filter(se=>{const h=x==="all"||se.serviceCategory===x,I=m.trim().toLowerCase(),ee=I.length===0||se.providerName.toLowerCase().includes(I)||se.serviceName.toLowerCase().includes(I)||se.specialties.some(Fe=>Fe.toLowerCase().includes(I)),de=se.providerRating>=v,Ne=se.providerPrice<=w;return h&&ee&&de&&Ne});return b=[...b].sort((se,h)=>u==="highest-rated"?h.providerRating-se.providerRating:u==="lowest-price"?se.providerPrice-h.providerPrice:h.providerPrice-se.providerPrice),b},[Te,x,m,v,w,u]),Q=b=>{f(b),O("details"),ge(!1)},ce=b=>{f(b),O("offer"),q(""),M(""),T(""),K(""),S(""),B(String(b.providerPrice)),le(""),ge(!1),ne("")},ie=()=>{f(null),O(null),ge(!1),ne(""),Y(!1)},Be=async b=>{b.preventDefault();const se=(N==null?void 0:N.serviceCategory)==="catering"||(N==null?void 0:N.serviceCategory)==="decorations";if(!te.trim()||!W.trim()||!A.trim()||!$||se&&(!D||Number(D)<=0)||!F||Number(F)<=0)return;const h=Pe();if(!h||h.role!=="customer"||!h.user.email){ne("Bitte zuerst als Kunde einloggen.");return}if(N){Y(!0),ne("");try{const I={customerName:h.user.name||te.trim(),customerEmail:h.user.email,customerPhone:A.trim()||void 0,selectedServices:[N.serviceCategory],budget:Number(F),eventDate:$||void 0,notes:`Provider: ${N.providerName} | Message: ${oe||"-"} | Guests: ${D||"-"}`};await os(I),ge(!0),setTimeout(()=>{s("/customer-portfolio")},900)}catch(I){ne(I instanceof Error?I.message:"Anfrage konnte nicht gesendet werden.")}finally{Y(!1)}}},Oe=b=>`${b.serviceId}:${b.providerId}`,Re=b=>{r({id:Oe(b),title:`${b.serviceName} - ${b.providerName}`,price:b.providerPrice,category:b.serviceCategory,serviceId:b.serviceId,providerId:b.providerId})},je=()=>{ke||l.services.length===0&&!l.venue||s("/cart")},xe=()=>{var b;(b=he.current)==null||b.scrollIntoView({behavior:"smooth",block:"start"})},Ce=b=>{Re(b),setTimeout(xe,50)};return e.jsxs("div",{className:"min-h-screen bg-gray-50 py-12",children:[e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("section",{className:"relative mb-20",children:[e.jsxs("div",{className:"rounded-2xl bg-gradient-to-br from-slate-900 via-slate-800 to-slate-700 text-white px-6 py-10 md:px-10 md:py-14",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-3",children:t("services.title")}),e.jsx("p",{className:"text-slate-200",children:t("services.subtitle")}),e.jsx("div",{className:"mt-8 flex flex-wrap items-center gap-3",children:bn.map(b=>{const se=b.icon,h=x===b.id;return e.jsxs("button",{type:"button",onClick:()=>R(b.id),className:`inline-flex items-center gap-2 rounded-full px-4 py-2 text-sm transition-colors ${h?"bg-white text-slate-900 shadow-md":"bg-white/10 text-white hover:bg-white/20 border border-white/20"}`,children:[e.jsx(se,{className:"size-4"}),t(b.labelKey)]},b.id)})})]}),e.jsx("div",{className:"absolute left-0 right-0 -bottom-12 px-3 md:px-8",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-4 md:p-5",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Us,{className:"absolute left-3 top-1/2 -translate-y-1/2 size-4 text-gray-400"}),e.jsx("input",{type:"text",value:m,onChange:b=>d(b.target.value),placeholder:t("services.search.placeholder"),className:"w-full rounded-lg border border-gray-300 pl-9 pr-3 py-2.5 focus:ring-2 focus:ring-purple-600 focus:border-transparent"})]}),e.jsxs("button",{type:"button",onClick:()=>j(b=>!b),className:"inline-flex items-center justify-center gap-2 rounded-lg bg-gray-100 px-4 py-2.5 text-gray-700",children:[e.jsx($s,{className:"size-4"}),t(z?"services.filter.hide":"services.filter.show")]})]}),z&&e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:t("services.filter.rating")}),e.jsxs("select",{value:String(v),onChange:b=>p(Number(b.target.value)),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5 focus:ring-2 focus:ring-purple-600 focus:border-transparent",children:[e.jsx("option",{value:"0",children:t("services.rating.all")}),e.jsxs("option",{value:"4",children:["4+ ",t("services.rating.stars")]}),e.jsxs("option",{value:"4.5",children:["4.5+ ",t("services.rating.stars")]}),e.jsxs("option",{value:"4.8",children:["4.8+ ",t("services.rating.stars")]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:t("services.filter.maxPrice",{price:w.toLocaleString()})}),e.jsx("input",{type:"range",min:0,max:ve,step:50,value:w,onChange:b=>P(Number(b.target.value)),onInput:b=>P(Number(b.target.value)),className:"w-full accent-purple-600"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:t("services.filter.sortBy")}),e.jsxs("select",{value:u,onChange:b=>L(b.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5 focus:ring-2 focus:ring-purple-600 focus:border-transparent",children:[e.jsx("option",{value:"highest-rated",children:t("services.sort.highestRated")}),e.jsx("option",{value:"lowest-price",children:t("services.sort.lowestPrice")}),e.jsx("option",{value:"highest-price",children:t("services.sort.highestPrice")})]})]})]})]})})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:t("services.results.showing",{count:Z.length})}),e.jsxs("section",{ref:he,className:"mb-6 rounded-xl border border-purple-200 bg-white shadow-sm",children:[e.jsxs("div",{className:"p-3 border-b border-gray-100 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(At,{className:"size-4 text-purple-700"}),e.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:["Services Cart (",l.services.length,")"]})]}),e.jsxs("p",{className:"text-sm font-bold text-purple-700",children:["EUR ",E.toLocaleString()]})]}),l.services.length===0?e.jsx("p",{className:"p-3 text-sm text-gray-600",children:"Add services from the list below."}):e.jsx("div",{className:"max-h-52 overflow-auto p-3 space-y-2",children:l.services.map(b=>e.jsxs("div",{className:"rounded-lg border border-gray-200 p-2.5",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:b.title}),e.jsx("p",{className:"text-xs text-gray-600",children:b.category}),e.jsxs("div",{className:"mt-2 flex items-center justify-between gap-2",children:[e.jsxs("p",{className:"text-sm text-gray-700",children:["EUR ",b.price.toLocaleString()]}),e.jsxs("button",{type:"button",onClick:()=>c(b.id),className:"inline-flex items-center gap-1 rounded border border-red-200 px-2 py-1 text-xs text-red-600 hover:bg-red-50",children:[e.jsx(Pt,{className:"size-3.5"}),"Remove"]})]})]},b.id))}),e.jsx("div",{className:"p-3 border-t border-gray-100",children:e.jsxs("button",{type:"button",onClick:je,disabled:l.services.length===0&&!l.venue||ke,className:"w-full inline-flex items-center justify-center gap-2 rounded-lg bg-purple-600 text-white py-2.5 text-sm font-semibold hover:bg-purple-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:[ke?"Customers only":"Go to cart",e.jsx($e,{className:"size-4"})]})})]}),e.jsx("div",{className:"mb-4 flex justify-end",children:e.jsx("button",{type:"button",onClick:xe,className:"rounded-lg border border-purple-300 bg-white px-3 py-2 text-sm font-medium text-purple-700 hover:bg-purple-50",children:"Go to cart"})}),Z.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:Z.map(b=>{const se=C(Oe(b));return e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-5",children:[e.jsx("p",{className:"text-xs uppercase font-semibold text-purple-600",children:b.serviceName}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mt-1",children:b.providerName}),e.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[b.providerRating," * (",b.providerReviews," ",t("venue.reviews"),")"]}),e.jsxs("p",{className:"mt-3 text-2xl font-bold text-gray-900",children:["$",b.providerPrice.toLocaleString(),b.serviceCategory==="catering"&&e.jsx("span",{className:"ml-1 text-xs font-medium text-gray-500",children:t("venue.perPerson")})]}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:b.specialties.slice(0,3).map(h=>e.jsx("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded-full",children:h},h))}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 sm:grid-cols-3 gap-2",children:[e.jsx("button",{type:"button",onClick:()=>Q(b),className:"rounded-lg border border-gray-300 text-gray-800 py-2.5 text-sm font-medium hover:bg-gray-50 transition-colors",children:t("services.card.detailsButton")}),e.jsx("button",{type:"button",onClick:()=>Re(b),disabled:ke,className:"rounded-lg bg-purple-600 text-white py-2.5 text-sm font-medium hover:bg-purple-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:ke?"Nur Ansicht (Vendor/Admin)":se?"Selected (click to remove)":"Add to cart"}),e.jsx("button",{type:"button",onClick:()=>Ce(b),disabled:ke,className:"rounded-lg border border-purple-300 text-purple-700 py-2.5 text-sm font-medium hover:bg-purple-50 transition-colors disabled:bg-gray-100 disabled:text-gray-400 disabled:border-gray-300",children:ke?"Customers only":"Complete booking"})]}),e.jsx("button",{type:"button",onClick:()=>ce(b),disabled:Le,className:"mt-2 w-full rounded-lg border border-purple-300 text-purple-700 py-2 text-sm font-medium hover:bg-purple-50 transition-colors disabled:bg-gray-100 disabled:text-gray-400",children:Le?"Offer disabled for vendor":t("services.card.offerButton")})]},`${b.serviceId}:${b.providerId}`)})}):e.jsx("div",{className:"rounded-xl bg-white border border-gray-200 p-12 text-center text-gray-600",children:t("services.results.empty")}),e.jsxs("section",{className:"mt-12",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Vendor Posts"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Aktive Posts aus dem Vendor Dashboard (approved + aktiviert)."}),ue.length===0?e.jsx("div",{className:"rounded-xl bg-white border border-gray-200 p-6 text-sm text-gray-600",children:"Noch keine aktiven Vendor Posts."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:ue.map(b=>e.jsxs("article",{className:"rounded-xl border border-gray-200 bg-white p-4",children:[e.jsx("p",{className:"text-xs uppercase font-semibold text-purple-600",children:b.serviceName}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mt-1",children:b.title}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["von ",b.vendorName]}),b.city&&e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:b.city}),b.description&&e.jsx("p",{className:"text-sm text-gray-700 mt-3 line-clamp-3",children:b.description}),e.jsx("p",{className:"mt-3 text-sm font-semibold text-gray-900",children:b.basePrice?`EUR ${b.basePrice.toLocaleString()}`:"Preis auf Anfrage"})]},b.id))})]})]}),e.jsx(cn,{open:!!N,onOpenChange:b=>!b&&ie(),children:e.jsx(un,{className:"sm:max-w-xl max-h-[85vh] overflow-y-auto",children:N&&e.jsxs(e.Fragment,{children:[e.jsxs(gn,{children:[e.jsx(xn,{children:t(y==="offer"?"services.dialog.offerTitle":"services.dialog.title")}),e.jsx(hn,{children:t("services.dialog.description",{provider:N.providerName,service:N.serviceName})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"rounded-lg border border-gray-200 p-3",children:[e.jsx("p",{className:"text-gray-500",children:t("services.dialog.basePrice")}),e.jsxs("p",{className:"font-semibold text-gray-900",children:["$",N.providerPrice.toLocaleString()]})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 p-3",children:[e.jsx("p",{className:"text-gray-500",children:t("services.dialog.rating")}),e.jsxs("p",{className:"font-semibold text-gray-900",children:[N.providerRating," * (",N.providerReviews," ",t("venue.reviews"),")"]})]})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 p-3",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-2",children:t("services.dialog.specialties")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:N.specialties.map(b=>e.jsx("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded-full",children:b},b))})]}),y==="offer"&&e.jsxs("form",{onSubmit:Be,className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:t("services.dialog.form.name")}),e.jsx("input",{type:"text",required:!0,value:te,onChange:b=>q(b.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5 focus:ring-2 focus:ring-purple-600 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:t("services.dialog.form.email")}),e.jsx("input",{type:"email",required:!0,value:W,onChange:b=>M(b.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5 focus:ring-2 focus:ring-purple-600 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:t("services.dialog.form.phone")}),e.jsx("input",{type:"tel",required:!0,value:A,onChange:b=>T(b.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5 focus:ring-2 focus:ring-purple-600 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:t("services.dialog.form.date")}),e.jsx("input",{type:"date",required:!0,value:$,onChange:b=>K(b.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5 focus:ring-2 focus:ring-purple-600 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[(N.serviceCategory==="catering"||N.serviceCategory==="decorations")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:t("services.dialog.form.guests")}),e.jsx("input",{type:"number",min:1,required:!0,value:D,onChange:b=>S(b.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5 focus:ring-2 focus:ring-purple-600 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:t("services.dialog.offerLabel")}),e.jsx("input",{type:"number",min:1,step:1,required:!0,value:F,onChange:b=>B(b.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5 focus:ring-2 focus:ring-purple-600 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:t("services.dialog.form.message")}),e.jsx("input",{type:"text",value:oe,onChange:b=>le(b.target.value),placeholder:t("services.dialog.form.messagePlaceholder"),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5 focus:ring-2 focus:ring-purple-600 focus:border-transparent"})]})]}),we&&e.jsx("div",{className:"rounded-lg border border-green-200 bg-green-50 px-3 py-2 text-sm text-green-700",children:t("services.dialog.offerSent")}),G&&e.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700",children:G}),e.jsx(pn,{className:"sticky bottom-0 bg-white pt-2",children:e.jsx("button",{type:"submit",disabled:U,className:"w-full sm:w-auto rounded-lg bg-purple-600 text-white px-4 py-2.5 text-sm font-medium hover:bg-purple-700 transition-colors",children:U?"Wird gesendet...":t("services.dialog.submitOffer")})})]})]})]})})})]})}function yn(){const t=o.useMemo(()=>Array.from(new Set(nt.map(j=>j.category))),[]),[s,n]=o.useState(t),[l,r]=o.useState(""),[c,C]=o.useState(!1),[E,x]=o.useState(!1),[R,m]=o.useState(!1),[d,v]=o.useState(""),[p,u]=o.useState({customerName:"",customerEmail:"",customerPhone:"",selectedServices:[],budget:"",offerResponseHours:"48",eventDate:"",address:"",notes:""});o.useEffect(()=>{ha().then(j=>{const N=Array.from(new Set(j.services.map(f=>f.category)));N.length>0&&n(N)}).catch(()=>{n(t)})},[t]),o.useEffect(()=>{const j=Pe();if(!j||j.role!=="customer"){x(!1);return}x(!0),C(!0),u(N=>({...N,customerName:N.customerName||j.user.name||"",customerEmail:N.customerEmail||j.user.email||""}))},[]),o.useEffect(()=>{const j=sessionStorage.getItem("serviceRequestDraft");if(j)try{const N=JSON.parse(j);u(f=>({...f,selectedServices:N.selectedServices&&N.selectedServices.length>0?Array.from(new Set(N.selectedServices)):f.selectedServices,budget:N.budget||f.budget,notes:N.notes||f.notes}))}catch{}finally{sessionStorage.removeItem("serviceRequestDraft")}},[]);const L=j=>{u(N=>({...N,selectedServices:N.selectedServices.includes(j)?N.selectedServices.filter(f=>f!==j):[...N.selectedServices,j]}))},z=async j=>{if(j.preventDefault(),!E){v("Bitte zuerst als Kunde mit Google einloggen, bevor du eine Anfrage sendest.");return}if(!(!p.customerName||!p.customerEmail||!p.budget||p.selectedServices.length===0)){m(!0),v("");try{const N=await os({customerName:p.customerName,customerEmail:p.customerEmail,customerPhone:p.customerPhone||void 0,selectedServices:p.selectedServices,budget:Number(p.budget),offerResponseHours:Number(p.offerResponseHours),eventDate:p.eventDate||void 0,address:p.address||void 0,notes:p.notes||void 0});r(N.request.id),u({customerName:"",customerEmail:"",customerPhone:"",selectedServices:[],budget:"",offerResponseHours:"48",eventDate:"",address:"",notes:""})}catch(N){v(N instanceof Error?N.message:"Fehler beim Senden der Anfrage.")}finally{m(!1)}}};return e.jsx("div",{className:"min-h-screen bg-gray-50 py-6 sm:py-12",children:e.jsx("div",{className:"container mx-auto px-4 max-w-3xl",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-5 sm:p-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-2",children:"Anfrage / Offer erstellen"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Waehle die gewuenschten Dienstleistungen und dein Budget. Vendor koennen sich danach auf deine Anfrage bewerben."}),!E&&e.jsxs("div",{className:"mb-4 rounded-lg border border-amber-200 bg-amber-50 px-3 py-2 text-sm text-amber-800",children:["Du musst eingeloggt sein, um eine Anfrage zu erstellen."," ",e.jsx(V,{to:"/login",className:"underline",children:"Zum Login"})]}),e.jsxs("form",{onSubmit:z,className:"space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Name"}),e.jsx("input",{type:"text",required:!0,value:p.customerName,onChange:j=>u(N=>({...N,customerName:j.target.value})),disabled:c,className:"w-full rounded-lg border border-gray-300 px-3 py-2.5 focus:ring-2 focus:ring-purple-600 focus:border-transparent disabled:bg-gray-100 disabled:text-gray-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"E-Mail"}),e.jsx("input",{type:"email",required:!0,value:p.customerEmail,onChange:j=>u(N=>({...N,customerEmail:j.target.value})),disabled:c,className:"w-full rounded-lg border border-gray-300 px-3 py-2.5 focus:ring-2 focus:ring-purple-600 focus:border-transparent disabled:bg-gray-100 disabled:text-gray-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Telefon (optional)"}),e.jsx("input",{type:"tel",value:p.customerPhone,onChange:j=>u(N=>({...N,customerPhone:j.target.value})),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5 focus:ring-2 focus:ring-purple-600 focus:border-transparent",placeholder:"+49 ..."})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-2",children:"Dienstleistungen"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(j=>{const N=p.selectedServices.includes(j);return e.jsx("button",{type:"button",onClick:()=>L(j),className:`px-3 py-1.5 rounded-full text-sm border ${N?"bg-purple-600 text-white border-purple-600":"bg-white text-gray-700 border-gray-300"}`,children:j},j)})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Budget (EUR)"}),e.jsx("input",{type:"number",min:1,required:!0,value:p.budget,onChange:j=>u(N=>({...N,budget:j.target.value})),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5 focus:ring-2 focus:ring-purple-600 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Event-Datum (optional)"}),e.jsx("input",{type:"date",value:p.eventDate,onChange:j=>u(N=>({...N,eventDate:j.target.value})),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5 focus:ring-2 focus:ring-purple-600 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Event-Adresse (optional)"}),e.jsx("input",{type:"text",value:p.address,onChange:j=>u(N=>({...N,address:j.target.value})),placeholder:"Strasse, Stadt, PLZ",className:"w-full rounded-lg border border-gray-300 px-3 py-2.5 focus:ring-2 focus:ring-purple-600 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Antwortfrist fuer Vendor"}),e.jsxs("select",{value:p.offerResponseHours,onChange:j=>u(N=>({...N,offerResponseHours:j.target.value})),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5 focus:ring-2 focus:ring-purple-600 focus:border-transparent",children:[e.jsx("option",{value:"24",children:"24 Stunden"}),e.jsx("option",{value:"48",children:"48 Stunden"}),e.jsx("option",{value:"72",children:"72 Stunden"}),e.jsx("option",{value:"120",children:"5 Tage"}),e.jsx("option",{value:"168",children:"7 Tage"})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Nach Ablauf der Frist wird die Anfrage automatisch als abgelaufen markiert."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Kurzbeschreibung"}),e.jsx("textarea",{rows:4,value:p.notes,onChange:j=>u(N=>({...N,notes:j.target.value})),placeholder:"Was genau brauchst du? Zeitfenster, Stil, besondere Anforderungen...",className:"w-full rounded-lg border border-gray-300 px-3 py-2.5 focus:ring-2 focus:ring-purple-600 focus:border-transparent"})]}),e.jsx("button",{type:"submit",disabled:R||!E,className:"w-full rounded-lg bg-purple-600 text-white py-3 font-medium hover:bg-purple-700 transition-colors",children:R?"Wird gesendet...":"Anfrage senden"})]}),d&&e.jsx("div",{className:"mt-5 rounded-lg border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700",children:d}),l&&e.jsxs("div",{className:"mt-5 rounded-lg border border-green-200 bg-green-50 px-4 py-3 text-sm text-green-700",children:["Anfrage gesendet (",l,"). Vendor koennen jetzt Angebote abgeben."]}),e.jsxs("div",{className:"mt-5 flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 text-sm",children:[e.jsx(V,{to:"/customer-portfolio",className:"text-purple-600 hover:text-purple-700",children:"Zu meinem Portfolio (Anfragen & Angebote)"}),e.jsx(V,{to:"/vendor-portfolio",className:"text-gray-700 hover:text-gray-900",children:"Vendor Portfolio (Demo)"})]})]})})})}const Qs={dj:["dj","music","sound","audio","band"],catering:["catering","food","chef","drinks","bar"],decor:["decor","deco","decoration","flower","styling"],media:["photo","video","camera","filming"],venue:["venue","location","hall","space"]};function er(t){return String(t||"").toLowerCase().replace(/[^a-z0-9\u00c0-\u024f]+/g," ").trim()}function vn(t,s,n){const l=er(t);if(!l)return!1;const r=l.split(/\s+/);for(const c of r)if(c.length>=3&&s.has(c))return!0;for(const[c,C]of Object.entries(Qs))if(n.has(c)&&C.some(E=>l.includes(E)))return!0;return!1}function Ss(t){const s=String(t||"").trim();if(!s)return"";const n=["client email","selected services subtotal","venue selected","subtotal: eur"],l=s.toLowerCase();return n.some(r=>l.includes(r))?"":s.length>280?`${s.slice(0,280)}...`:s}function Cs(t){const s=t instanceof Error?t.message:String(t||"");return/unauthorized|401/i.test(s)}const jn=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],Nn=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function tr(t){const s=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0");return`${s}-${n}-${l}`}function wn(t){const s=/^(\d{4})-(\d{2})-(\d{2})$/.exec(t);if(!s)return null;const[,n,l,r]=s,c=new Date(Number(n),Number(l)-1,Number(r));return Number.isNaN(c.getTime())?null:c}function As(t){if(!t||typeof t!="object")return{};const s=t,n={};return Object.entries(s).forEach(([l,r])=>{if(typeof r!="boolean")return;const c=wn(l);c&&(n[tr(c)]=r)}),n}function Es(t,s){return new Date(t.getFullYear(),t.getMonth()+s,1)}function kn(t){const s=new Date(t.getFullYear(),t.getMonth(),1),n=new Date(t.getFullYear(),t.getMonth()+1,0),l=(s.getDay()+6)%7,r=n.getDate(),c=Math.ceil((l+r)/7)*7,C=new Date(t.getFullYear(),t.getMonth(),1-l);return Array.from({length:c}).map((E,x)=>{const R=new Date(C.getFullYear(),C.getMonth(),C.getDate()+x);return{iso:tr(R),label:R.getDate(),inMonth:R.getMonth()===t.getMonth()}})}function Ps({value:t,onChange:s,title:n}){const[l,r]=o.useState(()=>new Date(new Date().getFullYear(),new Date().getMonth(),1)),c=o.useMemo(()=>kn(l),[l]),C=o.useMemo(()=>Object.keys(t).length,[t]),E=o.useMemo(()=>Object.values(t).filter(v=>v===!0).length,[t]),x=C-E,R=v=>{const p=t[v],u={...t,[v]:p!==!0};s(u)},m=v=>{const p={...t};c.forEach(u=>{u.inMonth&&(p[u.iso]=v)}),s(p)},d=()=>{const v={...t};c.forEach(p=>{p.inMonth&&delete v[p.iso]}),s(v)};return e.jsxs("div",{className:"rounded-lg border border-gray-200 p-3 mb-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 mb-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-800",children:n}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>r(v=>Es(v,-1)),className:"rounded border border-gray-300 px-2 py-1 text-xs hover:bg-gray-50",children:"Prev"}),e.jsxs("p",{className:"text-sm font-medium min-w-[120px] text-center",children:[Nn[l.getMonth()]," ",l.getFullYear()]}),e.jsx("button",{type:"button",onClick:()=>r(v=>Es(v,1)),className:"rounded border border-gray-300 px-2 py-1 text-xs hover:bg-gray-50",children:"Next"})]})]}),e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-1",children:jn.map(v=>e.jsx("div",{className:"text-[11px] font-semibold text-gray-500 text-center py-1",children:v},v))}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:c.map(v=>{const p=t[v.iso],u=p===!0?"bg-green-100 border-green-400 text-green-900":p===!1?"bg-red-100 border-red-400 text-red-900":"bg-white border-gray-200 text-gray-800";return e.jsx("button",{type:"button",onClick:()=>R(v.iso),className:`h-9 rounded border text-xs ${u} ${v.inMonth?"":"opacity-45"}`,title:`${v.iso}${p===!0?" available":p===!1?" blocked":""}`,children:v.label},v.iso)})}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-3 text-xs",children:[e.jsxs("span",{className:"inline-flex items-center gap-1 text-gray-700",children:[e.jsx("span",{className:"inline-block w-3 h-3 rounded-sm border border-green-400 bg-green-100"}),"Available: ",E]}),e.jsxs("span",{className:"inline-flex items-center gap-1 text-gray-700",children:[e.jsx("span",{className:"inline-block w-3 h-3 rounded-sm border border-red-400 bg-red-100"}),"Blocked: ",x]}),e.jsx("button",{type:"button",onClick:()=>s({}),className:"rounded border border-gray-300 px-2 py-0.5 hover:bg-gray-50",children:"Clear"}),e.jsx("button",{type:"button",onClick:()=>m(!0),className:"rounded border border-green-300 bg-green-50 px-2 py-0.5 text-green-800 hover:bg-green-100",children:"All month green"}),e.jsx("button",{type:"button",onClick:()=>m(!1),className:"rounded border border-red-300 bg-red-50 px-2 py-0.5 text-red-800 hover:bg-red-100",children:"All month red"}),e.jsx("button",{type:"button",onClick:d,className:"rounded border border-gray-300 px-2 py-0.5 hover:bg-gray-50",children:"Clear month"})]}),e.jsx("p",{className:"mt-2 text-[11px] text-gray-500",children:"Click a day once for green (available). Click again for red (blocked/booked)."})]})}function Ds(){var J,ae,X;const{language:t}=me(),s=t==="de",n={loginRequired:s?"Vendor Login erforderlich":"Vendor login required",loginPrompt:s?"Bitte melde dich als Vendor an, um dein Dashboard zu sehen.":"Please sign in as a vendor to view your dashboard.",toLogin:s?"Zum Login":"Go to login",signup:s?"Vendor registrieren":"Register as vendor",dashboard:"Vendor Dashboard",pendingInfo:s?"Bitte warten, bis Admin deine Bewerbung freigibt.":"Please wait until admin reviews your application.",rejectedInfo:s?"Deine Bewerbung wurde abgelehnt. Bitte Admin kontaktieren.":"Your application was rejected. Please contact admin.",statusApproved:s?"Du kannst jetzt Angebote senden und deine Services verwalten.":"You can now send offers and manage your services.",statusGated:s?"Veroeffentlichen/Antworten ist erst nach Vertrag + Training + Admin-Freigabe aktiv.":"Publishing/responding is enabled only after contract + training + admin approval.",account:s?"Mein Account":"My account",sendToAdmin:s?"Anfrage an Admin senden":"Send inquiry to admin",servicePosts:s?"Meine Service-Posts & Verfuegbarkeit":"My service posts and availability",openRequests:s?"Offene Kundenanfragen":"Open customer requests",myOffers:s?"Meine gesendeten Angebote":"My sent offers",requestFlowHint:s?"Flow: Sende ein Angebot. Der Kunde kann annehmen oder ablehnen. Nach Annahme ist Zahlung moeglich.":"Flow: Send an offer. Customer can accept or decline. After acceptance, payment is enabled.",loadingOpenRequests:s?"Offene Anfragen werden geladen...":"Loading open requests...",noOpenRequests:s?"Keine offenen Anfragen vorhanden.":"No open requests available.",customer:s?"Kunde":"Customer",phone:s?"Telefon":"Phone",deadline:s?"Frist bis":"Deadline",budgetLabel:"Budget",yourPrice:s?"Dein Preis (EUR)":"Your price (EUR)",optionalMessage:s?"Nachricht (optional)":"Message (optional)",sendOffer:s?"Angebot senden":"Send offer",declineRequest:s?"Anfrage ablehnen":"Decline request",declining:s?"Wird abgelehnt...":"Declining...",loadingOffers:s?"Deine Angebote werden geladen...":"Loading your offers...",noOffersYet:s?"Noch keine gesendeten Angebote gefunden.":"No sent offers yet.",requestStatus:s?"Anfrage-Status":"Request status",yourPriceLabel:s?"Dein Preis":"Your price",payment:s?"Zahlung":"Payment",customerCanPay:s?"Kunde hat angenommen: Zahlung ist jetzt moeglich.":"Customer accepted: payment is now enabled.",waitingCustomerDecision:s?"Warte auf Kundenentscheidung (annehmen/ablehnen).":"Waiting for customer decision (accept/decline).",matchedForYou:s?"Passend für dich":"Matched for you",otherRequested:s?"Weitere angefragte Services":"Other requested services",requestDetails:s?"Anfrage-Details":"Request details",note:s?"Hinweis":"Note",noSpecificMatch:s?"Passender Service erkannt":"Relevant service detected",replies:s?"Admin-Antworten":"Admin replies",noReplies:s?"Noch keine Antworten vom Admin.":"No admin replies yet.",editOffer:s?"Angebot bearbeiten":"Edit offer",save:s?"Speichern":"Save",cancel:s?"Abbrechen":"Cancel",saving:s?"Speichert...":"Saving..."},[l,r]=o.useState(""),[c,C]=o.useState(""),[E,x]=o.useState(""),[R,m]=o.useState(""),[d,v]=o.useState(null),[p,u]=o.useState({contactName:"",city:"",address:"",websiteUrl:"",portfolioUrl:"",businessIntro:"",profileImageUrl:"",profileGalleryUrls:[]}),[L,z]=o.useState(!1),[j,N]=o.useState(!1),[f,y]=o.useState(null),[O,te]=o.useState(null),[q,W]=o.useState([]),[M,A]=o.useState([]),[T,$]=o.useState([]),[K,D]=o.useState(!0),[S,F]=o.useState(!1),[B,oe]=o.useState(!1),[le,we]=o.useState(null),[ge,G]=o.useState(!1),[ne,U]=o.useState(""),[Y,ue]=o.useState(""),[re,he]=o.useState({}),[pe,Le]=o.useState({}),[ke,Te]=o.useState(""),[De,ve]=o.useState(""),[w,P]=o.useState(""),[Z,Q]=o.useState(""),[ce,ie]=o.useState(""),[Be,Oe]=o.useState(""),[Re,je]=o.useState(""),[xe,Ce]=o.useState([]),[b,se]=o.useState(!0),[h,I]=o.useState({title:"",serviceName:"",description:"",city:"",basePrice:""}),[ee,de]=o.useState({}),[Ne,Fe]=o.useState(null),[be,Ve]=o.useState({title:"",serviceName:"",description:"",city:"",basePrice:""}),[ct,_e]=o.useState({}),dt=qe(),mt=String(l||c||"V").trim().charAt(0).toUpperCase()||"V";o.useEffect(()=>{d&&u({contactName:d.contactName||"",city:d.city||"",address:d.address||"",websiteUrl:d.websiteUrl||"",portfolioUrl:d.portfolioUrl||"",businessIntro:d.businessIntro||"",profileImageUrl:d.profileImageUrl||"",profileGalleryUrls:Array.isArray(d.profileGalleryUrls)?d.profileGalleryUrls:[]})},[d]);const Ke=async i=>{if(!i.trim())return null;try{const g=await fs(i);return v(g.vendor),y(g.vendor.compliance||null),r(g.vendor.businessName||""),g.vendor}catch(g){return U(g instanceof Error?g.message:"Fehler beim Laden des Vendor-Profils."),null}},Me=async(i,g)=>{var Se;if(!i.trim()){U("Bitte Vendor-E-Mail eingeben.");return}C(i.trim()),g!=null&&g.trim()&&r(g.trim()),U(""),D(!0);const _=await Ke(i.trim());_&&(await Promise.all([Qe(i.trim()),st(i.trim())]),await rt(i.trim()),await ut(),(Se=_.compliance)!=null&&Se.canPublish&&await Promise.all([Ae(),Je(i.trim())])),D(!1)},st=async i=>{if(!i.trim()){y(null),te(null);return}try{const g=await Na(i.trim());y(g.compliance),v(_=>_&&{..._,compliance:g.compliance}),te(g.signature||null)}catch(g){if(Cs(g)){try{const _=await fs(i.trim());y(_.vendor.compliance||null)}catch{}U("Session expired. Please log in again to refresh protected actions.");return}U(g instanceof Error?g.message:"Fehler beim Laden des Compliance-Status.")}},Ae=async()=>{D(!0),U("");try{const i=await xa();W(i.requests)}catch(i){U(i instanceof Error?i.message:"Fehler beim Laden der offenen Anfragen.")}finally{D(!1)}},Qe=async i=>{if(!i.trim()){A([]);return}F(!0),U("");try{const g=await ya(i.trim());A(g.offers)}catch(g){U(g instanceof Error?g.message:"Fehler beim Laden deiner Angebote.")}finally{F(!1)}},Je=async i=>{if(!i.trim()){$([]);return}try{const g=await ka(i.trim());$(g.posts)}catch(g){U(g instanceof Error?g.message:"Fehler beim Laden deiner Posts.")}},rt=async i=>{if(!i.trim()){we(null);return}try{const g=await Za(i.trim());we(g)}catch(g){U(g instanceof Error?g.message:"Fehler beim Laden des Stripe-Status.")}},ut=async()=>{try{const i=await _a();Ce(i.inquiries||[])}catch{}};o.useEffect(()=>{const i=Pe();if(!i||i.role!=="vendor"||!i.user.email){D(!1);return}x(i.user.email),m(i.user.name||""),Me(i.user.email,i.user.name||"")},[]);const Mt=async i=>{if(!(f!=null&&f.canPublish)){U("Responding is blocked until admin approval, contract acceptance, and training completion.");return}const g=Number(re[i]||0);if(!(!l.trim()||g<=0||!c.trim())){U("");try{await ba(i,{vendorName:l.trim(),vendorEmail:c.trim(),price:g,message:pe[i]||""})}catch(_){U(_ instanceof Error?_.message:"Fehler beim Senden des Angebots.");return}he(_=>({..._,[i]:""})),Le(_=>({..._,[i]:""})),await Promise.all([Ae(),Qe(c)])}},Ge=i=>i==="accepted"?s?"Angenommen":"Accepted":i==="declined"?s?"Abgelehnt":"Declined":i==="ignored"?s?"Ignoriert":"Ignored":i==="pending"?s?"Ausstehend":"Pending":i,at=i=>i==="paid"?s?"Bezahlt":"Paid":i==="pending"?s?"Ausstehend":"Pending":i==="failed"?s?"Fehlgeschlagen":"Failed":s?"Unbezahlt":"Unpaid",We=o.useMemo(()=>{const i=new Set,g=new Set,_=Array.isArray(d==null?void 0:d.providedServices)?d.providedServices:[],Se=[l,(d==null?void 0:d.businessName)||"",..._,...(T||[]).map(Ee=>`${Ee.serviceName||""} ${Ee.title||""} ${Ee.description||""}`)].join(" ").trim(),ze=er(Se);for(const Ee of ze.split(/\s+/))Ee.length>=3&&i.add(Ee);for(const[Ee,Ue]of Object.entries(Qs))Ue.some(rr=>ze.includes(rr))&&g.add(Ee);return{keywords:i,categories:g}},[T,l,d==null?void 0:d.businessName,d==null?void 0:d.providedServices]),Ze=o.useMemo(()=>{const i=[...Array.isArray(d==null?void 0:d.providedServices)?d.providedServices:[],...T.map(g=>g.serviceName||"")];return Array.from(new Set(i.map(g=>String(g||"").trim()).filter(Boolean)))},[T,d==null?void 0:d.providedServices]),He=o.useMemo(()=>{const i={};for(const g of q){const _=Array.isArray(g.selectedServices)?g.selectedServices:[],Se=_.filter(ze=>vn(ze,We.keywords,We.categories));i[g.id]={matched:Se,others:_.filter(ze=>!Se.includes(ze))}}return i},[q,We.categories,We.keywords]),gt=o.useMemo(()=>!b||Ze.length===0?q:q.filter(i=>{var g;return(((g=He[i.id])==null?void 0:g.matched)||[]).length>0}),[q,He,b,Ze.length]),zt=async i=>{if(!(f!=null&&f.canPublish)){U("Publishing is blocked until admin approval, contract acceptance, and training completion.");return}if(c.trim()){Te(i),U("");try{await fa(i,{vendorName:l.trim()||void 0,message:pe[i]||void 0}),he(g=>({...g,[i]:""})),Le(g=>({...g,[i]:""})),await Promise.all([Ae(),Qe(c)])}catch(g){U(g instanceof Error?g.message:"Fehler beim Ablehnen der Anfrage.")}finally{Te("")}}},pt=i=>{ve(i.id),P(String(i.price||"")),Q(i.message||"")},xt=()=>{ve(""),P(""),Q("")},Ft=async i=>{const g=Number(w||0);if(!Number.isFinite(g)||g<=0){U(s?"Bitte gültigen Preis eingeben.":"Please enter a valid price.");return}ie(i),U("");try{await va(i,{price:g,message:Z||""}),xt(),await Promise.all([Qe(c),Ae()])}catch(_){U(_ instanceof Error?_.message:s?"Angebot konnte nicht aktualisiert werden.":"Failed to update offer.")}finally{ie("")}},Vt=async()=>{if(!(!c.trim()||!Be.trim()||!Re.trim())){U("");try{await Aa({vendorEmail:c.trim(),subject:Be.trim(),message:Re.trim()}),Oe(""),je(""),await ut()}catch(i){U(i instanceof Error?i.message:"Fehler beim Senden der Anfrage an Admin.")}}},ht=async()=>{if(c.trim()){z(!0),U("");try{const i=await ja({vendorEmail:c.trim(),contactName:p.contactName.trim(),city:p.city.trim(),address:p.address.trim(),websiteUrl:p.websiteUrl.trim(),portfolioUrl:p.portfolioUrl.trim(),businessIntro:p.businessIntro.trim(),profileImageUrl:p.profileImageUrl.trim(),profileGalleryUrls:p.profileGalleryUrls});v(i.vendor),r(i.vendor.businessName||l)}catch(i){U(i instanceof Error?i.message:"Failed to save vendor profile.")}finally{z(!1)}}},bt=async i=>{if(i){N(!0),U("");try{const g=await Qt(i);u(_=>({..._,profileImageUrl:g.publicUrl}))}catch(g){U(g instanceof Error?g.message:"Image upload failed.")}finally{N(!1)}}},ft=async i=>{const g=Array.from(i||[]);if(g.length!==0){N(!0),U("");try{const _=await Promise.all(g.map(async Se=>(await Qt(Se)).publicUrl));u(Se=>({...Se,profileGalleryUrls:Array.from(new Set([...Se.profileGalleryUrls||[],..._]))}))}catch(_){U(_ instanceof Error?_.message:"Gallery upload failed.")}finally{N(!1)}}},yt=i=>{u(g=>({...g,profileGalleryUrls:(g.profileGalleryUrls||[]).filter(_=>_!==i)}))},vt=async()=>{if(c.trim()){oe(!0),U("");try{const i=await Wa({vendorEmail:c.trim(),country:"DE"});window.location.href=i.onboardingUrl}catch(i){U(i instanceof Error?i.message:"Fehler beim Starten von Stripe Connect."),oe(!1)}}},jt=async()=>{if(!(f!=null&&f.canPublish)){U("Publishing is blocked until admin approval, contract acceptance, and training completion.");return}if(!(!c.trim()||!h.title.trim()||!h.serviceName.trim())){U(""),ue("");try{await Ca({vendorEmail:c.trim(),title:h.title.trim(),serviceName:h.serviceName.trim(),description:h.description.trim()||void 0,city:h.city.trim()||void 0,basePrice:h.basePrice?Number(h.basePrice):void 0,availability:ee}),I({title:"",serviceName:"",description:"",city:"",basePrice:""}),de({}),await Promise.all([Je(c),Ke(c)]),ue("Post erstellt. Er erscheint auf der Services-Seite, wenn dein Vendor-Konto approved ist und der Post aktiv bleibt.")}catch(i){U(i instanceof Error?i.message:"Fehler beim Erstellen des Posts.")}}},Nt=async i=>{if(!(f!=null&&f.canPublish)){U("Publishing is blocked until admin approval, contract acceptance, and training completion.");return}try{await ys(i.id,{vendorEmail:c,isActive:!i.isActive}),await Je(c)}catch(g){U(g instanceof Error?g.message:"Fehler beim Aktualisieren des Posts.")}},a=i=>{Fe(i.id),Ve({title:i.title||"",serviceName:i.serviceName||"",description:i.description||"",city:i.city||"",basePrice:i.basePrice?String(i.basePrice):""}),_e(As(i.availability||{}))},k=async i=>{if(!(f!=null&&f.canPublish)){U("Publishing is blocked until admin approval, contract acceptance, and training completion.");return}if(!be.title.trim()||!be.serviceName.trim()){U("Titel und Service sind Pflichtfelder.");return}try{await ys(i,{vendorEmail:c,title:be.title.trim(),serviceName:be.serviceName.trim(),description:be.description.trim(),city:be.city.trim(),basePrice:be.basePrice?Number(be.basePrice):void 0,availability:ct}),Fe(null),_e({}),U(""),await Je(c)}catch(g){U(g instanceof Error?g.message:"Fehler beim Speichern des Posts.")}};return!c&&!K?e.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:e.jsx("div",{className:"container mx-auto px-4 max-w-3xl",children:e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:n.loginRequired}),e.jsx("p",{className:"text-gray-600 mb-4",children:n.loginPrompt}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:()=>dt("/login"),className:"rounded-lg bg-purple-600 text-white px-4 py-2.5 hover:bg-purple-700",children:n.toLogin}),e.jsx(V,{to:"/signup",className:"rounded-lg border border-gray-300 px-4 py-2.5 hover:bg-gray-50",children:n.signup})]}),ne&&e.jsx("div",{className:"mt-3 rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700",children:ne})]})})}):d&&d.status!=="approved"?e.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:e.jsx("div",{className:"container mx-auto px-4 max-w-3xl",children:e.jsxs("div",{className:"bg-white rounded-xl border border-yellow-200 bg-yellow-50 p-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:n.dashboard}),e.jsxs("p",{className:"text-gray-800",children:[s?"Dein Konto ist aktuell ":"Your account status is ",e.jsx("strong",{children:(d==null?void 0:d.status)||"pending_review"}),". ",n.pendingInfo]}),e.jsxs("div",{className:"mt-4 rounded-lg border border-yellow-200 bg-white p-4 text-sm text-gray-700 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Business:"})," ",d.businessName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Kontakt:"})," ",d.contactName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"E-Mail:"})," ",d.email]}),d.city&&e.jsxs("p",{children:[e.jsx("strong",{children:"Stadt:"})," ",d.city]}),d.documentUrl&&e.jsxs("p",{children:[e.jsx("strong",{children:"Dokument:"})," ",e.jsx("a",{href:d.documentUrl,target:"_blank",rel:"noreferrer",className:"text-purple-600 hover:text-purple-700",children:"ansehen"})]})]}),d.status==="rejected"&&e.jsx("p",{className:"text-gray-700 mt-2",children:n.rejectedInfo})]})})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:e.jsxs("div",{className:"container mx-auto px-4 max-w-6xl space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:n.dashboard}),e.jsxs("div",{className:"mb-2 inline-flex items-center gap-2 rounded-lg border border-emerald-200 bg-emerald-50 px-3 py-2 text-sm text-emerald-800",children:[e.jsx("div",{className:"h-7 w-7 rounded-full bg-emerald-600 text-white flex items-center justify-center font-semibold",children:mt}),e.jsxs("div",{className:"leading-tight",children:[e.jsx("p",{className:"font-medium",children:l||c}),e.jsx("p",{className:"text-xs",children:c})]})]}),e.jsxs("p",{className:"text-gray-600",children:["Status: approved. ",n.statusApproved]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:n.statusGated}),ne&&e.jsx("div",{className:"mt-3 rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700",children:ne})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:s?"Aktivierungs-Checkliste":"Activation checklist"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsx("div",{className:`rounded-lg border px-3 py-2 ${f!=null&&f.adminApproved?"border-green-200 bg-green-50 text-green-700":"border-yellow-200 bg-yellow-50 text-yellow-800"}`,children:f!=null&&f.adminApproved?"Admin approved":"Admin approval pending"}),e.jsx("div",{className:`rounded-lg border px-3 py-2 ${f!=null&&f.contractAccepted?"border-green-200 bg-green-50 text-green-700":"border-yellow-200 bg-yellow-50 text-yellow-800"}`,children:f!=null&&f.contractAccepted?`Contract accepted (${f.contractVersion||"v1.0"})`:"Vendor contract not accepted"}),e.jsx("div",{className:`rounded-lg border px-3 py-2 ${(O==null?void 0:O.status)==="completed"?"border-green-200 bg-green-50 text-green-700":"border-gray-200 bg-gray-50 text-gray-700"}`,children:O?`E-sign status: ${O.status}${O.provider?` (${O.provider})`:""}`:"E-sign status: not started"}),e.jsx("div",{className:`rounded-lg border px-3 py-2 ${f!=null&&f.trainingCompleted?"border-green-200 bg-green-50 text-green-700":"border-yellow-200 bg-yellow-50 text-yellow-800"}`,children:f!=null&&f.trainingCompleted?"Training completed":"Training not completed"}),e.jsx("div",{className:`rounded-lg border px-3 py-2 ${f!=null&&f.canPublish?"border-green-200 bg-green-50 text-green-700":"border-gray-200 bg-gray-50 text-gray-700"}`,children:f!=null&&f.canPublish?"Vendor ACTIVE: publishing/responding unlocked":"Vendor not active yet"})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[e.jsx(V,{to:"/vendor-terms",className:"rounded-lg border border-gray-300 px-3 py-2 text-sm hover:bg-gray-50",children:"Open Vendor Agreement"}),e.jsx("button",{type:"button",disabled:!!(f!=null&&f.contractAccepted)||ge||!c,onClick:async()=>{if(c.trim()){G(!0),U("");try{const i=await wa({vendorEmail:c.trim(),contractVersion:"v1.0"});y(i.compliance),i.compliance.canPublish&&await Promise.all([Ae(),Je(c.trim())])}catch(i){if(Cs(i)){as(),dt("/login");return}U(i instanceof Error?i.message:"Failed to accept contract.")}finally{G(!1)}}},className:"rounded-lg bg-indigo-600 text-white px-3 py-2 text-sm hover:bg-indigo-700 disabled:opacity-60",children:f!=null&&f.contractAccepted?"Contract accepted":ge?"Saving...":"Accept contract"}),(O==null?void 0:O.signingUrl)&&e.jsx("a",{href:O.signingUrl,target:"_blank",rel:"noreferrer",className:"rounded-lg border border-gray-300 px-3 py-2 text-sm hover:bg-gray-50",children:"Open e-sign link"}),e.jsx("button",{type:"button",disabled:!0,onClick:()=>{},className:"rounded-lg bg-gray-900 text-white px-3 py-2 text-sm hover:bg-black disabled:opacity-60",title:"Training is confirmed by admin only",children:f!=null&&f.trainingCompleted?"Training confirmed by admin":"Waiting for admin training confirmation"}),e.jsx("button",{type:"button",onClick:async()=>{c.trim()&&await Promise.all([st(c),Ke(c),rt(c)])},className:"rounded-lg border border-gray-300 px-3 py-2 text-sm hover:bg-gray-50",children:"Refresh checklist"})]}),!(f!=null&&f.canPublish)&&e.jsx("p",{className:"mt-3 text-xs text-amber-700",children:"You cannot publish listings or respond to requests until checklist items are complete and payout setup is ready."})]}),d&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:n.account}),e.jsxs("div",{className:"mb-4 flex items-center gap-3",children:[p.profileImageUrl?e.jsx("img",{src:p.profileImageUrl,alt:"Vendor profile",className:"h-14 w-14 rounded-full object-cover border border-gray-200"}):e.jsx("div",{className:"h-14 w-14 rounded-full bg-emerald-600 text-white flex items-center justify-center font-semibold text-lg",children:mt}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"text-xs text-gray-600 block",children:["Profile image",e.jsx("input",{type:"file",accept:"image/*",onChange:i=>{var g;return bt(((g=i.target.files)==null?void 0:g[0])||null)},className:"mt-1 block text-xs"})]}),e.jsxs("label",{className:"text-xs text-gray-600 block",children:["Profile gallery images",e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:i=>ft(i.target.files),className:"mt-1 block text-xs"})]}),j&&e.jsx("p",{className:"text-xs text-gray-500",children:"Uploading image..."})]})]}),(p.profileGalleryUrls||[]).length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Profile photos"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:(p.profileGalleryUrls||[]).map(i=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:i,alt:"Vendor profile gallery",className:"h-20 w-20 rounded object-cover border border-gray-200"}),e.jsx("button",{type:"button",onClick:()=>yt(i),className:"absolute -top-2 -right-2 rounded-full bg-red-600 text-white text-[10px] px-1.5 py-0.5",title:"Remove image",children:"x"})]},i))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-gray-700",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",d.status]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Business:"})," ",d.businessName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Kontakt:"})," ",d.contactName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"E-Mail:"})," ",d.email]}),d.city&&e.jsxs("p",{children:[e.jsx("strong",{children:"Stadt:"})," ",d.city]}),d.address&&e.jsxs("p",{children:[e.jsx("strong",{children:"Address:"})," ",d.address]}),d.websiteUrl&&e.jsxs("p",{children:[e.jsx("strong",{children:"Website:"})," ",d.websiteUrl]}),d.portfolioUrl&&e.jsxs("p",{children:[e.jsx("strong",{children:"Portfolio URL:"})," ",d.portfolioUrl]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Stripe Connect:"})," ",d.stripeAccountId||"Nicht verbunden"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Payout readiness:"})," ",(J=d.payoutReadiness)!=null&&J.ready?"Ready":`Not ready${(ae=d.payoutReadiness)!=null&&ae.reason?` (${d.payoutReadiness.reason})`:""}`]}),le&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Stripe charges_enabled:"})," ",le.chargesEnabled?"Ja":"Nein"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Stripe payouts_enabled:"})," ",le.payoutsEnabled?"Ja":"Nein"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Stripe details_submitted:"})," ",le.detailsSubmitted?"Ja":"Nein"]})]})]}),e.jsxs("div",{className:"mt-4 rounded-lg border border-gray-200 p-4",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Services you provide"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Ze.length>0?Ze.map(i=>e.jsx("span",{className:"rounded-full border border-emerald-200 bg-emerald-50 px-3 py-1 text-xs text-emerald-800",children:i},i)):e.jsx("span",{className:"text-xs text-gray-500",children:"No services posted yet."})})]}),e.jsxs("div",{className:"mt-4 rounded-lg border border-gray-200 p-4 space-y-3",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:"Edit profile details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx("input",{type:"text",placeholder:"Contact person",value:p.contactName,onChange:i=>u(g=>({...g,contactName:i.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5"}),e.jsx("input",{type:"text",placeholder:"City",value:p.city,onChange:i=>u(g=>({...g,city:i.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5"}),e.jsx("input",{type:"text",placeholder:"Address",value:p.address,onChange:i=>u(g=>({...g,address:i.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5 md:col-span-2"}),e.jsx("input",{type:"url",placeholder:"Website URL",value:p.websiteUrl,onChange:i=>u(g=>({...g,websiteUrl:i.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5"}),e.jsx("input",{type:"url",placeholder:"Portfolio URL",value:p.portfolioUrl,onChange:i=>u(g=>({...g,portfolioUrl:i.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5"})]}),e.jsx("textarea",{rows:3,placeholder:"Business intro",value:p.businessIntro,onChange:i=>u(g=>({...g,businessIntro:i.target.value})),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{type:"button",onClick:ht,disabled:L,className:"rounded-lg bg-purple-600 text-white px-4 py-2.5 disabled:opacity-60",children:L?"Saving profile...":"Save profile details"})})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsx("button",{type:"button",onClick:vt,disabled:B,className:"rounded-lg bg-indigo-600 px-4 py-2 text-white hover:bg-indigo-700 disabled:opacity-60",children:B?"Stripe Link wird erstellt...":d.stripeAccountId?"Stripe Connect fortsetzen":"Stripe Connect starten"}),e.jsx("button",{type:"button",onClick:()=>rt(c),className:"rounded-lg border border-gray-300 px-4 py-2 text-gray-700 hover:bg-gray-50",children:"Stripe Status aktualisieren"})]}),!d.stripeAccountId&&e.jsx("div",{className:"mt-3 rounded-lg border border-amber-200 bg-amber-50 px-3 py-2 text-sm text-amber-800",children:"Keine Stripe Connect ID hinterlegt. Zahlungen gehen an die Plattform, Vendor-Auszahlung braucht `acct_...`."}),(X=le==null?void 0:le.pendingRequirements)!=null&&X.length?e.jsxs("div",{className:"mt-2 rounded-lg border border-orange-200 bg-orange-50 px-3 py-2 text-xs text-orange-800",children:["Fehlende Stripe Angaben: ",le.pendingRequirements.join(", ")]}):null]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:n.sendToAdmin}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx("input",{type:"text",placeholder:"Betreff",value:Be,onChange:i=>Oe(i.target.value),className:"rounded-lg border border-gray-300 px-3 py-2.5"}),e.jsx("textarea",{rows:3,placeholder:"Deine Nachricht an Admin",value:Re,onChange:i=>je(i.target.value),className:"rounded-lg border border-gray-300 px-3 py-2.5"}),e.jsx("button",{type:"button",onClick:Vt,className:"rounded-lg bg-gray-900 text-white px-4 py-2.5 w-fit",children:"Anfrage senden"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:n.replies}),xe.length===0&&e.jsx("p",{className:"text-sm text-gray-600",children:n.noReplies}),e.jsx("div",{className:"space-y-3",children:xe.map(i=>e.jsxs("div",{className:"rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("p",{className:"font-medium text-gray-900",children:i.subject}),e.jsx("span",{className:"rounded-full bg-gray-100 px-2 py-1 text-xs text-gray-700",children:i.status})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(i.createdAt).toLocaleString()}),e.jsx("p",{className:"text-sm text-gray-700 mt-2 whitespace-pre-wrap",children:i.message}),i.adminReply&&e.jsxs("div",{className:"mt-3 rounded-lg border border-indigo-200 bg-indigo-50 p-3",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-indigo-700",children:s?"Admin Antwort":"Admin reply"}),e.jsx("p",{className:"text-sm text-indigo-900 whitespace-pre-wrap mt-1",children:i.adminReply}),(i.adminReplyAttachments||[]).length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:(i.adminReplyAttachments||[]).map((g,_)=>e.jsx("a",{href:g,target:"_blank",rel:"noreferrer",className:"rounded border border-indigo-300 bg-white px-2 py-1 text-xs text-indigo-700 hover:bg-indigo-100 break-all",children:s?"Datei oeffnen":"Open file"},`${i.id}-attachment-${_}`))})]})]},i.id))})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:n.servicePosts}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:[e.jsx("input",{type:"text",placeholder:"Titel",value:h.title,onChange:i=>I(g=>({...g,title:i.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5"}),e.jsx("input",{type:"text",placeholder:"Service (z. B. DJ)",value:h.serviceName,onChange:i=>I(g=>({...g,serviceName:i.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5"}),e.jsx("input",{type:"text",placeholder:"Stadt",value:h.city,onChange:i=>I(g=>({...g,city:i.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5"}),e.jsx("input",{type:"number",placeholder:"Basispreis (EUR)",value:h.basePrice,onChange:i=>I(g=>({...g,basePrice:i.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5"})]}),e.jsx(Ps,{value:ee,onChange:de,title:"Availability calendar"}),e.jsx("textarea",{rows:2,placeholder:"Beschreibung",value:h.description,onChange:i=>I(g=>({...g,description:i.target.value})),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5 mb-3"}),e.jsx("button",{type:"button",onClick:jt,className:"rounded-lg bg-purple-600 text-white px-4 py-2.5",children:"Post erstellen"}),Y&&e.jsx("div",{className:"mt-3 rounded-lg border border-green-200 bg-green-50 px-3 py-2 text-sm text-green-700",children:Y}),e.jsxs("div",{className:"mt-4 space-y-3",children:[T.length===0&&e.jsx("div",{className:"text-sm text-gray-600",children:"Noch keine Posts vorhanden."}),T.map(i=>e.jsx("div",{className:"rounded-lg border border-gray-200 p-4",children:Ne===i.id?e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"text",value:be.title,onChange:g=>Ve(_=>({..._,title:g.target.value})),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5",placeholder:"Titel"}),e.jsx("input",{type:"text",value:be.serviceName,onChange:g=>Ve(_=>({..._,serviceName:g.target.value})),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5",placeholder:"Service"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx("input",{type:"text",value:be.city,onChange:g=>Ve(_=>({..._,city:g.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5",placeholder:"Stadt"}),e.jsx("input",{type:"number",value:be.basePrice,onChange:g=>Ve(_=>({..._,basePrice:g.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5",placeholder:"Basispreis (EUR)"})]}),e.jsx("textarea",{rows:2,value:be.description,onChange:g=>Ve(_=>({..._,description:g.target.value})),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5",placeholder:"Beschreibung"}),e.jsx(Ps,{value:ct,onChange:_e,title:"Availability calendar"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>k(i.id),className:"rounded-lg bg-purple-600 text-white px-3 py-1.5 text-sm",children:"Speichern"}),e.jsx("button",{type:"button",onClick:()=>{Fe(null),_e({})},className:"rounded-lg bg-gray-200 px-3 py-1.5 text-sm",children:"Abbrechen"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("p",{className:"font-medium",children:i.title}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>a(i),className:"rounded-lg bg-purple-100 text-purple-700 px-3 py-1.5 text-sm",children:"Bearbeiten"}),e.jsx("button",{type:"button",onClick:()=>Nt(i),className:"rounded-lg bg-gray-200 px-3 py-1.5 text-sm",children:i.isActive?"Deaktivieren":"Aktivieren"})]})]}),e.jsxs("p",{className:"text-sm text-gray-700",children:[i.serviceName," | ",i.city||"-"," | EUR ",i.basePrice||0]}),i.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:i.description}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Availability days: ",Object.keys(As(i.availability||{})).length]})]})},i.id))]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:n.openRequests}),e.jsx("p",{className:"text-sm text-gray-600",children:n.requestFlowHint}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>se(i=>!i),className:"rounded-lg border border-gray-300 px-3 py-1.5 text-xs hover:bg-gray-50",children:b?"Showing matched only":"Showing all open requests"}),e.jsx("p",{className:"text-xs text-gray-500",children:b?"Requests are filtered to your posted/provided services.":"All open requests are visible."})]}),K&&e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-8 text-center text-gray-600",children:n.loadingOpenRequests}),!K&&gt.length===0&&e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-8 text-center text-gray-600",children:Ze.length>0?"No requests matched to your posted services yet.":n.noOpenRequests}),gt.map(i=>{var g,_,Se,ze;return e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:i.id}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:n.requestDetails})]}),e.jsxs("span",{className:"rounded-full bg-purple-50 px-3 py-1 text-sm font-medium text-purple-700",children:[n.budgetLabel,": EUR ",i.budget.toLocaleString()]})]}),e.jsxs("p",{className:"text-sm text-gray-700 mt-2",children:[n.customer,": ",i.customerName," (",i.customerEmail,")"]}),i.customerPhone&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[n.phone,": ",i.customerPhone]}),e.jsxs("p",{className:"text-sm text-orange-700 mt-1 font-medium",children:[n.deadline,": ",new Date(i.expiresAt).toLocaleString()]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-green-700",children:n.matchedForYou}),(((g=He[i.id])==null?void 0:g.matched)||[]).length>0?e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:(((_=He[i.id])==null?void 0:_.matched)||[]).map((Ee,Ue)=>e.jsx("span",{className:"rounded-full border border-green-200 bg-green-50 px-3 py-1 text-sm font-medium text-green-700",children:Ee},`${i.id}-match-${Ue}`))}):e.jsx("p",{className:"mt-2 text-sm text-green-700",children:n.noSpecificMatch})]}),(((Se=He[i.id])==null?void 0:Se.others)||[]).length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-gray-500",children:n.otherRequested}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:(((ze=He[i.id])==null?void 0:ze.others)||[]).map((Ee,Ue)=>e.jsx("span",{className:"rounded-full border border-gray-200 bg-gray-50 px-3 py-1 text-sm text-gray-600",children:Ee},`${i.id}-other-${Ue}`))})]}),Ss(i.notes||"")&&e.jsxs("div",{className:"mt-3 rounded-lg border border-gray-200 bg-gray-50 p-3",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 mb-1",children:n.note}),e.jsx("p",{className:"text-sm text-gray-700",children:Ss(i.notes||"")})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsx("input",{type:"number",min:1,placeholder:n.yourPrice,value:re[i.id]||"",onChange:Ee=>he(Ue=>({...Ue,[i.id]:Ee.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5"}),e.jsx("input",{type:"text",placeholder:n.optionalMessage,value:pe[i.id]||"",onChange:Ee=>Le(Ue=>({...Ue,[i.id]:Ee.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2.5 md:col-span-2"})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>Mt(i.id),className:"rounded-lg bg-purple-600 text-white px-4 py-2.5 hover:bg-purple-700",children:n.sendOffer}),e.jsx("button",{type:"button",onClick:()=>zt(i.id),disabled:ke===i.id,className:"rounded-lg border border-red-300 bg-red-50 text-red-700 px-4 py-2.5 hover:bg-red-100 disabled:opacity-60",children:ke===i.id?n.declining:n.declineRequest})]})]},i.id)})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:n.myOffers}),S&&e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-6 text-center text-gray-600",children:n.loadingOffers}),!S&&M.length===0&&e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-6 text-center text-gray-600",children:n.noOffersYet}),M.map(i=>e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[e.jsx("p",{className:"font-medium text-gray-900",children:i.request.id}),e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-gray-100 text-gray-700",children:Ge(i.status)})]}),De===i.id?e.jsxs("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsx("input",{type:"number",min:1,value:w,onChange:g=>P(g.target.value),className:"rounded-lg border border-gray-300 px-3 py-2.5",placeholder:n.yourPrice}),e.jsx("input",{type:"text",value:Z,onChange:g=>Q(g.target.value),className:"rounded-lg border border-gray-300 px-3 py-2.5 md:col-span-2",placeholder:n.optionalMessage})]}):e.jsxs("p",{className:"text-sm text-gray-700 mt-2",children:[n.requestStatus,": ",i.request.status," | ",n.yourPriceLabel,": EUR ",i.price.toLocaleString()]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[n.payment,": ",at(i.paymentStatus)]}),i.status==="accepted"?e.jsx("p",{className:"mt-2 text-xs text-green-700",children:n.customerCanPay}):e.jsx("p",{className:"mt-2 text-xs text-gray-600",children:n.waitingCustomerDecision}),i.status==="pending"&&i.paymentStatus!=="paid"&&e.jsx("div",{className:"mt-3 flex items-center gap-2",children:De===i.id?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:()=>Ft(i.id),disabled:ce===i.id,className:"rounded-lg bg-purple-600 text-white px-3 py-2 text-sm hover:bg-purple-700 disabled:opacity-60",children:ce===i.id?n.saving:n.save}),e.jsx("button",{type:"button",onClick:xt,className:"rounded-lg border border-gray-300 px-3 py-2 text-sm hover:bg-gray-50",children:n.cancel})]}):e.jsx("button",{type:"button",onClick:()=>pt(i),className:"rounded-lg border border-purple-300 text-purple-700 px-3 py-2 text-sm hover:bg-purple-50",children:n.editOffer})})]},i.id))]})]})})}const Sn=12e3;function Jt(){const t=es(),s=new URLSearchParams(t.search).get("requestId")||"",{language:n}=me(),l=n==="de",r={title:l?"Kundenkonto":"Customer Portfolio",subtitle:l?"Anfragen verwalten und Vendor-Angebote akzeptieren oder ignorieren.":"Manage requests and accept or ignore vendor offers.",signedInAs:l?"Eingeloggt als":"Signed in as",offerContact:l?"Kontakt fuer Angebote":"Offer contact",emailPlaceholder:l?"Deine E-Mail fuer den Portfolio-Zugriff":"Your email for portfolio access",load:l?"Portfolio laden":"Load portfolio",refresh:l?"Aktualisieren":"Refresh",profileTitle:l?"Kundendetails":"Customer details",profileSave:l?"Details speichern":"Save details",profileSaved:l?"Details gespeichert.":"Details saved.",fullName:l?"Vollstaendiger Name":"Full name",phone:l?"Telefon":"Phone",addressLine:l?"Adresse":"Address",invoices:l?"Rechnungen anzeigen":"View invoices",loading:l?"Lade Anfragen...":"Loading requests...",empty:l?"Keine Anfragen fuer diese E-Mail gefunden.":"No requests found for this email.",services:"Services",budget:"Budget",contactEmail:l?"Kontakt E-Mail":"Contact email",contactPhone:l?"Kontakt Telefon":"Contact phone",eventDate:l?"Event-Datum":"Event date",address:l?"Adresse":"Address",details:"Details",deadline:l?"Frist bis":"Deadline",noOffers:l?"Noch keine Vendor-Angebote.":"No vendor offers yet.",paymentLocked:l?"Service-Zahlung ist gesperrt, bis ein Vendor dein Service-Request freigibt.":"Service payment is locked until a vendor approves your service request.",price:l?"Preis":"Price",payment:l?"Zahlung":"Payment",accept:l?"Akzeptieren":"Accept",ignore:l?"Ignorieren":"Ignore",decline:l?"Ablehnen":"Decline",cancelRequest:l?"Anfrage stornieren":"Cancel request",stripeNote:l?"Zahlung ueber Stripe. Vendor-Auszahlung erfolgt automatisch, wenn Vendor Stripe Connect verknuepft hat.":"Payment via Stripe. Vendor payout runs automatically when Stripe Connect is linked.",pay:l?"Mit Stripe bezahlen":"Pay with Stripe",paid:l?"Zahlung erfolgreich abgeschlossen.":"Payment completed successfully."},[c,C]=o.useState(""),[E,x]=o.useState(""),[R,m]=o.useState(!1),[d,v]=o.useState([]),[p,u]=o.useState(!1),[L,z]=o.useState(""),[j,N]=o.useState(!1),[f,y]=o.useState(""),[O,te]=o.useState({name:"",phone:"",address:""}),q=String(E||c||"C").trim().charAt(0).toUpperCase()||"C";async function W(S,F){let B;const oe=new Promise((le,we)=>{B=window.setTimeout(()=>we(new Error(F)),Sn)});try{return await Promise.race([S,oe])}finally{typeof B=="number"&&window.clearTimeout(B)}}o.useEffect(()=>{const S=Pe();S&&S.role==="customer"&&S.user.email&&(m(!0),x(S.user.name||""),C(S.user.email),te(F=>({...F,name:S.user.name||""})),M(S.user.email),A())},[]);const M=async S=>{if(!S.trim()){v([]);return}u(!0),z("");try{const F=await W(Ot(S.trim()),"API response timeout while loading requests. Please try again.");v(F.requests)}catch(F){z(F instanceof Error?F.message:"Fehler beim Laden der Anfragen.")}finally{u(!1)}},A=async()=>{try{const S=await W(is(),"API response timeout while loading customer details. Please refresh.");te({name:S.profile.name||"",phone:S.profile.phone||"",address:S.profile.address||""})}catch{}},T=async()=>{if(!O.name.trim()){z("Name is required.");return}N(!0),z(""),y("");try{const S=await W(it({name:O.name.trim(),phone:O.phone.trim(),address:O.address.trim()}),"API response timeout while saving details. Please try again.");te({name:S.profile.name||"",phone:S.profile.phone||"",address:S.profile.address||""}),y(r.profileSaved)}catch(S){z(S instanceof Error?S.message:"Failed to save customer details.")}finally{N(!1)}},$=async(S,F,B)=>{z("");try{await W(Ys(S,F,B,{customerEmail:c}),"API response timeout while updating offer. Please retry."),await M(c)}catch(oe){z(oe instanceof Error?oe.message:"Fehler beim Aktualisieren des Angebots.")}},K=async S=>{if(c.trim()){z("");try{await W(Zs(S,c.trim()),"API response timeout while cancelling request. Please retry."),await M(c)}catch(F){z(F instanceof Error?F.message:"Failed to cancel request.")}}},D=async(S,F)=>{if(c.trim()){z("");try{const B=await W(Ja({requestId:S,offerId:F,customerEmail:c.trim(),successUrl:`${window.location.origin}/customer-portfolio?payment=success`,cancelUrl:`${window.location.origin}/customer-portfolio?payment=cancelled`}),"API response timeout while starting payment. Please retry.");B.url?window.location.href=B.url:z("Stripe Checkout URL konnte nicht erstellt werden.")}catch(B){z(B instanceof Error?B.message:"Fehler beim Starten von Stripe Checkout.")}}};return e.jsx("div",{className:"min-h-screen bg-gray-50 py-6 sm:py-12",children:e.jsxs("div",{className:"container mx-auto px-4 max-w-6xl",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6 sm:p-8 mb-6",children:[e.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-2",children:r.title}),e.jsx("p",{className:"text-base text-gray-600 mb-5",children:r.subtitle}),R&&e.jsx("div",{className:"mb-4 rounded-lg border border-green-200 bg-green-50 px-4 py-3 text-sm text-green-800",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-green-600 text-white flex items-center justify-center font-semibold",children:q}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:r.signedInAs}),e.jsx("p",{className:"text-xs text-green-700",children:c})]})]})}),c&&e.jsxs("div",{className:"mb-4 rounded-lg border border-gray-200 bg-gray-50 px-4 py-3 text-sm text-gray-700",children:[r.offerContact,": ",e.jsx("strong",{children:c})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[1fr_auto_auto] gap-3 md:items-center",children:[e.jsx("input",{type:"email",placeholder:r.emailPlaceholder,value:c,onChange:S=>{const F=S.target.value;C(F),F.trim()||v([])},disabled:R,className:"w-full rounded-lg border border-gray-300 px-4 py-3 text-base disabled:bg-gray-100 disabled:text-gray-500"}),e.jsx("button",{type:"button",onClick:()=>M(c),disabled:p||!c.trim(),className:"rounded-lg bg-purple-600 text-white px-5 py-3 text-base font-semibold hover:bg-purple-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:r.load}),e.jsx("button",{type:"button",onClick:()=>M(c),disabled:p||!c.trim(),className:"rounded-lg border border-gray-300 bg-white text-gray-800 px-5 py-3 text-base font-semibold hover:bg-gray-50 disabled:bg-gray-100 disabled:text-gray-400 disabled:cursor-not-allowed",children:r.refresh})]}),e.jsx("div",{className:"mt-4",children:e.jsx(V,{to:"/invoices",className:"text-sm text-purple-600 hover:text-purple-700",children:r.invoices})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6 sm:p-8 mb-6",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 mb-4",children:r.profileTitle}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx("input",{type:"text",placeholder:r.fullName,value:O.name,onChange:S=>te(F=>({...F,name:S.target.value})),className:"rounded-lg border border-gray-300 px-4 py-3 text-base"}),e.jsx("input",{type:"text",value:c,readOnly:!0,className:"rounded-lg border border-gray-200 bg-gray-100 px-4 py-3 text-base text-gray-600"}),e.jsx("input",{type:"tel",placeholder:r.phone,value:O.phone,onChange:S=>te(F=>({...F,phone:S.target.value})),className:"rounded-lg border border-gray-300 px-4 py-3 text-base"}),e.jsx("input",{type:"text",placeholder:r.addressLine,value:O.address,onChange:S=>te(F=>({...F,address:S.target.value})),className:"rounded-lg border border-gray-300 px-4 py-3 text-base"})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:T,disabled:j,className:"rounded-lg bg-purple-600 text-white px-5 py-3 text-base font-semibold hover:bg-purple-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:j?"Saving...":r.profileSave}),f&&e.jsx("p",{className:"text-sm text-green-700",children:f})]})]}),L&&e.jsx("div",{className:"bg-red-50 rounded-xl border border-red-200 p-4 text-sm text-red-700 mb-5",children:L}),p&&e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-8 text-center text-gray-600",children:r.loading}),!p&&c.trim()&&d.length===0&&e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-8 text-center text-gray-600",children:r.empty}),e.jsx("div",{className:"space-y-5",children:d.map(S=>e.jsxs("div",{className:`bg-white rounded-2xl border p-5 sm:p-7 shadow-sm ${s&&S.id===s?"border-purple-400 ring-2 ring-purple-100":"border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:S.id}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${S.status==="open"?"bg-yellow-100 text-yellow-800":S.status==="expired"?"bg-red-100 text-red-700":"bg-green-100 text-green-800"}`,children:S.status})]}),e.jsxs("p",{className:"text-base text-gray-700 mt-3",children:[r.services,": ",S.selectedServices.join(", ")," | ",r.budget,": EUR ",S.budget.toLocaleString()]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[r.contactEmail,": ",S.customerEmail]}),S.customerPhone&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[r.contactPhone,": ",S.customerPhone]}),S.eventDate&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[r.eventDate,": ",new Date(S.eventDate).toLocaleDateString()]}),S.address&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[r.address,": ",S.address]}),S.notes&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[r.details,": ",S.notes]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[r.deadline,": ",new Date(S.expiresAt).toLocaleString()]}),S.status==="open"&&e.jsx("div",{className:"mt-3",children:e.jsx("button",{type:"button",onClick:()=>K(S.id),className:"rounded-lg bg-red-100 text-red-700 px-4 py-2 text-sm font-semibold hover:bg-red-200",children:r.cancelRequest})}),e.jsxs("div",{className:"mt-4 space-y-3",children:[S.offers.length===0&&e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-gray-50 px-4 py-3 text-sm text-gray-600",children:[r.noOffers,e.jsx("p",{className:"mt-1 text-xs text-amber-700",children:r.paymentLocked})]}),S.offers.map(F=>e.jsxs("div",{className:"rounded-xl border border-gray-200 p-4 sm:p-5",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[e.jsx("p",{className:"font-medium text-gray-900",children:F.vendorName}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${F.status==="pending"?"bg-blue-100 text-blue-700":F.status==="accepted"?"bg-green-100 text-green-700":F.status==="declined"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:F.status})]}),e.jsxs("p",{className:"text-sm text-gray-700 mt-1",children:[r.price,": EUR ",F.price.toLocaleString()]}),F.message&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:F.message}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[r.payment,": ",F.paymentStatus,F.paidAt?` (${new Date(F.paidAt).toLocaleString()})`:""]}),F.status==="pending"&&S.status==="open"&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"mb-2 text-xs text-amber-700",children:r.paymentLocked}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>$(S.id,F.id,"accepted"),className:"rounded-lg bg-green-600 text-white px-4 py-2.5 text-sm font-semibold hover:bg-green-700 w-full sm:w-auto",children:r.accept}),e.jsx("button",{type:"button",onClick:()=>$(S.id,F.id,"ignored"),className:"rounded-lg bg-gray-200 text-gray-800 px-4 py-2.5 text-sm font-semibold hover:bg-gray-300 w-full sm:w-auto",children:r.ignore}),e.jsx("button",{type:"button",onClick:()=>$(S.id,F.id,"declined"),className:"rounded-lg bg-red-100 text-red-700 px-4 py-2.5 text-sm font-semibold hover:bg-red-200 w-full sm:w-auto",children:r.decline})]})]}),F.status==="accepted"&&F.paymentStatus!=="paid"&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:r.stripeNote}),e.jsx("button",{type:"button",onClick:()=>D(S.id,F.id),className:"rounded-lg bg-purple-600 text-white px-4 py-2.5 text-sm font-semibold hover:bg-purple-700",children:r.pay})]}),F.status==="accepted"&&F.paymentStatus==="paid"&&e.jsx("div",{className:"mt-3 rounded-lg bg-green-50 border border-green-200 px-3 py-2 text-sm text-green-700",children:r.paid})]},F.id))]})]},S.id))})]})})}function Cn(){const{t}=me(),s=qe(),n="877862052844-474t40178aqpdrmfihc90t06mu1tudn9.apps.googleusercontent.com",[l,r]=o.useState(""),[c,C]=o.useState(!1),[E,x]=o.useState({email:"",password:""}),[R,m]=o.useState("");o.useEffect(()=>{const p=Pe();p&&(p.role==="vendor"?s("/vendor-portfolio"):p.role==="customer"?s("/customer-portfolio"):p.role==="admin"&&s("/admin"))},[s]),o.useEffect(()=>{if(window.google)return;const p=document.createElement("script");return p.src="https://accounts.google.com/gsi/client",p.async=!0,p.defer=!0,document.head.appendChild(p),()=>{document.head.removeChild(p)}},[]);const d=async p=>{var L,z;if(!((z=(L=window.google)==null?void 0:L.accounts)!=null&&z.id)){m("Google Sign-In Script ist noch nicht geladen. Bitte kurz warten und erneut versuchen.");return}m(""),r(p);const u=window.setTimeout(()=>{r(""),m("Google Login hat zu lange gedauert. Bitte Popup/Cookies pruefen und erneut versuchen.")},15e3);window.google.accounts.id.initialize({client_id:n,callback:async j=>{try{if(!j.credential)throw new Error("Keine Google Credential erhalten.");const N=p==="customer"?await Ws(j.credential):await ga(j.credential);Lt(N),N.role==="vendor"?s("/vendor-portfolio"):s("/customer-portfolio")}catch(N){m(N instanceof Error?N.message:"Google-Login fehlgeschlagen.")}finally{window.clearTimeout(u),r("")}}}),window.google.accounts.id.prompt(j=>{var N,f;if((N=j.isNotDisplayed)!=null&&N.call(j)){window.clearTimeout(u),r("");const y=(f=j.getNotDisplayedReason)==null?void 0:f.call(j);m(`Google Login konnte nicht gestartet werden${y?` (${y})`:""}. Bitte Popup/Cookies erlauben oder E-Mail Login nutzen.`)}})},v=async p=>{if(p.preventDefault(),!E.email.trim()||!E.password){m("Vendor email and password are required.");return}m(""),C(!0);try{const u=await pa({email:E.email.trim(),password:E.password});Lt(u),s("/vendor-portfolio")}catch(u){m(u instanceof Error?u.message:"Vendor login failed.")}finally{C(!1)}};return e.jsx("div",{className:"min-h-screen bg-gray-50 py-6 sm:py-12",children:e.jsx("div",{className:"container mx-auto px-4 max-w-md",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-5 sm:p-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-2",children:t("auth.login.title")}),e.jsx("p",{className:"text-gray-600 mb-6",children:t("auth.login.subtitle")}),e.jsxs("div",{className:"mb-5",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Login with Google"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{type:"button",onClick:()=>d("customer"),disabled:l!=="",className:"w-full rounded-lg border border-gray-300 bg-white text-gray-800 py-2.5 font-medium hover:bg-gray-50 transition-colors inline-flex items-center justify-center gap-2",children:[e.jsx(Rs,{}),l==="customer"?"Google wird geprueft...":"Mit Google als Kunde anmelden"]}),e.jsxs("button",{type:"button",onClick:()=>d("vendor"),disabled:l!=="",className:"w-full rounded-lg border border-gray-300 bg-white text-gray-800 py-2.5 font-medium hover:bg-gray-50 transition-colors inline-flex items-center justify-center gap-2",children:[e.jsx(Rs,{}),l==="vendor"?"Google wird geprueft...":"Mit Google als Vendor anmelden"]})]})]}),e.jsxs("div",{className:"relative mb-5",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-200"})}),e.jsx("div",{className:"relative flex justify-center",children:e.jsx("span",{className:"bg-white px-3 text-xs text-gray-500",children:"Vendor test login"})})]}),e.jsxs("form",{onSubmit:v,className:"space-y-2 mb-4",children:[e.jsx("input",{type:"email",placeholder:"Vendor email",value:E.email,onChange:p=>x(u=>({...u,email:p.target.value})),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5"}),e.jsx("input",{type:"password",placeholder:"Vendor password",value:E.password,onChange:p=>x(u=>({...u,password:p.target.value})),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5"}),e.jsx("button",{type:"submit",disabled:c||l!=="",className:"w-full rounded-lg bg-gray-900 text-white py-2.5 font-medium hover:bg-gray-800 disabled:bg-gray-400",children:c?"Signing in...":"Vendor test login (email/password)"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Demo vendors from admin seed use password: Vendor123!"})]}),R&&e.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700",children:R}),e.jsxs("p",{className:"text-sm text-gray-600 mt-5",children:[t("auth.login.noAccount")," ",e.jsx(V,{to:"/signup",className:"text-purple-600 hover:text-purple-700",children:t("auth.signup.button")})]})]})})})}function Rs(){return e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24","aria-hidden":"true",children:[e.jsx("path",{fill:"#EA4335",d:"M12 10.2v3.9h5.5c-.2 1.2-1.4 3.6-5.5 3.6-3.3 0-6-2.7-6-6s2.7-6 6-6c1.9 0 3.2.8 3.9 1.5l2.7-2.6C16.9 3 14.6 2 12 2a10 10 0 1 0 0 20c5.8 0 9.7-4.1 9.7-9.8 0-.7-.1-1.3-.2-2H12z"}),e.jsx("path",{fill:"#34A853",d:"M3.9 7.1l3.2 2.3C8 7.6 9.8 6 12 6c1.9 0 3.2.8 3.9 1.5l2.7-2.6C16.9 3 14.6 2 12 2 8.2 2 4.9 4.2 3.3 7.4l.6-.3z"}),e.jsx("path",{fill:"#4A90E2",d:"M12 22c2.6 0 4.8-.8 6.4-2.2l-3-2.5c-.8.5-1.9.9-3.4.9-4 0-5.2-2.7-5.4-3.9l-3.2 2.4A10 10 0 0 0 12 22z"}),e.jsx("path",{fill:"#FBBC05",d:"M3.3 7.4A10 10 0 0 0 2 12c0 1.6.4 3.2 1.2 4.6l3.3-2.5C6.3 13.5 6 12.8 6 12c0-.8.2-1.5.5-2.1L3.3 7.4z"})]})}const An=["DJ","Catering","Make-up","Dekoration","Fotografie"],Ts="877862052844-474t40178aqpdrmfihc90t06mu1tudn9.apps.googleusercontent.com";function En(){const t=qe(),[s,n]=o.useState("customer"),[l,r]=o.useState(!1),[c,C]=o.useState(!1),[E,x]=o.useState(!1),[R,m]=o.useState(!1),[d,v]=o.useState(""),[p,u]=o.useState(!1),[L,z]=o.useState(!1),[j,N]=o.useState(""),[f,y]=o.useState({businessName:"",contactName:"",email:"",password:"",googleSub:"",city:"",websiteUrl:"",portfolioUrl:"",businessIntro:"",categories:[],documentName:"",documentKey:"",documentUrl:"",stripeAccountId:""});o.useEffect(()=>{if(window.google)return;const M=document.createElement("script");return M.src="https://accounts.google.com/gsi/client",M.async=!0,M.defer=!0,document.head.appendChild(M),()=>{document.head.removeChild(M)}},[]);const O=async()=>{var A,T;if(!((T=(A=window.google)==null?void 0:A.accounts)!=null&&T.id)){v("Google Sign-In Script ist noch nicht geladen. Bitte kurz warten und erneut versuchen.");return}v(""),z(!0);const M=window.setTimeout(()=>{z(!1),v("Google Login hat zu lange gedauert. Bitte Popup/Cookies pruefen und erneut versuchen.")},15e3);window.google.accounts.id.initialize({client_id:Ts,callback:async $=>{try{if(!$.credential)throw new Error("Keine Google Credential erhalten.");const K=await Ws($.credential);Lt(K),t("/customer-portfolio")}catch(K){v(K instanceof Error?K.message:"Google-Login fehlgeschlagen.")}finally{window.clearTimeout(M),z(!1)}}}),window.google.accounts.id.prompt($=>{var K,D;if((K=$.isNotDisplayed)!=null&&K.call($)){window.clearTimeout(M),z(!1);const S=(D=$.getNotDisplayedReason)==null?void 0:D.call($);v(`Google Login konnte nicht gestartet werden${S?` (${S})`:""}. Bitte Popup/Cookies erlauben oder manuell registrieren.`)}})},te=async()=>{var A,T;if(!((T=(A=window.google)==null?void 0:A.accounts)!=null&&T.id)){v("Google Sign-In Script ist noch nicht geladen. Bitte kurz warten und erneut versuchen.");return}v(""),m(!0);const M=window.setTimeout(()=>{m(!1),v("Google Verifizierung hat zu lange gedauert. Bitte Popup/Cookies pruefen und erneut versuchen.")},15e3);window.google.accounts.id.initialize({client_id:Ts,callback:async $=>{try{if(!$.credential)throw new Error("Keine Google Credential erhalten.");const K=await ua($.credential);y(D=>({...D,email:K.profile.email||D.email,contactName:K.profile.name||D.contactName,googleSub:K.profile.sub})),u(!0)}catch(K){v(K instanceof Error?K.message:"Google-Verifizierung fehlgeschlagen.")}finally{window.clearTimeout(M),m(!1)}}}),window.google.accounts.id.prompt($=>{var K,D;if((K=$.isNotDisplayed)!=null&&K.call($)){window.clearTimeout(M),m(!1);const S=(D=$.getNotDisplayedReason)==null?void 0:D.call($);v(`Google Verifizierung konnte nicht gestartet werden${S?` (${S})`:""}. Bitte Popup/Cookies erlauben oder ohne Google fortfahren.`)}})},q=async M=>{if(M){v(""),x(!0);try{const A=await Xs({filename:M.name,contentType:M.type||"application/octet-stream"});if(!(await fetch(A.uploadUrl,{method:"PUT",headers:{"Content-Type":M.type||"application/octet-stream"},body:M})).ok)throw new Error("Upload zu R2 fehlgeschlagen.");y($=>({...$,documentName:M.name,documentKey:A.fileKey,documentUrl:A.publicUrl||""}))}catch(A){v(A instanceof Error?A.message:"Datei-Upload fehlgeschlagen.")}finally{x(!1)}}},W=async M=>{if(M.preventDefault(),v(""),N(""),!f.googleSub){v("Bitte zuerst Google-Konto als Vendor verknuepfen.");return}C(!0);try{const A=await ma({...f,password:void 0});r(!0),A!=null&&A.alreadyExists?N("Deine Vendor-Anfrage ist bereits vorhanden und wartet auf Admin-Pruefung."):N("Anfrage gesendet. Dein Vendor-Konto wartet jetzt auf Admin-Freigabe."),u(!1),y({businessName:"",contactName:"",email:"",password:"",googleSub:"",city:"",websiteUrl:"",portfolioUrl:"",businessIntro:"",categories:[],documentName:"",documentKey:"",documentUrl:"",stripeAccountId:""})}catch(A){v(A instanceof Error?A.message:"Fehler beim Senden der Vendor-Anfrage.")}finally{C(!1)}};return e.jsx("div",{className:"min-h-screen bg-gray-50 py-6 sm:py-12",children:e.jsx("div",{className:"container mx-auto px-4 max-w-3xl",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-5 sm:p-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-2",children:"Registrieren"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Waehle ob du als Kunde buchen oder als Vendor Dienstleistungen anbieten willst."}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-6",children:[e.jsx("button",{type:"button",onClick:()=>{n("customer"),r(!1)},className:`rounded-lg py-2.5 font-medium transition-colors ${s==="customer"?"bg-purple-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Als Kunde"}),e.jsx("button",{type:"button",onClick:()=>{n("vendor"),r(!1)},className:`rounded-lg py-2.5 font-medium transition-colors ${s==="vendor"?"bg-purple-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Als Vendor"})]}),s==="customer"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-lg border border-blue-200 bg-blue-50 px-3 py-2 text-sm text-blue-800",children:"Kunden nutzen nur Google Login. Kein Passwort oder E-Mail-Registrierung erforderlich."}),e.jsx("button",{type:"button",onClick:O,disabled:L,className:"w-full rounded-lg border border-gray-300 bg-white text-gray-800 py-2.5 font-medium hover:bg-gray-50 transition-colors",children:L?"Google wird geprueft...":"Mit Google als Kunde anmelden"}),e.jsx("button",{type:"button",onClick:()=>t("/login"),className:"w-full rounded-lg border border-gray-300 bg-white text-gray-800 py-2.5 font-medium hover:bg-gray-50 transition-colors",children:"Zur Login-Seite"})]}),s==="vendor"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("button",{type:"button",onClick:te,disabled:R,className:"w-full rounded-lg border border-gray-300 bg-white text-gray-800 py-2.5 font-medium hover:bg-gray-50 transition-colors",children:R?"Google wird geprueft...":"Mit Google als Vendor anmelden"}),p&&e.jsx("div",{className:"rounded-lg border border-green-200 bg-green-50 px-3 py-2 text-sm text-green-700",children:"Google Konto ist verknuepft."}),e.jsxs("form",{className:"space-y-4",onSubmit:W,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Firmenname / Brand"}),e.jsx("input",{type:"text",required:!0,value:f.businessName,onChange:M=>y(A=>({...A,businessName:M.target.value})),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Kontaktperson"}),e.jsx("input",{type:"text",required:!0,value:f.contactName,onChange:M=>y(A=>({...A,contactName:M.target.value})),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"E-Mail"}),e.jsx("input",{type:"email",required:!0,value:f.email,onChange:M=>y(A=>({...A,email:M.target.value})),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Passwort"}),e.jsx("input",{type:"password",disabled:!0,value:"",placeholder:"Deaktiviert: Vendor Login ist Google-only",onChange:()=>{},className:"w-full rounded-lg border border-gray-200 bg-gray-50 px-3 py-2.5 text-gray-500"})]})]}),!f.googleSub&&e.jsx("div",{className:"rounded-lg border border-yellow-200 bg-yellow-50 px-3 py-2 text-sm text-yellow-800",children:'Bitte zuerst "Mit Google als Vendor anmelden", dann Bewerbung absenden.'}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-2",children:"Dienstleistungen"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:An.map(M=>{const A=f.categories.includes(M);return e.jsx("button",{type:"button",onClick:()=>y(T=>({...T,categories:A?T.categories.filter($=>$!==M):[...T.categories,M]})),className:`px-3 py-1.5 rounded-full text-sm border ${A?"bg-purple-600 text-white border-purple-600":"bg-white text-gray-700 border-gray-300"}`,children:M},M)})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Stadt"}),e.jsx("input",{type:"text",required:!0,value:f.city,onChange:M=>y(A=>({...A,city:M.target.value})),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Website URL"}),e.jsx("input",{type:"url",value:f.websiteUrl,onChange:M=>y(A=>({...A,websiteUrl:M.target.value})),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Portfolio URL"}),e.jsx("input",{type:"url",value:f.portfolioUrl,onChange:M=>y(A=>({...A,portfolioUrl:M.target.value})),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Stripe Connect Account ID (optional)"}),e.jsx("input",{type:"text",placeholder:"acct_...",value:f.stripeAccountId,onChange:M=>y(A=>({...A,stripeAccountId:M.target.value})),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Business Vorstellung"}),e.jsx("textarea",{rows:4,required:!0,value:f.businessIntro,onChange:M=>y(A=>({...A,businessIntro:M.target.value})),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"CV / Business Dokument (PDF, DOC)"}),e.jsx("input",{type:"file",accept:".pdf,.doc,.docx",onChange:M=>{var A;return q((A=M.target.files)==null?void 0:A[0])},className:"w-full rounded-lg border border-gray-300 px-3 py-2.5"}),E&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Upload laeuft..."}),f.documentName&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Datei: ",f.documentName," ",f.documentUrl?"(in R2 gespeichert)":""]})]}),e.jsx("button",{type:"submit",disabled:c||E||!f.googleSub,className:"w-full rounded-lg bg-purple-600 text-white py-2.5 font-medium hover:bg-purple-700 transition-colors disabled:opacity-60",children:c?"Wird gesendet...":"Vendor Anfrage senden"})]})]}),d&&e.jsx("div",{className:"mt-5 rounded-lg border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700",children:d}),l&&e.jsx("div",{className:"mt-5 rounded-lg border border-green-200 bg-green-50 px-4 py-3 text-sm text-green-700",children:j||"Anfrage gesendet. Dein Vendor-Konto wartet jetzt auf Admin-Freigabe."}),e.jsxs("p",{className:"text-sm text-gray-600 mt-5",children:["Bereits ein Konto?"," ",e.jsx(V,{to:"/login",className:"text-purple-600 hover:text-purple-700",children:"Login"})]})]})})})}const Wt=["overview","applications","requests","compliance","inquiries"];function wt(){var ht,bt,ft,yt,vt,jt,Nt;const t=qe(),s=es(),n=ot(),{language:l}=me(),r=l==="de",c=String(n.section||"").toLowerCase(),C=Wt.includes(c)?c:"overview",E=s.pathname.startsWith("/dashboard/admin")?"/dashboard/admin":"/admin",x={title:r?"Admin-Dashboard":"Admin Dashboard",loginPrompt:r?"Bitte als Admin einloggen, um Backend-Daten zu verwalten.":"Please sign in as admin to manage backend data.",loginEmail:r?"Admin E-Mail":"Admin email",loginPassword:r?"Admin Passwort":"Admin password",wait:r?"Bitte warten...":"Please wait...",login:r?"Admin Login":"Admin login",refresh:r?"Aktualisieren":"Refresh",logout:"Logout",backendSummary:r?"Backend-Übersicht, Anbieter-Freigaben und Angebotsmanagement.":"Backend overview, vendor approvals, and offer management.",signedInAs:r?"Eingeloggt als":"Signed in as",tabs:{overview:r?"Übersicht":"Overview",applications:r?"Bewerbungen":"Applications",requests:r?"Anfragen & Angebote":"Requests & Offers",compliance:"Compliance",inquiries:r?"Nachrichten":"Inquiries"},analytics:"Analytics",applications:r?"Anbieter-Bewerbungen":"Vendor Applications",requests:r?"Anfragen und Angebote":"Requests and Offers",inquiries:r?"Anbieter-Nachrichten an Admin":"Vendor inquiries to admin",approve:r?"Freigeben":"Approve",reject:r?"Ablehnen":"Reject",backToPending:r?"Zurück auf ausstehend":"Back to pending",viewDetails:r?"Details ansehen":"View details",activeApplications:r?"Aktive Bewerbungen":"Active applications",historyApplications:r?"Verlauf (freigegeben)":"History (approved)",reviewNote:r?"Review-Notiz (optional)":"Review note (optional)",loadingData:r?"Daten werden geladen...":"Loading data...",noApplications:r?"Keine Anbieter-Bewerbungen gefunden.":"No vendor applications found.",noRequests:r?"Keine Anfragen gefunden.":"No requests found.",noOffers:r?"Keine Angebote":"No offers",noInquiries:r?"Keine Anbieter-Nachrichten vorhanden.":"No vendor inquiries found.",open:r?"Öffnen":"Open",close:r?"Schließen":"Close",customer:r?"Kunde":"Customer",deadline:r?"Frist bis":"Deadline",accept:r?"Akzeptieren":"Accept",ignore:r?"Ignorieren":"Ignore",documentOpen:r?"Datei öffnen":"Open file",reviewedAt:r?"Geprüft":"Reviewed",businessIntro:r?"Unternehmensvorstellung":"Business intro",from:r?"Von":"From",attachmentLinks:r?"Datei-/Bild-Links (optional, mit Komma trennen)":"Document/image links (optional, comma-separated)"},[R,m]=o.useState(""),[d,v]=o.useState(""),[p,u]=o.useState(""),[L,z]=o.useState(""),[j,N]=o.useState(null),[f,y]=o.useState([]),[O,te]=o.useState([]),[q,W]=o.useState(!1),[M,A]=o.useState(""),[T,$]=o.useState([]),[K,D]=o.useState({}),[S,F]=o.useState({}),[B,oe]=o.useState(null),[le,we]=o.useState([]),[ge,G]=o.useState([]),[ne,U]=o.useState([]),[Y,ue]=o.useState(null),[re,he]=o.useState([]),[pe,Le]=o.useState(""),[ke,Te]=o.useState(!1),[De,ve]=o.useState({}),[w,P]=o.useState({}),[Z,Q]=o.useState({}),[ce,ie]=o.useState({}),[Be,Oe]=o.useState(""),[Re,je]=o.useState(""),[xe,Ce]=o.useState(""),[b,se]=o.useState(""),[h,I]=o.useState(""),[ee,de]=o.useState(""),Ne=String(L||R||"A").trim().charAt(0).toUpperCase()||"A",Fe=Object.fromEntries(f.map(a=>[String(a.email||"").toLowerCase(),a.status])),be=f.filter(a=>a.status!=="approved"),Ve=f.filter(a=>a.status==="approved"),ct=[{name:"Open",value:O.filter(a=>a.status==="open").length},{name:"Closed",value:O.filter(a=>a.status==="closed").length},{name:"Expired",value:O.filter(a=>a.status==="expired").length}],_e=O.length?Math.round(O.filter(a=>a.offers.length>0).length/O.length*100):0,dt=O.length?O.filter(a=>a.status==="expired").length/O.length:0,mt=f.length?f.filter(a=>a.status==="pending_review").length/f.length:0,Ke=Math.max(0,Math.min(100,Math.round(100-dt*45-mt*25-(100-_e)*.3))),Me={};for(const a of O){const k=new Date(a.createdAt).toISOString().slice(0,10);Me[k]||(Me[k]={day:k,requests:0,inquiries:0,applications:0}),Me[k].requests+=1}for(const a of T){const k=new Date(a.createdAt).toISOString().slice(0,10);Me[k]||(Me[k]={day:k,requests:0,inquiries:0,applications:0}),Me[k].inquiries+=1}for(const a of f){const k=new Date(a.createdAt).toISOString().slice(0,10);Me[k]||(Me[k]={day:k,requests:0,inquiries:0,applications:0}),Me[k].applications+=1}const st=Object.values(Me).sort((a,k)=>a.day.localeCompare(k.day)).slice(-14);o.useEffect(()=>{n.section&&(Wt.includes(c)||t(`${E}/overview`,{replace:!0}))},[E,t,n.section,c]),o.useEffect(()=>{const a=Yt(),k=Hr();a&&(u(a),k!=null&&k.name&&(z(k.name),k.email&&ms(a,k)),Ae(a))},[]);const Ae=async(a=p)=>{if(a.trim()){W(!0),A("");try{const[k,J,ae,X,i,g]=await Promise.all([Ea(a),Pa(a),$a(a),Ga(a),Ra(a).catch(()=>({payouts:[]})),Ia(a).catch(()=>({logs:[]}))]),[_,Se]=await Promise.all([Ta(a).catch(()=>null),La(a).catch(()=>({entries:[]}))]),ze=await Da(a).catch(()=>({compliances:[]}));N(k.overview),y(J.applications),te(ae.requests),$(X.inquiries),we(ze.compliances||[]),G(i.payouts||[]),U(g.logs||[]),ue(_),he(Se.entries||[]),u(a)}catch(k){A(k instanceof Error?k.message:"Fehler beim Laden des Admin Dashboards.")}finally{W(!1)}}},Qe=async()=>{if(!R.trim()||!d.trim()){A("Bitte Admin E-Mail und Passwort eingeben.");return}W(!0),A("");try{const a=await Ka({email:R,password:d});u(a.token),z(a.admin.name),ms(a.token,a.admin),await Ae(a.token),v("")}catch(a){A(a instanceof Error?a.message:"Admin-Login fehlgeschlagen.")}finally{W(!1)}},Je=()=>{Gs(),u(""),z(""),m(""),v(""),N(null),y([]),te([]),G([]),U([]),ue(null),he([]),de(""),A("")},rt=async a=>{A(""),Le(a);try{const k=await Ba(p,a);!k.released&&k.reason&&A(k.reason),await Ae()}catch(k){A(k instanceof Error?k.message:"Failed to release payout.")}finally{Le("")}},ut=async a=>{A(""),se(a);try{const k=await Oa(p,a),J=`accounting-pack-${a}.json`,ae=new Blob([JSON.stringify(k,null,2)],{type:"application/json;charset=utf-8"}),X=URL.createObjectURL(ae),i=document.createElement("a");i.href=X,i.download=J,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(X),fe.success(r?"Accounting-Dokument erstellt.":"Accounting pack generated.")}catch(k){const J=k instanceof Error?k.message:"Failed to generate accounting pack.";A(J),fe.error(J)}finally{se("")}},Mt=async a=>{A(""),I(a);try{const k=await Ma(p,a),J=`accounting-pack-${a}.pdf`,ae=URL.createObjectURL(k),X=document.createElement("a");X.href=ae,X.download=J,document.body.appendChild(X),X.click(),document.body.removeChild(X),URL.revokeObjectURL(ae),fe.success(r?"Accounting-PDF erstellt.":"Accounting PDF generated.")}catch(k){const J=k instanceof Error?k.message:"Failed to generate accounting PDF.";A(J),fe.error(J)}finally{I("")}},Ge=async(a,k,J)=>{A(""),Ce(`${a}:${k}`);try{const ae=String(J||"").trim()||void 0,X=await Fa(p,a,k,ae);y(i=>i.map(g=>g.id===a?{...g,...X.application}:g)),oe(i=>i&&i.id===a?{...i,...X.application}:i),ve(i=>({...i,[a]:""})),Ae(),k==="approved"&&fe.success(r?"Vendor freigegeben.":"Vendor approved."),k==="rejected"&&fe.success(r?"Vendor abgelehnt.":"Vendor rejected."),k==="pending_review"&&fe.success(r?"Vendor auf Pending gesetzt.":"Vendor moved to pending.")}catch(ae){const X=ae instanceof Error?ae.message:"Fehler beim Aktualisieren der Vendor-Anfrage.";A(X),fe.error(X)}finally{Ce("")}},at=async(a,k,J)=>{A("");try{await Ys(a,k,J,{adminToken:p}),await Ae()}catch(ae){A(ae instanceof Error?ae.message:"Fehler beim Aktualisieren des Angebots.")}},We=async(a,k)=>{A(""),je(`${a}:${k}`);try{const J=await Va(p,a,k),ae=f.find(X=>X.id===a);y(X=>X.map(i=>i.id===a?{...i,compliance:J.compliance,...J.application}:i)),oe(X=>X&&X.id===a?{...X,compliance:J.compliance,...J.application}:X),ae!=null&&ae.email&&we(X=>X.map(i=>String(i.vendorEmail||"").toLowerCase()===String(ae.email||"").toLowerCase()?{...i,contractAccepted:J.compliance.contractAccepted,contractAcceptedAt:J.compliance.contractAcceptedAt||null,contractVersion:J.compliance.contractVersion||null,contractAcceptedByUserId:J.compliance.contractAcceptedByUserId||null,contractAcceptedIP:J.compliance.contractAcceptedIP||null,trainingCompleted:J.compliance.trainingCompleted,trainingCompletedAt:J.compliance.trainingCompletedAt||null}:i)),Ae(),fe.success(k==="contract"?r?"Vertrag bestaetigt.":"Contract confirmed.":r?"Training bestaetigt.":"Training confirmed.")}catch(J){const ae=J instanceof Error?J.message:"Failed to confirm compliance.";A(ae),fe.error(ae)}finally{je("")}},Ze=async()=>{A("");try{const k=`Seed done: ${(await Ua(p)).count} services available.`;de(k),fe.success(k),await Ae()}catch(a){A(a instanceof Error?a.message:"Fehler beim Seed von Services.")}},He=async()=>{A("");try{const k=`Seed done: ${(await qa(p)).count} demo vendors upserted.`;de(k),fe.success(k),await Ae()}catch(a){A(a instanceof Error?a.message:"Fehler beim Seed von Demo-Vendors.")}},gt=async()=>{Te(!0),A("");try{const a=await za(p);await Ae(),alert(`Compliance backfill finished: ${a.migrated}/${a.total}`)}catch(a){A(a instanceof Error?a.message:"Compliance backfill failed.")}finally{Te(!1)}},zt=a=>{D(k=>({...k,[a]:!k[a]}))},pt=a=>{oe(a)},xt=()=>{oe(null)},Ft=a=>{F(k=>({...k,[a]:!k[a]}))},Vt=async a=>{const k=String(w[a]||"").trim();if(!k){fe.error(r?"Bitte zuerst eine Antwort eingeben.":"Please enter a reply first.");return}const J=String(Z[a]||"").split(",").map(X=>X.trim()).filter(Boolean),ae=ce[a]||[];Oe(a),A("");try{const X=ae.length>0?await Promise.all(ae.map(async g=>(await Qt(g)).publicUrl)):[],i=await Ha(p,a,k,[...J,...X]);$(g=>g.map(_=>_.id===a?i.inquiry:_)),P(g=>({...g,[a]:""})),Q(g=>({...g,[a]:""})),ie(g=>({...g,[a]:[]})),i.emailSent===!1?fe.warning(r?"Antwort gespeichert, aber E-Mail wurde nicht zugestellt.":"Reply saved, but email was not delivered."):fe.success(r?"Antwort gesendet.":"Reply sent.")}catch(X){const i=X instanceof Error?X.message:"Failed to send reply.";A(i),fe.error(i)}finally{Oe("")}};return p?e.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:e.jsxs("div",{className:"container mx-auto px-4 max-w-7xl space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:x.title}),e.jsx("p",{className:"text-gray-600 mt-1",children:x.backendSummary}),L&&e.jsxs("div",{className:"mt-2 inline-flex items-center gap-2 rounded-lg border border-blue-200 bg-blue-50 px-3 py-2 text-sm text-blue-800",children:[e.jsx("div",{className:"h-7 w-7 rounded-full bg-blue-600 text-white flex items-center justify-center font-semibold",children:Ne}),e.jsx("div",{className:"leading-tight",children:e.jsxs("p",{className:"font-medium",children:[x.signedInAs," ",L]})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>Ae(),title:r?"Alle Admin-Daten neu laden":"Reload all admin data",className:"rounded-lg border border-gray-300 px-4 py-2.5 text-sm hover:bg-gray-50",children:x.refresh}),e.jsx("button",{type:"button",onClick:Ze,title:r?"Setup: Demo-Servicekatalog in die Datenbank schreiben":"Setup: insert demo service catalog into database",className:"rounded-lg border border-purple-300 text-purple-700 px-4 py-2.5 text-sm hover:bg-purple-50",children:r?"Setup: Services seeden":"Setup: seed services"}),e.jsx("button",{type:"button",onClick:He,title:r?"Setup: Demo-Anbieter und Profile anlegen/aktualisieren":"Setup: create/update demo vendors and profiles",className:"rounded-lg border border-green-300 text-green-700 px-4 py-2.5 text-sm hover:bg-green-50",children:r?"Setup: Vendor seeden":"Setup: seed vendors"}),e.jsx("button",{type:"button",onClick:Je,title:r?"Admin-Sitzung beenden":"Sign out of admin session",className:"rounded-lg bg-gray-900 text-white px-4 py-2.5 text-sm hover:bg-black",children:x.logout})]})]}),M&&e.jsx("div",{className:"mt-4 rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700",children:M}),e.jsx("div",{className:"mt-3 rounded-lg border border-blue-200 bg-blue-50 px-3 py-2 text-xs text-blue-800",children:"Build/Node.js is a terminal action (`npm run build`). Buttons here perform admin data operations."}),ee&&e.jsx("div",{className:"mt-3 rounded-lg border border-emerald-200 bg-emerald-50 px-3 py-2 text-sm text-emerald-800",children:ee}),e.jsx("div",{className:"mt-5 flex flex-wrap gap-2",children:Wt.map(a=>{const k=C===a;return e.jsx(V,{to:`${E}/${a}`,title:r?`Bereich öffnen: ${x.tabs[a]}`:`Open section: ${x.tabs[a]}`,className:`rounded-lg border px-3 py-2 text-sm transition-colors ${k?"border-purple-300 bg-purple-50 text-purple-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:x.tabs[a]},a)})})]}),C==="overview"&&j&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx(et,{title:r?"Kunden":"Customers",value:j.customers}),e.jsx(et,{title:r?"Anbieter-Bewerbungen":"Vendor applications",value:j.vendorApplications}),e.jsx(et,{title:r?"Offene Anfragen":"Open requests",value:j.openRequests}),e.jsx(et,{title:r?"Geschlossene Anfragen":"Closed requests",value:j.closedRequests}),e.jsx(et,{title:r?"Abgelaufene Anfragen":"Expired requests",value:j.expiredRequests}),e.jsx(et,{title:r?"Gesamte Angebote":"Total offers",value:j.totalOffers})]}),C==="overview"&&Y&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Capability KPIs (30d)"}),e.jsxs("p",{className:"text-xs text-gray-500",children:[new Date(Y.window.from).toLocaleDateString()," - ",new Date(Y.window.to).toLocaleDateString()]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-5 gap-3 text-sm",children:[e.jsxs("div",{className:"rounded-lg border border-gray-200 p-3",children:[e.jsx("strong",{children:"First offer:"})," ",Y.kpis.requestToFirstOfferMinutes??"-"," min"]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 p-3",children:[e.jsx("strong",{children:"Offer acceptance:"})," ",(Y.kpis.offerAcceptanceRate*100).toFixed(1),"%"]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 p-3",children:[e.jsx("strong",{children:"On-time completion:"})," ",(Y.kpis.onTimeCompletionRate*100).toFixed(1),"%"]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 p-3",children:[e.jsx("strong",{children:"SLA compliance:"})," ",Y.kpis.vendorResponseSlaComplianceRate==null?"-":`${(Y.kpis.vendorResponseSlaComplianceRate*100).toFixed(1)}%`]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 p-3",children:[e.jsx("strong",{children:"Avg payout time:"})," ",Y.kpis.avgPayoutTimeHours==null?"-":`${Y.kpis.avgPayoutTimeHours} h`]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 p-3",children:[e.jsx("strong",{children:"Repeat booking:"})," ",(Y.kpis.repeatBookingRate*100).toFixed(1),"%"]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 p-3",children:[e.jsx("strong",{children:"Dispute/refund:"})," ",(Y.kpis.disputeRate*100).toFixed(1),"%"]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 p-3",children:[e.jsx("strong",{children:"Chargeback:"})," ",(Y.kpis.chargebackRate*100).toFixed(2),"%"]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 p-3",children:[e.jsx("strong",{children:"Avg rating:"})," ",Y.kpis.averageRating??"-"]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 p-3",children:[e.jsx("strong",{children:"Review count:"})," ",Y.kpis.reviewCount]})]})]}),C==="overview"&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:x.analytics}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"rounded-lg border border-gray-200 p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Platform Health Score"}),e.jsxs("p",{className:"text-3xl font-bold text-gray-900 mt-1",children:[Ke,"/100"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Based on expiry rate, pending vendors, and offer coverage."})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Offer Coverage"}),e.jsxs("p",{className:"text-3xl font-bold text-gray-900 mt-1",children:[_e,"%"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Requests that received at least one offer."})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Risk Flag"}),e.jsx("p",{className:"text-3xl font-bold mt-1",children:Ke<55?"High":Ke<75?"Medium":"Low"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Auto-classified operational risk level."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"h-72 rounded-lg border border-gray-200 p-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Request Status Distribution"}),e.jsx($t,{width:"100%",height:"100%",children:e.jsxs(dr,{children:[e.jsxs(mr,{data:ct,dataKey:"value",nameKey:"name",outerRadius:90,children:[e.jsx(Ut,{fill:"#2563eb"}),e.jsx(Ut,{fill:"#16a34a"}),e.jsx(Ut,{fill:"#dc2626"})]}),e.jsx(qt,{})]})})]}),e.jsxs("div",{className:"h-72 rounded-lg border border-gray-200 p-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Activity Trend (14 Days)"}),e.jsx($t,{width:"100%",height:"100%",children:e.jsxs(ur,{data:st,children:[e.jsx(ls,{strokeDasharray:"3 3"}),e.jsx(cs,{dataKey:"day"}),e.jsx(ds,{}),e.jsx(qt,{}),e.jsx(Gt,{dataKey:"requests",stroke:"#2563eb",strokeWidth:2}),e.jsx(Gt,{dataKey:"applications",stroke:"#16a34a",strokeWidth:2}),e.jsx(Gt,{dataKey:"inquiries",stroke:"#9333ea",strokeWidth:2})]})})]})]}),e.jsxs("div",{className:"mt-6 h-72 rounded-lg border border-gray-200 p-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Daily Workload Mix"}),e.jsx($t,{width:"100%",height:"100%",children:e.jsxs(gr,{data:st,children:[e.jsx(ls,{strokeDasharray:"3 3"}),e.jsx(cs,{dataKey:"day"}),e.jsx(ds,{}),e.jsx(qt,{}),e.jsx(Ht,{dataKey:"requests",fill:"#2563eb"}),e.jsx(Ht,{dataKey:"applications",fill:"#16a34a"}),e.jsx(Ht,{dataKey:"inquiries",fill:"#9333ea"})]})})]})]}),C==="applications"&&e.jsxs("div",{id:"admin-applications",className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:x.applications}),q&&e.jsx("p",{className:"text-gray-600",children:x.loadingData}),!q&&f.length===0&&e.jsx("p",{className:"text-gray-600",children:x.noApplications}),!q&&e.jsxs("p",{className:"mb-3 text-sm text-gray-700",children:[x.activeApplications,": ",e.jsx("strong",{children:be.length})," | ",x.historyApplications,": ",e.jsx("strong",{children:Ve.length})]}),e.jsx("div",{className:"space-y-4",children:be.map(a=>e.jsxs("div",{className:"rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[e.jsx("p",{className:"font-medium text-gray-900",children:a.businessName}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>zt(a.id),title:r?"Karten-Details ein-/ausblenden":"Toggle card details",className:"rounded-lg border border-gray-300 px-2 py-1 text-xs hover:bg-gray-50",children:K[a.id]?x.close:x.open}),e.jsx("button",{type:"button",onClick:()=>pt(a),title:r?"Vollständige Bewerbungsdetails öffnen":"Open full application details",className:"rounded-lg border border-purple-300 px-2 py-1 text-xs text-purple-700 hover:bg-purple-50",children:x.viewDetails}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${a.status==="approved"?"bg-green-100 text-green-700":a.status==="rejected"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-800"}`,children:a.status})]})]}),e.jsxs("p",{className:"text-sm text-gray-700 mt-1",children:["Kontakt: ",a.contactName," | ",a.email]}),a.city&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Stadt: ",a.city]}),a.compliance&&e.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Compliance: admin=",a.compliance.adminApproved?"yes":"no",", contract=",a.compliance.contractAccepted?"yes":"no",", training=",a.compliance.trainingCompleted?"yes":"no",", active=",a.compliance.canPublish?"yes":"no"]}),K[a.id]&&e.jsxs("div",{className:"mt-3 rounded-lg bg-gray-50 border border-gray-200 p-3 text-sm text-gray-700 space-y-1",children:[a.websiteUrl&&e.jsxs("p",{children:["Website: ",a.websiteUrl]}),a.portfolioUrl&&e.jsxs("p",{children:["Portfolio: ",a.portfolioUrl]}),a.businessIntro&&e.jsxs("p",{children:["Intro: ",a.businessIntro]}),a.documentUrl&&e.jsxs("p",{children:["Dokument: ",e.jsx("a",{className:"text-purple-700 underline",href:a.documentUrl,target:"_blank",rel:"noreferrer",children:x.documentOpen})]}),a.documentName&&e.jsxs("p",{children:["Dateiname: ",a.documentName]}),a.stripeAccountId&&e.jsxs("p",{children:["Stripe Connect: ",a.stripeAccountId]}),a.compliance&&e.jsxs("p",{children:["Contract accepted: ",a.compliance.contractAccepted?"yes":"no"]}),a.compliance&&a.compliance.contractAcceptedAt&&e.jsxs("p",{children:["Contract accepted at: ",new Date(a.compliance.contractAcceptedAt).toLocaleString()]}),a.compliance&&e.jsxs("p",{children:["Training completed: ",a.compliance.trainingCompleted?"yes":"no"]}),a.compliance&&a.compliance.trainingCompletedAt&&e.jsxs("p",{children:["Training completed at: ",new Date(a.compliance.trainingCompletedAt).toLocaleString()]}),a.reviewNote&&e.jsxs("p",{children:[x.reviewNote,": ",a.reviewNote]}),a.reviewedAt&&e.jsxs("p",{children:["Reviewed At: ",new Date(a.reviewedAt).toLocaleString()]})]}),e.jsx("div",{className:"mt-3",children:e.jsx("input",{type:"text",placeholder:x.reviewNote,value:De[a.id]||"",onChange:k=>ve(J=>({...J,[a.id]:k.target.value})),className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm"})}),e.jsxs("div",{className:"mt-3 flex items-center gap-2 flex-wrap",children:[e.jsx("button",{type:"button",onClick:()=>Ge(a.id,"approved",De[a.id]),title:r?"Anbieter freigeben":"Approve this vendor",className:"rounded-lg bg-green-600 text-white px-3 py-2 text-sm hover:bg-green-700",children:x.approve}),e.jsx("button",{type:"button",onClick:()=>Ge(a.id,"rejected",De[a.id]),title:r?"Bewerbung ablehnen":"Reject this application",className:"rounded-lg bg-red-100 text-red-700 px-3 py-2 text-sm hover:bg-red-200",children:x.reject}),e.jsx("button",{type:"button",onClick:()=>Ge(a.id,"pending_review"),title:r?"Zurück in Prüfung setzen":"Move back to pending review",className:"rounded-lg bg-gray-200 text-gray-800 px-3 py-2 text-sm hover:bg-gray-300",children:x.backToPending})]})]},a.id))}),!q&&Ve.length>0&&e.jsxs("div",{className:"mt-6 rounded-lg border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-800 mb-3",children:x.historyApplications}),e.jsx("div",{className:"space-y-3",children:Ve.map(a=>e.jsxs("div",{className:"rounded-lg border border-green-200 bg-green-50 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 flex-wrap",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:a.businessName}),e.jsx("button",{type:"button",onClick:()=>pt(a),title:r?"Vollständige Bewerbungsdetails öffnen":"Open full application details",className:"rounded-lg border border-purple-300 px-2 py-1 text-xs text-purple-700 hover:bg-purple-50",children:x.viewDetails})]}),e.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:[a.contactName," | ",a.email]})]},a.id))})]})]}),C==="requests"&&e.jsxs("div",{id:"admin-requests",className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:x.requests}),q&&e.jsx("p",{className:"text-gray-600",children:x.loadingData}),!q&&O.length===0&&e.jsx("p",{className:"text-gray-600",children:x.noRequests}),e.jsx("div",{className:"space-y-5",children:O.map(a=>e.jsxs("div",{className:"rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[e.jsx("p",{className:"font-medium text-gray-900",children:a.id}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>Ft(a.id),title:r?"Anfrage und Angebote ein-/ausblenden":"Toggle request and offers",className:"rounded-lg border border-gray-300 px-2 py-1 text-xs hover:bg-gray-50",children:S[a.id]?x.close:x.open}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${a.status==="open"?"bg-blue-100 text-blue-700":a.status==="closed"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:a.status})]})]}),e.jsxs("p",{className:"text-sm text-gray-700 mt-1",children:[x.customer,": ",a.customerName," (",a.customerEmail,") | Budget: EUR ",a.budget.toLocaleString()]}),a.customerPhone&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Telefon: ",a.customerPhone]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[x.deadline,": ",new Date(a.expiresAt).toLocaleString()]}),S[a.id]&&e.jsxs("div",{className:"mt-3 space-y-2",children:[a.offers.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:x.noOffers}),a.offers.map(k=>e.jsxs("div",{className:"rounded-lg border border-gray-200 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[k.vendorName," | EUR ",k.price.toLocaleString()]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${k.status==="accepted"?"bg-green-100 text-green-700":k.status==="declined"?"bg-red-100 text-red-700":k.status==="ignored"?"bg-gray-100 text-gray-700":"bg-blue-100 text-blue-700"}`,children:k.status}),e.jsxs("span",{className:`text-xs px-2 py-1 rounded-full ${k.paymentStatus==="paid"?"bg-green-100 text-green-700":k.paymentStatus==="failed"?"bg-red-100 text-red-700":k.paymentStatus==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-700"}`,children:["payment: ",k.paymentStatus]})]})]}),a.status==="open"&&k.status==="pending"&&e.jsxs("div",{className:"mt-2 flex items-center gap-2 flex-wrap",children:[e.jsx("button",{type:"button",onClick:()=>at(a.id,k.id,"accepted"),title:r?"Angebot akzeptieren":"Accept offer",className:"rounded-lg bg-green-600 text-white px-3 py-2 text-xs hover:bg-green-700",children:x.accept}),e.jsx("button",{type:"button",onClick:()=>at(a.id,k.id,"declined"),title:r?"Angebot ablehnen":"Decline offer",className:"rounded-lg bg-red-100 text-red-700 px-3 py-2 text-xs hover:bg-red-200",children:x.reject}),e.jsx("button",{type:"button",onClick:()=>at(a.id,k.id,"ignored"),title:r?"Angebot ignorieren, ohne Entscheidung":"Ignore offer without decision",className:"rounded-lg bg-gray-200 text-gray-800 px-3 py-2 text-xs hover:bg-gray-300",children:x.ignore})]})]},k.id))]})]},a.id))})]}),C==="compliance"&&e.jsxs("div",{id:"admin-compliance",className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Vendor Compliance (DB)"}),e.jsx("button",{type:"button",onClick:gt,disabled:ke,title:r?"Legacy-Compliance-Daten in DB übertragen":"Migrate legacy compliance data into DB",className:"rounded-lg bg-indigo-600 text-white px-4 py-2 text-sm hover:bg-indigo-700 disabled:opacity-60",children:ke?"Backfilling...":"Backfill from legacy JSON"})]}),le.length===0?e.jsx("p",{className:"text-sm text-gray-600",children:"No compliance rows found yet."}):e.jsx("div",{className:"overflow-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left border-b border-gray-200",children:[e.jsx("th",{className:"py-2 pr-3",children:"Vendor"}),e.jsx("th",{className:"py-2 pr-3",children:"Admin"}),e.jsx("th",{className:"py-2 pr-3",children:"Contract"}),e.jsx("th",{className:"py-2 pr-3",children:"Training"}),e.jsx("th",{className:"py-2 pr-3",children:"Connect"}),e.jsx("th",{className:"py-2 pr-3",children:"Payouts"}),e.jsx("th",{className:"py-2 pr-3",children:"Updated"})]})}),e.jsx("tbody",{children:le.map(a=>e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsxs("td",{className:"py-2 pr-3",children:[e.jsx("div",{className:"font-medium",children:a.vendorName||"-"}),e.jsx("div",{className:"text-xs text-gray-500",children:a.vendorEmail})]}),e.jsx("td",{className:"py-2 pr-3",children:Fe[String(a.vendorEmail||"").toLowerCase()]==="approved"?"yes":"pending"}),e.jsx("td",{className:"py-2 pr-3",children:a.contractAccepted?"yes":"no"}),e.jsx("td",{className:"py-2 pr-3",children:a.trainingCompleted?"yes":"no"}),e.jsx("td",{className:"py-2 pr-3",children:a.connectOnboardingStatus||"NOT_STARTED"}),e.jsx("td",{className:"py-2 pr-3",children:a.payoutsEnabled?"enabled":"disabled"}),e.jsx("td",{className:"py-2 pr-3",children:a.updatedAt?new Date(a.updatedAt).toLocaleString():"-"})]},a.id))})]})})]}),C==="overview"&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Payout Transfers"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Last ",ge.length," payout rows"]})]}),ge.length===0?e.jsx("p",{className:"text-sm text-gray-600",children:"No payout rows found yet."}):e.jsx("div",{className:"overflow-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left border-b border-gray-200",children:[e.jsx("th",{className:"py-2 pr-3",children:"Vendor"}),e.jsx("th",{className:"py-2 pr-3",children:"Booking"}),e.jsx("th",{className:"py-2 pr-3",children:"Invoice"}),e.jsx("th",{className:"py-2 pr-3",children:"Amounts (EUR)"}),e.jsx("th",{className:"py-2 pr-3",children:"Transfer"}),e.jsx("th",{className:"py-2 pr-3",children:"Status"}),e.jsx("th",{className:"py-2 pr-3",children:"Action"}),e.jsx("th",{className:"py-2 pr-3",children:"Documents"}),e.jsx("th",{className:"py-2 pr-3",children:"Updated"})]})}),e.jsx("tbody",{children:ge.map(a=>e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsxs("td",{className:"py-2 pr-3",children:[e.jsx("div",{className:"font-medium",children:a.vendorName||"-"}),e.jsx("div",{className:"text-xs text-gray-500",children:a.vendorEmail||"-"})]}),e.jsxs("td",{className:"py-2 pr-3",children:[e.jsx("div",{className:"font-mono text-xs",children:a.bookingId}),e.jsx("div",{className:"text-xs text-gray-500",children:a.bookingStatus||"-"})]}),e.jsxs("td",{className:"py-2 pr-3",children:[e.jsx("div",{className:"font-mono text-xs",children:a.invoiceId||"-"}),e.jsx("div",{className:"text-xs text-gray-500",children:a.invoiceStatus||"-"})]}),e.jsxs("td",{className:"py-2 pr-3",children:[e.jsxs("div",{children:["Gross: ",(Number(a.grossAmount||0)/100).toFixed(2)]}),e.jsxs("div",{children:["Fee: ",(Number(a.platformFee||0)/100).toFixed(2)]}),e.jsxs("div",{children:["Vendor: ",(Number(a.vendorNetAmount||0)/100).toFixed(2)]})]}),e.jsx("td",{className:"py-2 pr-3",children:e.jsx("div",{className:"font-mono text-xs break-all",children:a.stripeTransferId||"-"})}),e.jsx("td",{className:"py-2 pr-3",children:e.jsx("span",{className:`inline-flex rounded-full px-2 py-0.5 text-xs ${a.status==="paid"?"bg-emerald-100 text-emerald-700":a.status==="failed"?"bg-rose-100 text-rose-700":"bg-amber-100 text-amber-700"}`,children:a.status})}),e.jsx("td",{className:"py-2 pr-3",children:a.status!=="paid"?e.jsx("button",{type:"button",onClick:()=>rt(a.id),disabled:pe===a.id,title:r?"Auszahlung erneut an Stripe senden":"Retry sending payout to Stripe",className:"rounded-md border border-gray-300 px-2 py-1 text-xs hover:bg-gray-50 disabled:opacity-60",children:pe===a.id?"Releasing...":"Retry release"}):e.jsx("span",{className:"text-xs text-gray-500",children:"-"})}),e.jsx("td",{className:"py-2 pr-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>ut(a.bookingId),disabled:b===a.bookingId,className:"rounded-md border border-indigo-300 px-2 py-1 text-xs text-indigo-700 hover:bg-indigo-50 disabled:opacity-60",children:b===a.bookingId?"Generating...":"JSON"}),e.jsx("button",{type:"button",onClick:()=>Mt(a.bookingId),disabled:h===a.bookingId,className:"rounded-md border border-blue-300 px-2 py-1 text-xs text-blue-700 hover:bg-blue-50 disabled:opacity-60",children:h===a.bookingId?"Generating...":"PDF"})]})}),e.jsx("td",{className:"py-2 pr-3",children:a.updatedAt?new Date(a.updatedAt).toLocaleString():"-"})]},a.id))})]})})]}),C==="overview"&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Ledger (latest 500)"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Append-only financial event journal"})]}),re.length===0?e.jsx("p",{className:"text-sm text-gray-600",children:"No ledger entries yet (or ledger model not migrated)."}):e.jsx("div",{className:"overflow-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left border-b border-gray-200",children:[e.jsx("th",{className:"py-2 pr-3",children:"When"}),e.jsx("th",{className:"py-2 pr-3",children:"Type"}),e.jsx("th",{className:"py-2 pr-3",children:"Booking"}),e.jsx("th",{className:"py-2 pr-3",children:"Invoice/Payout"}),e.jsx("th",{className:"py-2 pr-3",children:"Amount"}),e.jsx("th",{className:"py-2 pr-3",children:"Direction"}),e.jsx("th",{className:"py-2 pr-3",children:"Reference"})]})}),e.jsx("tbody",{children:re.map(a=>e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("td",{className:"py-2 pr-3",children:a.createdAt?new Date(a.createdAt).toLocaleString():"-"}),e.jsx("td",{className:"py-2 pr-3",children:a.entryType}),e.jsx("td",{className:"py-2 pr-3 font-mono text-xs",children:a.bookingId||"-"}),e.jsx("td",{className:"py-2 pr-3 font-mono text-xs",children:a.invoiceId||a.payoutId||"-"}),e.jsx("td",{className:"py-2 pr-3",children:a.amountCents==null?"-":`${(Number(a.amountCents)/100).toFixed(2)} ${String(a.currency||"eur").toUpperCase()}`}),e.jsx("td",{className:"py-2 pr-3",children:a.direction||"-"}),e.jsxs("td",{className:"py-2 pr-3 font-mono text-xs",children:[a.referenceType||"-",":",a.referenceId||"-"]})]},a.id))})]})})]}),C==="overview"&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Admin Audit Log"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Last ",ne.length," entries"]})]}),ne.length===0?e.jsx("p",{className:"text-base text-gray-600",children:"No audit entries found."}):e.jsx("div",{className:"overflow-auto rounded-lg border border-gray-200",children:e.jsxs("table",{className:"min-w-full text-base",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left border-b border-gray-200 bg-gray-50 text-gray-700",children:[e.jsx("th",{className:"py-3 px-4 font-semibold",children:"When"}),e.jsx("th",{className:"py-3 px-4 font-semibold",children:"Admin"}),e.jsx("th",{className:"py-3 px-4 font-semibold",children:"Action"}),e.jsx("th",{className:"py-3 px-4 font-semibold",children:"Target"}),e.jsx("th",{className:"py-3 px-4 font-semibold",children:"Meta"})]})}),e.jsx("tbody",{children:ne.map(a=>e.jsxs("tr",{className:"border-b border-gray-100 align-top",children:[e.jsx("td",{className:"py-3 px-4 whitespace-nowrap text-sm font-medium text-gray-800",children:a.createdAt?new Date(a.createdAt).toLocaleString():"-"}),e.jsx("td",{className:"py-3 px-4 font-mono text-sm text-gray-700 break-all",children:a.adminId}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"inline-flex rounded-full border border-blue-200 bg-blue-50 px-2.5 py-1 text-xs font-medium text-blue-700",children:a.action})}),e.jsx("td",{className:"py-3 px-4 font-mono text-sm text-gray-700 break-all",children:a.targetId||"-"}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("pre",{className:"max-w-xl overflow-auto rounded-md bg-gray-50 px-3 py-2 text-xs text-gray-700 whitespace-pre-wrap break-words",children:a.metaJson||"-"})})]},a.id))})]})})]}),C==="inquiries"&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:x.inquiries}),T.length===0&&e.jsx("p",{className:"text-gray-600",children:x.noInquiries}),e.jsx("div",{className:"space-y-3",children:T.map(a=>e.jsxs("div",{className:"rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[e.jsx("p",{className:"font-medium text-gray-900",children:a.subject}),e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-gray-100 text-gray-700",children:a.status})]}),e.jsxs("p",{className:"text-sm text-gray-700 mt-1",children:[x.from,": ",a.vendorEmail]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a.message}),a.adminReply&&e.jsxs("div",{className:"mt-2 rounded-lg border border-indigo-200 bg-indigo-50 px-3 py-2 text-sm text-indigo-800 whitespace-pre-wrap",children:[r?"Letzte Admin-Antwort:":"Latest admin reply:"," ",a.adminReply]}),(a.adminReplyAttachments||[]).length>0&&e.jsxs("div",{className:"mt-2 rounded-lg border border-indigo-200 bg-indigo-50 px-3 py-2",children:[e.jsx("p",{className:"text-xs font-semibold text-indigo-700 mb-1",children:r?"Angehaengte Dateien":"Attached files"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:(a.adminReplyAttachments||[]).map((k,J)=>e.jsx("a",{href:k,target:"_blank",rel:"noreferrer",className:"rounded border border-indigo-300 bg-white px-2 py-1 text-xs text-indigo-700 hover:bg-indigo-100 break-all",children:r?"Datei oeffnen":"Open file"},`${a.id}-att-${J}`))})]}),e.jsxs("div",{className:"mt-3 flex flex-col sm:flex-row gap-2",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("input",{type:"text",placeholder:r?"Antwort an Anbieter...":"Reply to vendor...",value:w[a.id]||"",onChange:k=>P(J=>({...J,[a.id]:k.target.value})),className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm"}),e.jsx("input",{type:"text",placeholder:x.attachmentLinks,value:Z[a.id]||"",onChange:k=>Q(J=>({...J,[a.id]:k.target.value})),className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm"}),e.jsxs("div",{className:"rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm",children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:r?"Dateien anhängen":"Attach files"}),e.jsx("input",{type:"file",multiple:!0,onChange:k=>{const J=Array.from(k.target.files||[]);ie(ae=>({...ae,[a.id]:J}))},className:"block w-full text-sm"}),(ce[a.id]||[]).length>0&&e.jsx("p",{className:"mt-1 text-xs text-gray-600",children:(ce[a.id]||[]).map(k=>k.name).join(", ")})]})]}),e.jsx("button",{type:"button",onClick:()=>Vt(a.id),disabled:Be===a.id,title:r?"Antwort per E-Mail an Anbieter senden":"Send email reply to vendor",className:"rounded-lg bg-indigo-600 text-white px-4 py-2 text-sm hover:bg-indigo-700 disabled:opacity-60",children:Be===a.id?r?"Sende...":"Sending...":r?"Antwort senden":"Send reply"})]})]},a.id))})]}),B&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4 py-6",children:e.jsxs("div",{className:"w-full max-w-3xl max-h-[88vh] overflow-y-auto rounded-xl bg-white shadow-2xl",children:[e.jsxs("div",{className:"sticky top-0 z-10 flex items-start justify-between gap-3 border-b border-gray-200 bg-white px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:B.businessName}),e.jsxs("p",{className:"text-sm text-gray-600",children:[r?"Bewerbungs-ID":"Application ID",": ",B.id]})]}),e.jsx("button",{type:"button",onClick:xt,title:r?"Detailansicht schließen":"Close details view",className:"rounded-lg border border-gray-300 px-3 py-1.5 text-sm hover:bg-gray-50",children:x.close})]}),e.jsxs("div",{className:"space-y-4 px-5 py-4 text-sm text-gray-700",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("p",{children:[e.jsxs("strong",{children:["Status",":"]})," ",B.status]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[r?"Kontaktperson":"Contact person",":"]})," ",B.contactName]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[r?"E-Mail":"Email",":"]})," ",B.email]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[r?"Stadt":"City",":"]})," ",B.city||"-"]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[r?"Erstellt":"Created",":"]})," ",new Date(B.createdAt).toLocaleString()]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[x.reviewedAt,":"]})," ",B.reviewedAt?new Date(B.reviewedAt).toLocaleString():"-"]})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-3 space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Website:"})," ",B.websiteUrl||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Portfolio:"})," ",B.portfolioUrl||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Stripe Connect:"})," ",B.stripeAccountId||"-"]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[r?"Vertrag akzeptiert":"Contract accepted",":"]})," ",(ht=B.compliance)!=null&&ht.contractAccepted?r?"ja":"yes":r?"nein":"no"]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[r?"Training abgeschlossen":"Training completed",":"]})," ",(bt=B.compliance)!=null&&bt.trainingCompleted?r?"ja":"yes":r?"nein":"no"]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[r?"Kann veröffentlichen":"Can publish",":"]})," ",(ft=B.compliance)!=null&&ft.canPublish?r?"ja":"yes":r?"nein":"no"]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[r?"Dokumentname":"Document name",":"]})," ",B.documentName||"-"]}),B.documentUrl?e.jsxs("p",{children:[e.jsxs("strong",{children:[r?"Dokument":"Document",":"]})," ",e.jsx("a",{className:"text-purple-700 underline break-all",href:B.documentUrl,target:"_blank",rel:"noreferrer",children:x.documentOpen})]}):e.jsxs("p",{children:[e.jsx("strong",{children:"Dokument:"})," -"]})]}),e.jsxs("div",{className:"rounded-lg border border-indigo-200 bg-indigo-50 p-3",children:[e.jsx("p",{className:"font-medium text-indigo-900 mb-2",children:r?"Admin-Bestaetigungen":"Admin confirmations"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{type:"button",onClick:()=>We(B.id,"contract"),disabled:B.status!=="approved"||!!((yt=B.compliance)!=null&&yt.contractAccepted)||Re===`${B.id}:contract`,className:"rounded-lg bg-indigo-600 text-white px-3 py-2 text-sm hover:bg-indigo-700 disabled:opacity-60",children:(vt=B.compliance)!=null&&vt.contractAccepted?r?"Vertrag bestaetigt":"Contract confirmed":B.status!=="approved"?r?"Warte auf Freigabe":"Wait for approval":Re===`${B.id}:contract`?r?"Bestaetige...":"Confirming...":r?"Vertrag bestaetigen":"Confirm contract"}),e.jsx("button",{type:"button",onClick:()=>We(B.id,"training"),disabled:B.status!=="approved"||!!((jt=B.compliance)!=null&&jt.trainingCompleted)||Re===`${B.id}:training`,className:"rounded-lg bg-slate-900 text-white px-3 py-2 text-sm hover:bg-black disabled:opacity-60",children:(Nt=B.compliance)!=null&&Nt.trainingCompleted?r?"Training bestaetigt":"Training confirmed":B.status!=="approved"?r?"Warte auf Freigabe":"Wait for approval":Re===`${B.id}:training`?r?"Bestaetige...":"Confirming...":r?"Training bestaetigen":"Confirm training"})]})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 p-3",children:[e.jsx("p",{className:"font-medium text-gray-900 mb-1",children:x.businessIntro}),e.jsx("p",{className:"whitespace-pre-wrap break-words text-gray-700",children:B.businessIntro||"-"})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 p-3",children:[e.jsx("p",{className:"font-medium text-gray-900 mb-1",children:x.reviewNote}),e.jsx("p",{className:"whitespace-pre-wrap break-words text-gray-700",children:B.reviewNote||"-"})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 p-3",children:[e.jsx("p",{className:"font-medium text-gray-900 mb-2",children:x.reviewNote}),e.jsx("input",{type:"text",placeholder:x.reviewNote,value:De[B.id]||"",onChange:a=>ve(k=>({...k,[B.id]:a.target.value})),className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm"})]})]}),e.jsxs("div",{className:"sticky bottom-0 z-10 flex items-center gap-2 border-t border-gray-200 bg-white px-5 py-4",children:[e.jsx("button",{type:"button",onClick:async()=>{await Ge(B.id,"approved",De[B.id])},title:r?"Anbieter freigeben":"Approve this vendor",disabled:B.status==="approved"||xe===`${B.id}:approved`,className:"rounded-lg bg-green-600 text-white px-3 py-2 text-sm hover:bg-green-700 disabled:opacity-60",children:B.status==="approved"?r?"Bereits freigegeben":"Already approved":xe===`${B.id}:approved`?r?"Freigabe...":"Approving...":x.approve}),e.jsx("button",{type:"button",onClick:async()=>{await Ge(B.id,"rejected",De[B.id])},title:r?"Bewerbung ablehnen":"Reject this application",disabled:B.status==="rejected"||xe===`${B.id}:rejected`,className:"rounded-lg bg-red-100 text-red-700 px-3 py-2 text-sm hover:bg-red-200 disabled:opacity-60",children:B.status==="rejected"?r?"Bereits abgelehnt":"Already rejected":xe===`${B.id}:rejected`?r?"Lehne ab...":"Rejecting...":x.reject}),e.jsx("button",{type:"button",onClick:async()=>{await Ge(B.id,"pending_review")},title:r?"Zurück in Prüfung setzen":"Move back to pending review",disabled:B.status==="pending_review"||xe===`${B.id}:pending_review`,className:"rounded-lg bg-gray-200 text-gray-800 px-3 py-2 text-sm hover:bg-gray-300 disabled:opacity-60",children:B.status==="pending_review"?r?"Bereits ausstehend":"Already pending":xe===`${B.id}:pending_review`?r?"Setze ausstehend...":"Setting pending...":x.backToPending})]})]})})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:e.jsx("div",{className:"container mx-auto px-4 max-w-lg",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Admin Dashboard"}),e.jsx("p",{className:"text-gray-600 mb-6",children:x.loginPrompt}),e.jsxs("form",{className:"space-y-4",onSubmit:a=>{a.preventDefault(),Qe()},children:[e.jsx("input",{type:"email",placeholder:x.loginEmail,value:R,onChange:a=>m(a.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5"}),e.jsx("input",{type:"password",placeholder:x.loginPassword,value:d,onChange:a=>v(a.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2.5"}),e.jsx("button",{type:"submit",disabled:q,className:"w-full rounded-lg bg-purple-600 text-white py-2.5 font-medium hover:bg-purple-700",children:q?x.wait:x.login}),M&&e.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700",children:M})]})]})})})}function et({title:t,value:s}){return e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-5",children:[e.jsx("p",{className:"text-sm text-gray-600",children:t}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:s.toLocaleString()})]})}const Pn=.19;function sr(t,s,n=Pn){return t.flatMap(l=>l.offers.filter(r=>r.status==="accepted"||r.paymentStatus!=="unpaid").map((r,c)=>{const C=`INV-${l.id.slice(-6).toUpperCase()}-${String(c+1).padStart(2,"0")}`;let E="Pending";r.paymentStatus==="paid"?E="Paid":(l.status==="expired"||r.paymentStatus==="failed")&&(E="Overdue");const x=Number(r.price||0),R=Math.round(x*n*100)/100,m=Math.round((x+R)*100)/100;return{id:C,requestId:l.id,offerId:r.id,client:s||l.customerName||"Customer",status:E,date:new Date(l.expiresAt).toLocaleDateString(),amount:x,vendorName:r.vendorName,services:l.selectedServices,eventDate:l.eventDate,address:l.address||null,notes:l.notes,subtotal:x,vatRate:n,vatAmount:R,total:m}}))}const Dn={Paid:"bg-green-100 text-green-700",Pending:"bg-amber-100 text-amber-700",Overdue:"bg-red-100 text-red-700"};function Rn(){const[t,s]=o.useState(""),[n,l]=o.useState(""),[r,c]=o.useState([]),[C,E]=o.useState(!1),[x,R]=o.useState(""),[m,d]=o.useState(""),[v,p]=o.useState("All");o.useEffect(()=>{const L=Pe();if(!L||L.role!=="customer"||!L.user.email){R("Bitte zuerst als Kunde einloggen.");return}s(L.user.name||""),l(L.user.email),(async()=>{E(!0),R("");try{const j=await Ot(L.user.email),N=sr(j.requests,t||L.user.name||"Customer");c(N)}catch(j){R(j instanceof Error?j.message:"Fehler beim Laden der Rechnungen.")}finally{E(!1)}})()},[t]);const u=o.useMemo(()=>r.filter(L=>{const z=v==="All"||L.status===v,j=m.trim().toLowerCase(),N=!j||L.id.toLowerCase().includes(j)||L.client.toLowerCase().includes(j);return z&&N}),[r,m,v]);return e.jsx("div",{className:"min-h-screen bg-white py-6 sm:py-10",children:e.jsxs("div",{className:"mx-auto w-full max-w-4xl px-4",children:[e.jsxs("div",{className:"mb-5",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-extrabold text-[#1A1A1A]",children:"Invoices"}),e.jsx("p",{className:"mt-1 text-sm text-[#666666]",children:n?`Account: ${t||n} (${n})`:"A searchable list of your generated invoices"})]}),e.jsx("div",{className:"mb-4 rounded-xl border border-[#E0E0E0] bg-[#F5F5F5] p-3",children:e.jsx("input",{type:"text",value:m,onChange:L=>d(L.target.value),placeholder:"Search client or invoice #",className:"w-full rounded-lg border border-[#E0E0E0] bg-white px-3 py-2 text-sm outline-none focus:border-[#7C9CB4]"})}),e.jsx("div",{className:"mb-4 flex gap-2 overflow-x-auto pb-1",children:["All","Paid","Pending","Overdue"].map(L=>e.jsx("button",{type:"button",onClick:()=>p(L),className:`whitespace-nowrap rounded-xl border px-4 py-2 text-sm ${v===L?"border-[#1A1A1A] bg-[#1A1A1A] text-white":"border-[#E0E0E0] bg-[#F5F5F5] text-[#666666]"}`,children:L},L))}),x&&e.jsx("div",{className:"mb-4 rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700",children:x}),C&&e.jsx("div",{className:"rounded-lg border border-[#E0E0E0] p-4 text-sm text-[#666666]",children:"Loading invoices..."}),!C&&u.length===0&&e.jsx("div",{className:"rounded-xl border border-[#E0E0E0] bg-[#F5F5F5] p-5 text-sm text-[#666666]",children:"No invoices found."}),e.jsx("div",{className:"space-y-3",children:u.map(L=>e.jsxs(V,{to:`/invoice/${encodeURIComponent(L.id)}`,className:"block rounded-xl border border-[#E0E0E0] bg-[#F5F5F5] p-4 hover:border-[#C4836A] transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"truncate text-base font-bold text-[#1A1A1A]",children:L.id}),e.jsx("p",{className:"truncate text-sm text-[#666666]",children:L.client})]}),e.jsx("span",{className:`rounded-md px-3 py-1 text-xs font-semibold ${Dn[L.status]}`,children:L.status})]}),e.jsx("div",{className:"mt-3 h-px bg-[#E0E0E0]"}),e.jsxs("div",{className:"mt-3 flex items-end justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase tracking-wide text-[#A0A0A0]",children:"Due Date"}),e.jsx("p",{className:"text-sm font-medium text-[#1A1A1A]",children:L.date})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[11px] uppercase tracking-wide text-[#A0A0A0]",children:"Amount"}),e.jsxs("p",{className:"text-lg font-extrabold text-[#1A1A1A]",children:["EUR ",L.total.toLocaleString()]})]})]})]},L.id))}),e.jsx("div",{className:"mt-6",children:e.jsx(V,{to:"/customer-portfolio",className:"text-sm text-[#7C9CB4] hover:underline",children:"Back to Customer Portfolio"})})]})})}const Tn={Paid:"bg-green-100 text-green-700",Pending:"bg-amber-100 text-amber-700",Overdue:"bg-red-100 text-red-700"};function Ln(){const{invoiceId:t=""}=ot(),[s,n]=o.useState(null),[l,r]=o.useState(!1),[c,C]=o.useState(""),E=o.useMemo(()=>decodeURIComponent(t),[t]);return o.useEffect(()=>{const x=Pe();if(!x||x.role!=="customer"||!x.user.email){C("Bitte zuerst als Kunde einloggen.");return}(async()=>{r(!0),C("");try{const m=await Ot(x.user.email),v=sr(m.requests,x.user.name||"Customer").find(p=>p.id===E)||null;v||C("Rechnung nicht gefunden."),n(v)}catch(m){C(m instanceof Error?m.message:"Fehler beim Laden der Rechnung.")}finally{r(!1)}})()},[E]),e.jsx("div",{className:"min-h-screen bg-white py-6 sm:py-10",children:e.jsxs("div",{className:"mx-auto w-full max-w-4xl px-4",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between print:hidden",children:[e.jsx(V,{to:"/invoices",className:"text-sm text-[#7C9CB4] hover:underline",children:"Back to invoices"}),e.jsx("button",{type:"button",onClick:()=>window.print(),className:"rounded-lg border border-[#E0E0E0] bg-[#F5F5F5] px-3 py-2 text-sm text-[#1A1A1A] hover:bg-[#EEEEEE]",children:"Print / PDF"})]}),l&&e.jsx("div",{className:"rounded-xl border border-[#E0E0E0] p-4 text-sm text-[#666666]",children:"Loading invoice..."}),c&&!l&&e.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 p-4 text-sm text-red-700",children:c}),s&&!l&&e.jsxs("div",{className:"rounded-xl border border-[#E0E0E0] bg-white p-5 sm:p-8",children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-extrabold text-[#1A1A1A]",children:"Invoice"}),e.jsx("p",{className:"mt-1 text-sm text-[#666666]",children:s.id})]}),e.jsx("span",{className:`rounded-md px-3 py-1 text-xs font-semibold ${Tn[s.status]||""}`,children:s.status})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"rounded-lg border border-[#E0E0E0] bg-[#F5F5F5] p-4",children:[e.jsx("p",{className:"text-[11px] uppercase tracking-wide text-[#A0A0A0]",children:"Billed To"}),e.jsx("p",{className:"mt-1 text-sm font-semibold text-[#1A1A1A]",children:s.client}),s.address&&e.jsx("p",{className:"mt-1 text-sm text-[#666666]",children:s.address})]}),e.jsxs("div",{className:"rounded-lg border border-[#E0E0E0] bg-[#F5F5F5] p-4",children:[e.jsx("p",{className:"text-[11px] uppercase tracking-wide text-[#A0A0A0]",children:"Invoice Date"}),e.jsx("p",{className:"mt-1 text-sm font-semibold text-[#1A1A1A]",children:s.date}),s.eventDate&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"mt-2 text-[11px] uppercase tracking-wide text-[#A0A0A0]",children:"Event Date"}),e.jsx("p",{className:"mt-1 text-sm text-[#666666]",children:new Date(s.eventDate).toLocaleDateString()})]})]})]}),e.jsx("div",{className:"mt-6 overflow-hidden rounded-lg border border-[#E0E0E0]",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-[#F5F5F5] text-[#666666]",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Description"}),e.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"Amount"})]})}),e.jsx("tbody",{children:e.jsxs("tr",{className:"border-t border-[#E0E0E0]",children:[e.jsx("td",{className:"px-3 py-2 text-[#1A1A1A]",children:s.services.join(", ")||"Event Service"}),e.jsx("td",{className:"px-3 py-2 text-[#666666]",children:s.vendorName}),e.jsxs("td",{className:"px-3 py-2 text-right text-[#1A1A1A]",children:["EUR ",s.subtotal.toLocaleString()]})]})})]})}),s.notes&&e.jsxs("div",{className:"mt-4 rounded-lg border border-[#E0E0E0] bg-[#F5F5F5] p-3 text-sm text-[#666666]",children:[e.jsx("span",{className:"font-semibold text-[#1A1A1A]",children:"Notes:"})," ",s.notes]}),e.jsxs("div",{className:"mt-6 ml-auto w-full sm:w-72 rounded-lg border border-[#E0E0E0] bg-[#F5F5F5] p-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-[#666666]",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{className:"text-[#1A1A1A]",children:["EUR ",s.subtotal.toLocaleString()]})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-sm text-[#666666]",children:[e.jsxs("span",{children:["VAT (",Math.round(s.vatRate*100),"%)"]}),e.jsxs("span",{className:"text-[#1A1A1A]",children:["EUR ",s.vatAmount.toLocaleString()]})]}),e.jsx("div",{className:"mt-3 h-px bg-[#E0E0E0]"}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsx("span",{className:"text-base font-bold text-[#1A1A1A]",children:"Total"}),e.jsxs("span",{className:"text-xl font-extrabold text-[#1A1A1A]",children:["EUR ",s.total.toLocaleString()]})]})]})]})]})})}function Bn(){const{t}=me(),[s,n]=o.useState(!1),[l,r]=o.useState(!1),[c,C]=o.useState(!1),[E,x]=o.useState(!1);o.useEffect(()=>{const m=ns();m&&(n(m.preferences),r(m.analytics),C(m.marketing))},[]);async function R(){const m=kt({v:1,preferences:s,analytics:l,marketing:c});await St(m),x(!0),window.setTimeout(()=>x(!1),2500)}return e.jsx("section",{className:"mx-auto w-full max-w-3xl px-4 py-8 sm:px-6",children:e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:t("cookies.settings.title")}),e.jsx("p",{className:"mt-2 text-sm text-slate-600",children:t("cookies.settings.description")}),e.jsxs("div",{className:"mt-5 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-slate-200 p-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-800",children:t("cookies.category.necessary")}),e.jsx("p",{className:"text-xs text-slate-500",children:t("cookies.settings.alwaysOn")})]}),e.jsx("span",{className:"rounded-full bg-emerald-100 px-2 py-1 text-xs font-medium text-emerald-700",children:"ON"})]}),e.jsxs("label",{className:"flex items-center justify-between rounded-lg border border-slate-200 p-3",children:[e.jsx("span",{className:"font-medium text-slate-800",children:t("cookies.category.preferences")}),e.jsx("input",{type:"checkbox",checked:s,onChange:m=>n(m.target.checked)})]}),e.jsxs("label",{className:"flex items-center justify-between rounded-lg border border-slate-200 p-3",children:[e.jsx("span",{className:"font-medium text-slate-800",children:t("cookies.category.analytics")}),e.jsx("input",{type:"checkbox",checked:l,onChange:m=>r(m.target.checked)})]}),e.jsxs("label",{className:"flex items-center justify-between rounded-lg border border-slate-200 p-3",children:[e.jsx("span",{className:"font-medium text-slate-800",children:t("cookies.category.marketing")}),e.jsx("input",{type:"checkbox",checked:c,onChange:m=>C(m.target.checked)})]})]}),e.jsxs("div",{className:"mt-6 flex flex-wrap gap-2",children:[e.jsx("button",{type:"button",onClick:R,className:"rounded-md bg-slate-900 px-4 py-2 text-sm font-medium text-white hover:bg-slate-700",children:t("cookies.settings.save")}),e.jsx(V,{to:"/",className:"rounded-md border border-slate-300 px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-100",children:t("cookies.settings.backHome")})]}),E&&e.jsx("p",{className:"mt-3 rounded-md bg-emerald-50 px-3 py-2 text-sm text-emerald-700",children:t("cookies.settings.saved")})]})})}function Ls(t){return`EUR ${(Number(t||0)/100).toFixed(2)}`}function In({bookingId:t,item:s,actorRole:n,actorEmail:l,onUpdated:r}){var A,T,$,K;const[c,C]=o.useState(!1),[E,x]=o.useState(""),[R,m]=o.useState(!1),[d,v]=o.useState(String(((A=s.latestOffer)==null?void 0:A.priceCents)||"")),[p,u]=o.useState(""),[L,z]=o.useState(""),[j,N]=o.useState(""),[f,y]=o.useState(""),[O,te]=o.useState("");async function q(){C(!0),x("");try{await Ya(t,s.id,{priceCents:Number(d),reason:p,breakdown:{travelFeeCents:L?Number(L):void 0,extraHours:j?Number(j):void 0,equipmentFeeCents:f?Number(f):void 0,notes:O||void 0},customerEmail:n==="customer"?l:void 0,vendorEmail:n==="vendor"?l:void 0}),m(!1),u(""),te(""),await r()}catch(D){x(D instanceof Error?D.message:"Could not submit counter-offer")}finally{C(!1)}}async function W(){C(!0),x("");try{await Xa(t,s.id,{offerVersion:s.currentOfferVersion,customerEmail:n==="customer"?l:void 0,vendorEmail:n==="vendor"?l:void 0}),await r()}catch(D){x(D instanceof Error?D.message:"Could not accept offer")}finally{C(!1)}}async function M(){C(!0),x("");try{await Qa(t,s.id,{reason:"Declined by user",customerEmail:n==="customer"?l:void 0,vendorEmail:n==="vendor"?l:void 0}),await r()}catch(D){x(D instanceof Error?D.message:"Could not decline offer")}finally{C(!1)}}return e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-base font-semibold text-slate-900",children:s.serviceTitle}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Vendor: ",s.vendorName]})]}),e.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-1 text-xs text-slate-700",children:s.status})]}),e.jsxs("div",{className:"mt-3 rounded-lg bg-slate-50 p-3 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Version:"})," ",((T=s.latestOffer)==null?void 0:T.version)??s.currentOfferVersion]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Latest price:"})," ",Ls(($=s.latestOffer)==null?void 0:$.priceCents)]}),((K=s.latestOffer)==null?void 0:K.reason)&&e.jsxs("p",{children:[e.jsx("strong",{children:"Reason:"})," ",s.latestOffer.reason]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[e.jsx("button",{type:"button",disabled:!s.actions.canAccept||c,onClick:W,className:"rounded-md bg-emerald-600 px-3 py-2 text-xs font-semibold text-white disabled:opacity-50",children:"Accept"}),e.jsx("button",{type:"button",disabled:!s.actions.canDecline||c,onClick:M,className:"rounded-md bg-rose-600 px-3 py-2 text-xs font-semibold text-white disabled:opacity-50",children:"Decline"}),e.jsx("button",{type:"button",disabled:!s.actions.canCounter||c,onClick:()=>m(D=>!D),className:"rounded-md border border-indigo-300 px-3 py-2 text-xs font-semibold text-indigo-700 disabled:opacity-50",children:"Counter-offer"})]}),R&&e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2 rounded-lg border border-indigo-100 p-3",children:[e.jsx("input",{value:d,onChange:D=>v(D.target.value),placeholder:"Price in cents",className:"rounded-md border border-slate-300 px-2 py-2 text-sm"}),e.jsx("textarea",{value:p,onChange:D=>u(D.target.value),placeholder:"Reason (no contact info)",className:"rounded-md border border-slate-300 px-2 py-2 text-sm",rows:2}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{value:L,onChange:D=>z(D.target.value),placeholder:"Travel fee cents",className:"rounded-md border border-slate-300 px-2 py-2 text-sm"}),e.jsx("input",{value:f,onChange:D=>y(D.target.value),placeholder:"Equipment fee cents",className:"rounded-md border border-slate-300 px-2 py-2 text-sm"})]}),e.jsx("input",{value:j,onChange:D=>N(D.target.value),placeholder:"Extra hours",className:"rounded-md border border-slate-300 px-2 py-2 text-sm"}),e.jsx("input",{value:O,onChange:D=>te(D.target.value),placeholder:"Breakdown notes",className:"rounded-md border border-slate-300 px-2 py-2 text-sm"}),e.jsx("button",{type:"button",onClick:q,disabled:c,className:"rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white disabled:opacity-50",children:"Submit counter-offer"})]}),E&&e.jsx("p",{className:"mt-2 rounded-md bg-rose-50 px-2 py-2 text-xs text-rose-700",children:E}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Timeline"}),e.jsx("div",{className:"mt-2 space-y-2",children:s.events.map(D=>e.jsxs("div",{className:"rounded-md border border-slate-200 px-2 py-2 text-xs text-slate-700",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{children:D.type}),e.jsx("span",{children:new Date(D.createdAt).toLocaleString()})]}),e.jsxs("div",{children:["v",D.offerVersion]}),typeof D.priceCents=="number"&&e.jsxs("div",{children:["Price: ",Ls(D.priceCents)]}),D.reason&&e.jsxs("div",{children:["Reason: ",D.reason]})]},D.id))})]})]})}function On(t){return t?t.items.reduce((s,n)=>s+Number(n.finalPriceCents||0),0):0}function Mn(){var D,S,F,B,oe,le,we,ge;const{bookingId:t=""}=ot(),[s,n]=o.useState(null),[l,r]=o.useState(!0),[c,C]=o.useState(""),[E,x]=o.useState(!1),[R,m]=o.useState(!1),[d,v]=o.useState(!1),[p,u]=o.useState({}),[L,z]=o.useState({}),[j,N]=o.useState({}),f=Pe(),y=(f==null?void 0:f.role)==="vendor"?"vendor":"customer",O=((D=f==null?void 0:f.user)==null?void 0:D.email)||"",te=o.useMemo(()=>On(s),[s]),q=!!((S=s==null?void 0:s.booking.agreement)!=null&&S.customerAccepted),W=!!((F=s==null?void 0:s.booking.agreement)!=null&&F.vendorAccepted),M=(s==null?void 0:s.booking.status)==="accepted"&&y==="customer"&&q&&W;async function A(){if(t){r(!0),C("");try{const G=await en(t,{customerEmail:y==="customer"?O:void 0,vendorEmail:y==="vendor"?O:void 0});n(G)}catch(G){C(G instanceof Error?G.message:"Failed to load booking thread")}finally{r(!1)}}}o.useEffect(()=>{A()},[t,y,O]);async function T(){if(!(!s||!M||!O)){x(!0),C("");try{const G=window.location.origin,ne=await tn(s.booking.id,{customerEmail:O,successUrl:`${G}/customer-portfolio?payment=success`,cancelUrl:`${G}/booking-thread/${encodeURIComponent(s.booking.id)}?payment=cancelled`});if(ne.url){window.location.href=ne.url;return}C("Checkout session created, but no redirect URL returned.")}catch(G){C(G instanceof Error?G.message:"Checkout failed")}finally{x(!1)}}}async function $(){if(!(!s||y!=="customer"||!O||!R)){v(!0),C("");try{await sn(s.booking.id,{customerEmail:O,agreementVersion:"v1.0"}),await A()}catch(G){C(G instanceof Error?G.message:"Failed to accept agreement")}finally{v(!1)}}}async function K(G,ne){var ue;if(!s||y!=="customer"||!O)return;const U=p[G]||{rating:"",comment:""},Y=Number(U.rating||0);if(!Number.isFinite(Y)||Y<1||Y>5){N(re=>({...re,[G]:"Please select a rating between 1 and 5."}));return}z(re=>({...re,[G]:!0})),N(re=>({...re,[G]:""}));try{await rn({bookingId:s.booking.id,serviceId:ne,customerEmail:O,rating:Y,comment:((ue=U.comment)==null?void 0:ue.trim())||void 0}),N(re=>({...re,[G]:"Review saved."}))}catch(re){N(he=>({...he,[G]:re instanceof Error?re.message:"Failed to save review."}))}finally{z(re=>({...re,[G]:!1}))}}return e.jsxs("section",{className:"mx-auto w-full max-w-5xl px-4 py-8",children:[e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Structured Negotiation"}),e.jsxs("p",{className:"mt-1 text-sm text-slate-600",children:["Booking ID: ",t]}),s&&e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2 text-sm text-slate-700 md:grid-cols-3",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",s.booking.status]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Agreed Total:"})," EUR ",(te/100).toFixed(2)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Invoice:"})," ",((B=s.booking.invoice)==null?void 0:B.status)||"none"]})]}),c&&e.jsx("p",{className:"mt-3 rounded-md bg-rose-50 px-3 py-2 text-sm text-rose-700",children:c})]}),e.jsxs("div",{className:"mt-4 space-y-3",children:[l&&e.jsx("div",{className:"rounded-xl border border-slate-200 bg-white p-4 text-sm text-slate-600",children:"Loading thread..."}),!l&&((oe=s==null?void 0:s.items)==null?void 0:oe.length)===0&&e.jsx("div",{className:"rounded-xl border border-slate-200 bg-white p-4 text-sm text-slate-600",children:"No items in this booking."}),!l&&((le=s==null?void 0:s.items)==null?void 0:le.map(G=>{var ne,U;return e.jsxs("div",{className:"space-y-3",children:[e.jsx(In,{bookingId:s.booking.id,item:G,actorRole:y,actorEmail:O,onUpdated:A}),y==="customer"&&s.booking.status==="completed"&&e.jsxs("div",{className:"rounded-xl border border-amber-200 bg-amber-50 p-3",children:[e.jsx("p",{className:"text-sm font-semibold text-amber-900",children:"Rate this service"}),e.jsx("p",{className:"text-xs text-amber-800",children:G.serviceTitle}),e.jsxs("div",{className:"mt-2 grid grid-cols-1 gap-2 md:grid-cols-[160px_1fr_auto] md:items-center",children:[e.jsxs("select",{value:((ne=p[G.id])==null?void 0:ne.rating)||"",onChange:Y=>u(ue=>{var re;return{...ue,[G.id]:{rating:Y.target.value,comment:((re=ue[G.id])==null?void 0:re.comment)||""}}}),className:"rounded-md border border-amber-300 px-3 py-2 text-sm",children:[e.jsx("option",{value:"",children:"Select rating"}),e.jsx("option",{value:"5",children:"5 - Excellent"}),e.jsx("option",{value:"4",children:"4 - Good"}),e.jsx("option",{value:"3",children:"3 - Okay"}),e.jsx("option",{value:"2",children:"2 - Poor"}),e.jsx("option",{value:"1",children:"1 - Bad"})]}),e.jsx("input",{type:"text",placeholder:"Optional comment",value:((U=p[G.id])==null?void 0:U.comment)||"",onChange:Y=>u(ue=>{var re;return{...ue,[G.id]:{rating:((re=ue[G.id])==null?void 0:re.rating)||"",comment:Y.target.value}}}),className:"rounded-md border border-amber-300 px-3 py-2 text-sm"}),e.jsx("button",{type:"button",onClick:()=>K(G.id,G.serviceId),disabled:!!L[G.id],className:"rounded-md border border-amber-400 bg-white px-3 py-2 text-sm font-semibold text-amber-900 disabled:opacity-50",children:L[G.id]?"Saving...":"Submit review"})]}),j[G.id]&&e.jsx("p",{className:"mt-2 text-xs text-amber-900",children:j[G.id]})]})]},G.id)}))]}),e.jsxs("div",{className:"mt-5 rounded-xl border border-slate-200 bg-white p-4",children:[e.jsx("p",{className:"text-sm text-slate-600",children:"Checkout is enabled only when booking status is ACCEPTED and both parties accepted the service agreement."}),(s==null?void 0:s.booking.status)==="accepted"&&y==="customer"&&e.jsx("div",{className:"mt-3 rounded-lg border border-slate-200 bg-slate-50 p-3",children:q?e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{className:"text-emerald-700",children:["Customer accepted at ",new Date(((we=s.booking.agreement)==null?void 0:we.agreementAcceptedByCustomerAt)||"").toLocaleString(),"."]}),e.jsx("p",{className:W?"text-emerald-700":"text-amber-700",children:W?`Vendor accepted at ${new Date(((ge=s.booking.agreement)==null?void 0:ge.agreementAcceptedByVendorAt)||"").toLocaleString()}.`:"Waiting for vendor agreement acceptance before checkout."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("label",{className:"flex items-start gap-2 text-sm text-slate-700",children:[e.jsx("input",{type:"checkbox",checked:R,onChange:G=>m(G.target.checked),className:"mt-1"}),e.jsx("span",{children:"I agree to the Service Agreement, including final price, scope, cancellation policy, and payment terms."})]}),e.jsx("button",{type:"button",onClick:$,disabled:!R||d,className:"mt-3 rounded-md border border-slate-300 px-3 py-2 text-sm font-semibold text-slate-700 disabled:opacity-50",children:d?"Saving agreement...":"Accept service agreement"})]})}),e.jsx("button",{type:"button",onClick:T,disabled:!M||E,className:"mt-3 rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white disabled:opacity-50",children:E?"Starting checkout...":"Pay agreed amount"})]})]})}function zn(t,s){const n=s==="de";return t==="curated-vendors"?{title:n?"Gepruefte Vendor":"Curated Vendors",subtitle:n?"So halten wir den Marktplatz professionell, verlaesslich und konsistent.":"How we keep the marketplace professional, reliable, and consistent.",points:n?["Jede Vendor-Bewerbung wird geprueft (Identitaet, Angebotsklarheit und grundlegende Qualitaet).","Services gehen erst nach Admin-Freigabe live, um Spam und Fake-Listings zu verhindern.","Listings muessen klare Preise, Leistungsumfang und Verfuegbarkeitsregeln enthalten.","Performance-Signale wie Reaktionszeit, Zuverlaessigkeit und Stornos fliessen in die Qualitaet ein.","Admin-Audit-Trail: Statusaenderungen und Verifizierungsdokumente bleiben nachvollziehbar."]:["Every vendor application is reviewed (identity, offer clarity, and baseline quality checks).","Vendors publish services only after approval to prevent spam and fake listings.","Listings must include clear pricing, deliverables, and availability rules.","Performance signals like response time, reliability, and cancellations maintain quality over time.","Admin audit trail: status changes and verification documents remain reviewable."],closing:n?"Unser Ziel: Du sollst Vendor so sicher auswaehlen koennen wie ein Hotel - mit Transparenz und Verantwortung.":"Our goal is simple: booking a vendor should feel as safe as booking a hotel, with transparency and accountability."}:t==="secure-payments"?{title:n?"Sichere Zahlungen":"Secure Payments",subtitle:n?"Stripe-basierter Checkout mit klarer Trennung zwischen Plattform und Vendor-Auszahlung.":"Stripe-powered checkout with clear separation between platform and vendor payouts.",points:n?["Checkout nutzt Stripe mit verschluesselter Kartenverarbeitung; wir speichern keine rohen Kartendaten.","Zahlungsstatus wird serverseitig per Stripe-Webhook bestaetigt - keine fake Erfolgsscreens.","Transparente Gesamtsumme: Venue + Services + moegliche Gebuehren vor dem Bezahlen sichtbar.","Stripe Connect kann Vendor-Auszahlungen und Plattform-Provision sauber abbilden.","Automatische Belege und Zahlungsbestaetigungen reduzieren Rueckfragen und Streitfaelle."]:["Checkout uses Stripe with encrypted card handling; we do not store raw card details.","Payment status is verified server-side via Stripe webhooks (no fake success screens).","Transparent totals show venue + services + applicable fees before payment.","Stripe Connect can support vendor payouts while retaining platform commission.","Automatic receipts and confirmations increase trust and reduce disputes."],closing:n?"Sichere Zahlungen schuetzen beide Seiten: Kunden vermeiden riskante Ueberweisungen, Vendor erhalten bestaetigte Auftraege.":"Secure payments protect both sides: customers avoid risky transfers and vendors receive confirmed orders with a clear record."}:t==="structured-booking"?{title:n?"Strukturierte Buchung":"Structured Booking",subtitle:n?"Anfragen, Bestaetigungen und Zahlungen folgen einer klaren Reihenfolge - ohne Chaos.":"Requests, confirmations, and payments follow a predictable sequence with no chaos.",points:n?["Versionierte Angebote verhindern Verhandlungschaos und machen den aktuellen Preis eindeutig.","Die Buchungszusammenfassung fixiert Positionen, damit am Checkout nichts unerwartet springt.","Kontaktdaten koennen bis zur Bestaetigung geschuetzt bleiben und Off-Platform-Deals reduzieren.","Klare Storno-Regeln und Zeitstempel verringern Streitfaelle.","Finalpreis wird nach beidseitiger Annahme (oder Zahlung, je nach Modell) gesperrt."]:["Versioned offers prevent negotiation confusion and keep the current price explicit.","Booking summary locks selected items so nothing changes unexpectedly at checkout.","Contact details can stay protected until confirmation to reduce off-platform deals.","Clear cancellation rules and timestamps reduce disputes.","Final price is locked after both sides accept (or when payment is completed, depending on model)."],closing:n?"Events haben viele bewegliche Teile. Ein strukturierter Ablauf verhindert Last-Minute-Ueberraschungen.":"Events involve many moving parts. A structured flow prevents last-minute surprises and keeps plans consistent."}:null}function Fn(){const{topic:t}=ot(),{language:s}=me(),n=zn(t,s);if(!n)return e.jsx("div",{className:"min-h-screen bg-slate-50 py-10",children:e.jsx("div",{className:"w-full max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-6",children:[e.jsx("p",{className:"text-slate-700",children:s==="de"?"Bereich nicht gefunden.":"Section not found."}),e.jsxs(V,{to:"/",className:"inline-flex items-center gap-2 mt-4 text-purple-700 hover:text-purple-800",children:[e.jsx(Zt,{className:"size-4"}),s==="de"?"Zurueck zur Startseite":"Back to home"]})]})})});const l=t==="curated-vendors"?e.jsx(Et,{className:"size-6 text-purple-600"}):t==="secure-payments"?e.jsx(Vs,{className:"size-6 text-purple-600"}):e.jsx(Xe,{className:"size-6 text-purple-600"});return e.jsx("div",{className:"min-h-screen bg-slate-50 py-10",children:e.jsx("div",{className:"w-full max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 sm:p-8 shadow-sm",children:[e.jsxs(V,{to:"/",className:"inline-flex items-center gap-2 text-sm text-slate-600 hover:text-slate-900",children:[e.jsx(Zt,{className:"size-4"}),s==="de"?"Zurueck":"Back"]}),e.jsxs("div",{className:"mt-5 rounded-xl border border-purple-100 bg-gradient-to-br from-white to-purple-50 p-5 sm:p-6",children:[e.jsx("div",{className:"inline-flex items-center justify-center rounded-lg bg-purple-100 p-3 mb-3",children:l}),e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-900",children:n.title}),e.jsx("p",{className:"mt-2 text-slate-600",children:n.subtitle})]}),e.jsx("div",{className:"mt-6 space-y-3",children:n.points.map(r=>e.jsx("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-4 py-3 text-slate-700",children:r},r))}),e.jsx("p",{className:"mt-6 text-sm sm:text-base text-slate-700 rounded-xl bg-purple-50 border border-purple-100 p-4",children:n.closing})]})})})}function Vn(){const{language:t}=me();return e.jsx("div",{className:"min-h-screen bg-slate-50 py-10",children:e.jsx("div",{className:"w-full max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 sm:p-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-900 mb-4",children:t==="de"?"Impressum":"Legal Notice"}),e.jsxs("div",{className:"space-y-3 text-sm text-slate-700 leading-6",children:[e.jsx("p",{children:"EventVenue Marketplace GmbH"}),e.jsx("p",{children:"Beispielstrasse 10, 97070 Wuerzburg, Deutschland"}),e.jsxs("p",{children:[t==="de"?"E-Mail":"Email",": legal@eventvenue.com"]}),e.jsx("p",{children:t==="de"?"Vertreten durch die Geschaeftsfuehrung der EventVenue Marketplace GmbH.":"Represented by the management of EventVenue Marketplace GmbH."}),e.jsx("p",{children:t==="de"?"Inhaltlich verantwortlich gemaess gesetzlicher Vorgaben.":"Content responsibility in accordance with applicable law."})]})]})})})}function $n(){const{language:t}=me();return e.jsx("div",{className:"min-h-screen bg-slate-50 py-10",children:e.jsx("div",{className:"w-full max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 sm:p-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-900 mb-4",children:t==="de"?"Datenschutzerklaerung":"Privacy Policy"}),e.jsxs("div",{className:"space-y-4 text-sm text-slate-700 leading-6",children:[e.jsx("p",{children:t==="de"?"Wir verarbeiten personenbezogene Daten nur zur Bereitstellung der Plattform, zur Vertragsabwicklung und zur Sicherheit.":"We process personal data only to operate the platform, fulfill contracts, and ensure security."}),e.jsx("p",{children:t==="de"?"Gespeicherte Daten koennen u. a. Kontoangaben, Buchungsdaten, Zahlungsreferenzen und Support-Kommunikation enthalten.":"Stored data may include account details, booking records, payment references, and support communication."}),e.jsx("p",{children:t==="de"?"Zahlungen werden ueber Stripe abgewickelt. Es gelten zusaetzlich die Datenschutzbestimmungen von Stripe.":"Payments are processed via Stripe. Stripe privacy terms apply in addition to this policy."}),e.jsx("p",{children:t==="de"?"Du kannst Auskunft, Berichtigung oder Loeschung deiner Daten per E-Mail an privacy@eventvenue.com anfragen.":"You can request access, correction, or deletion of your data via privacy@eventvenue.com."})]})]})})})}function Un(){const{language:t}=me();return e.jsx("div",{className:"min-h-screen bg-slate-50 py-10",children:e.jsx("div",{className:"w-full max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 sm:p-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-900 mb-4",children:t==="de"?"Allgemeine Geschaeftsbedingungen":"Terms of Service"}),e.jsxs("ul",{className:"list-disc pl-6 space-y-3 text-sm text-slate-700 leading-6",children:[e.jsx("li",{children:t==="de"?"EventVenue ist ein Vermittlungs-Marktplatz zwischen Kunden und Anbietern.":"EventVenue is a marketplace connecting customers and vendors."}),e.jsx("li",{children:t==="de"?"Buchungen starten als Anfrage und werden erst nach Zustimmung verbindlich.":"Bookings start as requests and become binding only after acceptance."}),e.jsx("li",{children:t==="de"?"Preis- und Leistungsdetails gelten gemaess final vereinbartem Angebot.":"Price and service details follow the final agreed offer."}),e.jsx("li",{children:t==="de"?"Kontaktumgehung ausserhalb der Plattform ist nicht erlaubt.":"Off-platform contact circumvention is not allowed."})]})]})})})}function qn(){const{language:t}=me(),s=t==="de";return e.jsx("div",{className:"min-h-screen bg-slate-50 py-10",children:e.jsx("div",{className:"w-full max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 sm:p-8 space-y-6",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-900 mb-4",children:"Vendor Agreement"}),e.jsx("p",{className:"text-sm text-slate-700 leading-6",children:'This Vendor Agreement is entered into between EventVenue Marketplace ("Platform") and the Vendor ("you"). By registering and activating a vendor account, you agree to the terms below.'}),e.jsx(Ye,{title:"1. Vendor Eligibility and Approval",points:["Provide accurate personal or business information.","Complete vendor onboarding and training.","Accept this Agreement.","Complete Stripe Connect onboarding for payouts.","Receive admin approval before becoming active."]}),e.jsx(Ye,{title:"2. Vendor Responsibilities",points:["Publish accurate service and venue information.","Honor accepted bookings and agreed pricing.","Maintain professional communication with customers.","Deliver services as described and on time.","Comply with applicable laws and regulations."]}),e.jsx(Ye,{title:"3. Payments and Stripe Connect",points:["Payments are processed by Stripe.","The platform collects customer payment first.","Applicable platform fees and VAT are deducted.","Remaining net amount is transferred to your Stripe Connect account.","Incomplete Stripe onboarding may delay payouts."]}),e.jsx(Ye,{title:"4. Platform Commission",points:["Commission may be percentage-based or fixed per booking.","Commission is deducted automatically before payout.","Commission and payout breakdown are visible in vendor dashboard."]}),e.jsx(Ye,{title:"5. Service Agreement and Acceptance",points:["Accepting a customer service request creates a binding agreement.","After acceptance, payment can be enabled for the customer.","Failure to deliver accepted services may lead to penalties or account suspension."]}),e.jsx(Ye,{title:"6. Platform Authority and Moderation",points:["Platform may approve/reject/suspend vendor accounts.","Platform may remove non-compliant listings and moderate disputes.","Platform maintains marketplace quality and trust standards."]}),e.jsx(Ye,{title:"7. Agreement Acceptance Record",points:["Acceptance is recorded digitally with timestamp and account identity.","Agreement version is stored with your acceptance record.","Continued use after updates constitutes acceptance of current version."]}),e.jsx("div",{className:"rounded-lg border border-slate-200 bg-slate-50 p-4 text-xs text-slate-600",children:"Required activation rule: vendor cannot become active unless admin approved + contract accepted + training completed."})]})})})}function Ye({title:t,points:s}){return e.jsxs("section",{children:[e.jsx("h2",{className:"text-base font-semibold text-slate-900 mb-2",children:t}),e.jsx("ul",{className:"list-disc pl-5 space-y-1 text-sm text-slate-700 leading-6",children:s.map(n=>e.jsx("li",{children:n},n))})]})}function Gn(){const{language:t}=me();return e.jsx("div",{className:"min-h-screen bg-slate-50 py-10",children:e.jsx("div",{className:"w-full max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 sm:p-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-900 mb-4",children:t==="de"?"Storno- und Erstattungsrichtlinie":"Cancellation & Refund Policy"}),e.jsxs("ul",{className:"list-disc pl-6 space-y-3 text-sm text-slate-700 leading-6",children:[e.jsx("li",{children:t==="de"?"Erstattungen folgen den Bedingungen der jeweiligen Buchung und des finalen Angebots.":"Refunds follow the terms of the specific booking and final accepted offer."}),e.jsx("li",{children:t==="de"?"Bei Vendor-Ablehnung wird die Anfrage storniert und gehaltene Verfuegbarkeit freigegeben.":"If a vendor declines, the request is canceled and held availability is released."}),e.jsx("li",{children:t==="de"?"Bei bereits gezahlten Buchungen erfolgt Rueckerstattung gemaess Stripe-Zahlungsstatus und Plattformrichtlinie.":"For paid bookings, refunds depend on Stripe payment state and platform policy."})]})]})})})}function Hn(){const{language:t}=me();return e.jsx("div",{className:"min-h-screen bg-slate-50 py-10",children:e.jsx("div",{className:"w-full max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 sm:p-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-900 mb-4",children:t==="de"?"Kontakt":"Contact"}),e.jsxs("div",{className:"space-y-3 text-sm text-slate-700 leading-6",children:[e.jsxs("p",{children:[t==="de"?"Allgemeine Anfragen:":"General inquiries:"," support@eventvenue.com"]}),e.jsxs("p",{children:[t==="de"?"Datenschutz:":"Privacy:"," privacy@eventvenue.com"]}),e.jsxs("p",{children:[t==="de"?"Rechtliches:":"Legal:"," legal@eventvenue.com"]}),e.jsx("p",{children:t==="de"?"Antwortzeit: in der Regel innerhalb von 1-2 Werktagen.":"Typical response time: within 1-2 business days."})]})]})})})}function _n(){return e.jsx("div",{className:"min-h-screen bg-slate-50 py-10",children:e.jsxs("div",{className:"w-full max-w-5xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("section",{className:"rounded-2xl border border-slate-200 bg-white p-6 sm:p-8 shadow-sm",children:[e.jsx("p",{className:"text-sm font-semibold uppercase tracking-wide text-purple-700",children:"About EventVenue"}),e.jsx("h1",{className:"mt-2 text-3xl sm:text-4xl font-bold text-slate-900",children:"Plan your event in one place."}),e.jsx("p",{className:"mt-3 text-slate-600",children:"EventVenue is a marketplace where you can book venues and event services (DJ, catering, decoration, photography, and more) in one clean flow from selection to checkout."})]}),e.jsxs("section",{className:"mt-6 rounded-2xl border border-slate-200 bg-white p-6 sm:p-8 shadow-sm",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Why we built this"}),e.jsx("p",{className:"mt-3 text-slate-600",children:"Planning an event usually means juggling multiple vendors, unclear pricing, and risky payment methods. EventVenue makes booking simpler, more transparent, and more secure."})]}),e.jsxs("section",{className:"mt-6 rounded-2xl border border-slate-200 bg-white p-6 sm:p-8 shadow-sm",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"How it works"}),e.jsxs("ol",{className:"mt-4 list-decimal pl-5 text-slate-700 space-y-2",children:[e.jsx("li",{children:"Browse venues and compare options."}),e.jsx("li",{children:"Select services you need (DJ, catering, decor, photography)."}),e.jsx("li",{children:"Review your booking summary."}),e.jsx("li",{children:"Save for later or pay securely."}),e.jsx("li",{children:"Receive confirmation and booking details."})]})]}),e.jsxs("section",{className:"mt-6 rounded-2xl border border-slate-200 bg-white p-6 sm:p-8 shadow-sm",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Why choose us"}),e.jsxs("ul",{className:"mt-4 list-disc pl-5 text-slate-700 space-y-2",children:[e.jsx("li",{children:"Curated vendors reviewed before they go live."}),e.jsx("li",{children:"Transparent pricing and clear service packages."}),e.jsx("li",{children:"Secure Stripe checkout with server-verified payment updates."}),e.jsx("li",{children:"One booking summary for venue + services."}),e.jsx("li",{children:"Built for weddings, birthdays, graduations, and corporate events."})]})]}),e.jsxs("section",{className:"mt-6 rounded-2xl border border-purple-200 bg-white p-6 sm:p-8 shadow-sm",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Mission"}),e.jsx("p",{className:"mt-3 text-slate-700",children:"Our mission is to help customers book confidently and help vendors grow through a trusted, organized marketplace."})]})]})})}function Kn(){return e.jsx("div",{className:"min-h-screen bg-slate-50 py-10",children:e.jsxs("div",{className:"w-full max-w-5xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("section",{className:"rounded-2xl border border-slate-200 bg-white p-6 sm:p-8 shadow-sm",children:[e.jsx("p",{className:"text-sm font-semibold uppercase tracking-wide text-emerald-700",children:"Payments & Security"}),e.jsx("h1",{className:"mt-2 text-3xl sm:text-4xl font-bold text-slate-900",children:"How money and trust flow on EventVenue"}),e.jsx("p",{className:"mt-3 text-slate-600",children:"EventVenue uses Stripe Checkout and Stripe Connect to process payments and vendor payouts with clear records and traceable webhook updates."})]}),e.jsxs("section",{className:"mt-6 rounded-2xl border border-slate-200 bg-white p-6 sm:p-8 shadow-sm",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Payment processing"}),e.jsxs("ul",{className:"mt-4 list-disc pl-5 text-slate-700 space-y-2",children:[e.jsx("li",{children:"Customers pay through hosted Stripe Checkout pages."}),e.jsx("li",{children:"Booking status is updated by Stripe webhook events on the backend."}),e.jsx("li",{children:"Platform commission and vendor net amounts are stored per payout record."}),e.jsx("li",{children:"Duplicate webhook delivery is handled with idempotent event tracking."})]})]}),e.jsxs("section",{className:"mt-6 rounded-2xl border border-slate-200 bg-white p-6 sm:p-8 shadow-sm",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Data protection"}),e.jsxs("ul",{className:"mt-4 list-disc pl-5 text-slate-700 space-y-2",children:[e.jsx("li",{children:"Sensitive card data is handled by Stripe, not stored in this application."}),e.jsx("li",{children:"API endpoints require authenticated roles for customer, vendor, and admin operations."}),e.jsx("li",{children:"Compliance and audit logs are persisted for critical admin and payment workflows."})]})]}),e.jsxs("section",{className:"mt-6 rounded-2xl border border-emerald-200 bg-white p-6 sm:p-8 shadow-sm",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Transparency"}),e.jsx("p",{className:"mt-3 text-slate-700",children:"Customer invoices and vendor payout states are visible in dashboards so both sides can follow payment lifecycle from checkout to transfer."})]})]})})}function Jn(){const{t}=me();return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-6xl font-bold text-gray-900 mb-4",children:"404"}),e.jsx("p",{className:"text-xl text-gray-600 mb-8",children:t("notFound.page")}),e.jsx(V,{to:"/",className:"inline-block bg-purple-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-purple-700 transition-colors",children:t("notFound.backHome")})]})})}function Wn(){const t=pr();let s="Etwas ist schiefgelaufen",n="Bitte Seite neu laden oder spaeter erneut versuchen.";return xr(t)&&(s=`${t.status} ${t.statusText}`,typeof t.data=="string"&&(n=t.data)),e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-6",children:e.jsxs("div",{className:"max-w-xl w-full bg-white border border-gray-200 rounded-xl shadow-sm p-8 text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-3",children:s}),e.jsx("p",{className:"text-gray-600 mb-6",children:n}),e.jsx("a",{href:"/",className:"inline-flex items-center justify-center rounded-lg bg-purple-600 text-white px-5 py-2.5 hover:bg-purple-700 transition-colors",children:"Zur Startseite"})]})})}const Zn=hr([{path:"/",Component:ra,ErrorBoundary:Wn,children:[{index:!0,Component:aa},{path:"venues",Component:na},{path:"services",Component:fn},{path:"request",Component:yn},{path:"vendor-portfolio",Component:Ds},{path:"customer-portfolio",Component:Jt},{path:"dashboard/vendor",Component:Ds},{path:"dashboard/admin",Component:wt},{path:"dashboard/admin/:section",Component:wt},{path:"account/customer",Component:Jt},{path:"dashboard/customer",Component:Jt},{path:"login",Component:Cn},{path:"signup",Component:En},{path:"admin",Component:wt},{path:"admin/:section",Component:wt},{path:"invoices",Component:Rn},{path:"invoice/:invoiceId",Component:Ln},{path:"cookies",Component:Bn},{path:"why/:topic",Component:Fn},{path:"impressum",Component:Vn},{path:"privacy",Component:$n},{path:"terms",Component:Un},{path:"vendor-terms",Component:qn},{path:"refund-policy",Component:Gn},{path:"contact",Component:Hn},{path:"about",Component:_n},{path:"payments-security",Component:Kn},{path:"booking-thread/:bookingId",Component:Mn},{path:"venue/:id",Component:an},{path:"booking",Component:nn},{path:"cart",Component:on},{path:"checkout/success",Component:ln},{path:"*",Component:Jn}]}]);function Yn(){return e.jsx(qr,{children:e.jsxs(_r,{children:[e.jsx(br,{router:Zn}),e.jsx(Ur,{position:"bottom-right",richColors:!0})]})})}fr.createRoot(document.getElementById("root")).render(e.jsx(Yn,{}));
